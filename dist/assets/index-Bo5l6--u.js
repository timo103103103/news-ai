import{j as e,S as Dn,M as Mn,H as Bn,B as Os,a as gi,C as fr,b as Fn,c as Rs,U as Is,L as pi,d as qn,e as Hn,X as St,f as Wn,A as ye,m as B,g as Vt,h as gr,i as zn,E as Ue,k as pe,l as Ht,n as fe,o as Fr,p as qe,I as Ge,q as Kt,T as Te,r as we,s as bi,t as Vn,u as z,v as yi,w as Gt,G as Kn,x as ks,y as Ne,z as it,Z as nt,D as Je,F as Gn,J as wi,K as ot,N as vi,O as ze,P as At,Q as Jn,R as Yn,V as Le,W as Xn,Y as qr,_ as Qn,$ as Zn,a0 as eo,a1 as to,a2 as so,a3 as ro,a4 as ao,a5 as ji,a6 as ki,a7 as tt,a8 as Ns,a9 as io,aa as no,ab as Jt,ac as oo,ad as Ni,ae as lo,af as _i,ag as co,ah as uo,ai as ho,aj as Ws,ak as mo,al as xo,am as Si,an as fo,ao as ra,ap as go,aq as po,ar as bo,as as yo,at as pr,au as wo,av as Ei,aw as vo,ax as jo,ay as ko,az as No}from"./ui-vendor-D9XtMW3_.js";import{b as _o,g as Hr,a as b,R as ge,N as Wr,u as De,d as zr,O as So,L as ve,e as Eo,f as To,B as Co,h as Ao,i as le}from"./react-vendor-azDHyYlL.js";import{c as Po,R as Ti,P as Ci,a as Ai,T as _s,b as br,d as yr,S as Oo,C as Pi,e as aa,X as Oi,Y as Ri,f as Ro,g as Ii,B as Io,h as $o,i as Lo}from"./data-vendor-CxDUw1Oa.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(i){if(i.ep)return;i.ep=!0;const n=r(i);fetch(i.href,n)}})();var ls={},ia;function Uo(){if(ia)return ls;ia=1;var s=_o();return ls.createRoot=s.createRoot,ls.hydrateRoot=s.hydrateRoot,ls}var Do=Uo(),zs,na;function Mo(){if(na)return zs;na=1;var s=typeof Element<"u",t=typeof Map=="function",r=typeof Set=="function",a=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function i(n,o){if(n===o)return!0;if(n&&o&&typeof n=="object"&&typeof o=="object"){if(n.constructor!==o.constructor)return!1;var l,c,d;if(Array.isArray(n)){if(l=n.length,l!=o.length)return!1;for(c=l;c--!==0;)if(!i(n[c],o[c]))return!1;return!0}var u;if(t&&n instanceof Map&&o instanceof Map){if(n.size!==o.size)return!1;for(u=n.entries();!(c=u.next()).done;)if(!o.has(c.value[0]))return!1;for(u=n.entries();!(c=u.next()).done;)if(!i(c.value[1],o.get(c.value[0])))return!1;return!0}if(r&&n instanceof Set&&o instanceof Set){if(n.size!==o.size)return!1;for(u=n.entries();!(c=u.next()).done;)if(!o.has(c.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(n)&&ArrayBuffer.isView(o)){if(l=n.length,l!=o.length)return!1;for(c=l;c--!==0;)if(n[c]!==o[c])return!1;return!0}if(n.constructor===RegExp)return n.source===o.source&&n.flags===o.flags;if(n.valueOf!==Object.prototype.valueOf&&typeof n.valueOf=="function"&&typeof o.valueOf=="function")return n.valueOf()===o.valueOf();if(n.toString!==Object.prototype.toString&&typeof n.toString=="function"&&typeof o.toString=="function")return n.toString()===o.toString();if(d=Object.keys(n),l=d.length,l!==Object.keys(o).length)return!1;for(c=l;c--!==0;)if(!Object.prototype.hasOwnProperty.call(o,d[c]))return!1;if(s&&n instanceof Element)return!1;for(c=l;c--!==0;)if(!((d[c]==="_owner"||d[c]==="__v"||d[c]==="__o")&&n.$$typeof)&&!i(n[d[c]],o[d[c]]))return!1;return!0}return n!==n&&o!==o}return zs=function(o,l){try{return i(o,l)}catch(c){if((c.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw c}},zs}var Bo=Mo();const Fo=Hr(Bo);var Vs,oa;function qo(){if(oa)return Vs;oa=1;var s=function(t,r,a,i,n,o,l,c){if(!t){var d;if(r===void 0)d=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[a,i,n,o,l,c],m=0;d=new Error(r.replace(/%s/g,function(){return u[m++]})),d.name="Invariant Violation"}throw d.framesToPop=1,d}};return Vs=s,Vs}var Ho=qo();const la=Hr(Ho);var Ks,ca;function Wo(){return ca||(ca=1,Ks=function(t,r,a,i){var n=a?a.call(i,t,r):void 0;if(n!==void 0)return!!n;if(t===r)return!0;if(typeof t!="object"||!t||typeof r!="object"||!r)return!1;var o=Object.keys(t),l=Object.keys(r);if(o.length!==l.length)return!1;for(var c=Object.prototype.hasOwnProperty.bind(r),d=0;d<o.length;d++){var u=o[d];if(!c(u))return!1;var m=t[u],p=r[u];if(n=a?a.call(i,m,p,u):void 0,n===!1||n===void 0&&m!==p)return!1}return!0}),Ks}var zo=Wo();const Vo=Hr(zo);var $i=(s=>(s.BASE="base",s.BODY="body",s.HEAD="head",s.HTML="html",s.LINK="link",s.META="meta",s.NOSCRIPT="noscript",s.SCRIPT="script",s.STYLE="style",s.TITLE="title",s.FRAGMENT="Symbol(react.fragment)",s))($i||{}),Gs={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},da=Object.values($i),Vr={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},Ko=Object.entries(Vr).reduce((s,[t,r])=>(s[r]=t,s),{}),Re="data-rh",Et={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},Tt=(s,t)=>{for(let r=s.length-1;r>=0;r-=1){const a=s[r];if(Object.prototype.hasOwnProperty.call(a,t))return a[t]}return null},Go=s=>{let t=Tt(s,"title");const r=Tt(s,Et.TITLE_TEMPLATE);if(Array.isArray(t)&&(t=t.join("")),r&&t)return r.replace(/%s/g,()=>t);const a=Tt(s,Et.DEFAULT_TITLE);return t||a||void 0},Jo=s=>Tt(s,Et.ON_CHANGE_CLIENT_STATE)||(()=>{}),Js=(s,t)=>t.filter(r=>typeof r[s]<"u").map(r=>r[s]).reduce((r,a)=>({...r,...a}),{}),Yo=(s,t)=>t.filter(r=>typeof r.base<"u").map(r=>r.base).reverse().reduce((r,a)=>{if(!r.length){const i=Object.keys(a);for(let n=0;n<i.length;n+=1){const l=i[n].toLowerCase();if(s.indexOf(l)!==-1&&a[l])return r.concat(a)}}return r},[]),Xo=s=>console&&typeof console.warn=="function"&&console.warn(s),$t=(s,t,r)=>{const a={};return r.filter(i=>Array.isArray(i[s])?!0:(typeof i[s]<"u"&&Xo(`Helmet: ${s} should be of type "Array". Instead found type "${typeof i[s]}"`),!1)).map(i=>i[s]).reverse().reduce((i,n)=>{const o={};n.filter(c=>{let d;const u=Object.keys(c);for(let p=0;p<u.length;p+=1){const h=u[p],x=h.toLowerCase();t.indexOf(x)!==-1&&!(d==="rel"&&c[d].toLowerCase()==="canonical")&&!(x==="rel"&&c[x].toLowerCase()==="stylesheet")&&(d=x),t.indexOf(h)!==-1&&(h==="innerHTML"||h==="cssText"||h==="itemprop")&&(d=h)}if(!d||!c[d])return!1;const m=c[d].toLowerCase();return a[d]||(a[d]={}),o[d]||(o[d]={}),a[d][m]?!1:(o[d][m]=!0,!0)}).reverse().forEach(c=>i.push(c));const l=Object.keys(o);for(let c=0;c<l.length;c+=1){const d=l[c],u={...a[d],...o[d]};a[d]=u}return i},[]).reverse()},Qo=(s,t)=>{if(Array.isArray(s)&&s.length){for(let r=0;r<s.length;r+=1)if(s[r][t])return!0}return!1},Zo=s=>({baseTag:Yo(["href"],s),bodyAttributes:Js("bodyAttributes",s),defer:Tt(s,Et.DEFER),encode:Tt(s,Et.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:Js("htmlAttributes",s),linkTags:$t("link",["rel","href"],s),metaTags:$t("meta",["name","charset","http-equiv","property","itemprop"],s),noscriptTags:$t("noscript",["innerHTML"],s),onChangeClientState:Jo(s),scriptTags:$t("script",["src","innerHTML"],s),styleTags:$t("style",["cssText"],s),title:Go(s),titleAttributes:Js("titleAttributes",s),prioritizeSeoTags:Qo(s,Et.PRIORITIZE_SEO_TAGS)}),Li=s=>Array.isArray(s)?s.join(""):s,el=(s,t)=>{const r=Object.keys(s);for(let a=0;a<r.length;a+=1)if(t[r[a]]&&t[r[a]].includes(s[r[a]]))return!0;return!1},Ys=(s,t)=>Array.isArray(s)?s.reduce((r,a)=>(el(a,t)?r.priority.push(a):r.default.push(a),r),{priority:[],default:[]}):{default:s,priority:[]},ua=(s,t)=>({...s,[t]:void 0}),tl=["noscript","script","style"],wr=(s,t=!0)=>t===!1?String(s):String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),Ui=s=>Object.keys(s).reduce((t,r)=>{const a=typeof s[r]<"u"?`${r}="${s[r]}"`:`${r}`;return t?`${t} ${a}`:a},""),sl=(s,t,r,a)=>{const i=Ui(r),n=Li(t);return i?`<${s} ${Re}="true" ${i}>${wr(n,a)}</${s}>`:`<${s} ${Re}="true">${wr(n,a)}</${s}>`},rl=(s,t,r=!0)=>t.reduce((a,i)=>{const n=i,o=Object.keys(n).filter(d=>!(d==="innerHTML"||d==="cssText")).reduce((d,u)=>{const m=typeof n[u]>"u"?u:`${u}="${wr(n[u],r)}"`;return d?`${d} ${m}`:m},""),l=n.innerHTML||n.cssText||"",c=tl.indexOf(s)===-1;return`${a}<${s} ${Re}="true" ${o}${c?"/>":`>${l}</${s}>`}`},""),Di=(s,t={})=>Object.keys(s).reduce((r,a)=>{const i=Vr[a];return r[i||a]=s[a],r},t),al=(s,t,r)=>{const a={key:t,[Re]:!0},i=Di(r,a);return[ge.createElement("title",i,t)]},ys=(s,t)=>t.map((r,a)=>{const i={key:a,[Re]:!0};return Object.keys(r).forEach(n=>{const l=Vr[n]||n;if(l==="innerHTML"||l==="cssText"){const c=r.innerHTML||r.cssText;i.dangerouslySetInnerHTML={__html:c}}else i[l]=r[n]}),ge.createElement(s,i)}),Ce=(s,t,r=!0)=>{switch(s){case"title":return{toComponent:()=>al(s,t.title,t.titleAttributes),toString:()=>sl(s,t.title,t.titleAttributes,r)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>Di(t),toString:()=>Ui(t)};default:return{toComponent:()=>ys(s,t),toString:()=>rl(s,t,r)}}},il=({metaTags:s,linkTags:t,scriptTags:r,encode:a})=>{const i=Ys(s,Gs.meta),n=Ys(t,Gs.link),o=Ys(r,Gs.script);return{priorityMethods:{toComponent:()=>[...ys("meta",i.priority),...ys("link",n.priority),...ys("script",o.priority)],toString:()=>`${Ce("meta",i.priority,a)} ${Ce("link",n.priority,a)} ${Ce("script",o.priority,a)}`},metaTags:i.default,linkTags:n.default,scriptTags:o.default}},nl=s=>{const{baseTag:t,bodyAttributes:r,encode:a=!0,htmlAttributes:i,noscriptTags:n,styleTags:o,title:l="",titleAttributes:c,prioritizeSeoTags:d}=s;let{linkTags:u,metaTags:m,scriptTags:p}=s,h={toComponent:()=>{},toString:()=>""};return d&&({priorityMethods:h,linkTags:u,metaTags:m,scriptTags:p}=il(s)),{priority:h,base:Ce("base",t,a),bodyAttributes:Ce("bodyAttributes",r,a),htmlAttributes:Ce("htmlAttributes",i,a),link:Ce("link",u,a),meta:Ce("meta",m,a),noscript:Ce("noscript",n,a),script:Ce("script",p,a),style:Ce("style",o,a),title:Ce("title",{title:l,titleAttributes:c},a)}},vr=nl,cs=[],Mi=!!(typeof window<"u"&&window.document&&window.document.createElement),jr=class{instances=[];canUseDOM=Mi;context;value={setHelmet:s=>{this.context.helmet=s},helmetInstances:{get:()=>this.canUseDOM?cs:this.instances,add:s=>{(this.canUseDOM?cs:this.instances).push(s)},remove:s=>{const t=(this.canUseDOM?cs:this.instances).indexOf(s);(this.canUseDOM?cs:this.instances).splice(t,1)}}};constructor(s,t){this.context=s,this.canUseDOM=t||!1,t||(s.helmet=vr({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},ol={},Bi=ge.createContext(ol),Fi=class qi extends b.Component{static canUseDOM=Mi;helmetData;constructor(t){super(t),this.helmetData=new jr(this.props.context||{},qi.canUseDOM)}render(){return ge.createElement(Bi.Provider,{value:this.helmetData.value},this.props.children)}},ht=(s,t)=>{const r=document.head||document.querySelector("head"),a=r.querySelectorAll(`${s}[${Re}]`),i=[].slice.call(a),n=[];let o;return t&&t.length&&t.forEach(l=>{const c=document.createElement(s);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d))if(d==="innerHTML")c.innerHTML=l.innerHTML;else if(d==="cssText")c.styleSheet?c.styleSheet.cssText=l.cssText:c.appendChild(document.createTextNode(l.cssText));else{const u=d,m=typeof l[u]>"u"?"":l[u];c.setAttribute(d,m)}c.setAttribute(Re,"true"),i.some((d,u)=>(o=u,c.isEqualNode(d)))?i.splice(o,1):n.push(c)}),i.forEach(l=>l.parentNode?.removeChild(l)),n.forEach(l=>r.appendChild(l)),{oldTags:i,newTags:n}},kr=(s,t)=>{const r=document.getElementsByTagName(s)[0];if(!r)return;const a=r.getAttribute(Re),i=a?a.split(","):[],n=[...i],o=Object.keys(t);for(const l of o){const c=t[l]||"";r.getAttribute(l)!==c&&r.setAttribute(l,c),i.indexOf(l)===-1&&i.push(l);const d=n.indexOf(l);d!==-1&&n.splice(d,1)}for(let l=n.length-1;l>=0;l-=1)r.removeAttribute(n[l]);i.length===n.length?r.removeAttribute(Re):r.getAttribute(Re)!==o.join(",")&&r.setAttribute(Re,o.join(","))},ll=(s,t)=>{typeof s<"u"&&document.title!==s&&(document.title=Li(s)),kr("title",t)},ha=(s,t)=>{const{baseTag:r,bodyAttributes:a,htmlAttributes:i,linkTags:n,metaTags:o,noscriptTags:l,onChangeClientState:c,scriptTags:d,styleTags:u,title:m,titleAttributes:p}=s;kr("body",a),kr("html",i),ll(m,p);const h={baseTag:ht("base",r),linkTags:ht("link",n),metaTags:ht("meta",o),noscriptTags:ht("noscript",l),scriptTags:ht("script",d),styleTags:ht("style",u)},x={},g={};Object.keys(h).forEach(f=>{const{newTags:y,oldTags:k}=h[f];y.length&&(x[f]=y),k.length&&(g[f]=h[f].oldTags)}),t&&t(),c(s,x,g)},Lt=null,cl=s=>{Lt&&cancelAnimationFrame(Lt),s.defer?Lt=requestAnimationFrame(()=>{ha(s,()=>{Lt=null})}):(ha(s),Lt=null)},dl=cl,ma=class extends b.Component{rendered=!1;shouldComponentUpdate(s){return!Vo(s,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:s}=this.props.context;s.remove(this),this.emitChange()}emitChange(){const{helmetInstances:s,setHelmet:t}=this.props.context;let r=null;const a=Zo(s.get().map(i=>{const n={...i.props};return delete n.context,n}));Fi.canUseDOM?dl(a):vr&&(r=vr(a)),t(r)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:s}=this.props.context;s.add(this),this.emitChange()}render(){return this.init(),null}},ul=class extends b.Component{static defaultProps={defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1};shouldComponentUpdate(s){return!Fo(ua(this.props,"helmetData"),ua(s,"helmetData"))}mapNestedChildrenToProps(s,t){if(!t)return null;switch(s.type){case"script":case"noscript":return{innerHTML:t};case"style":return{cssText:t};default:throw new Error(`<${s.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(s,t,r,a){return{...t,[s.type]:[...t[s.type]||[],{...r,...this.mapNestedChildrenToProps(s,a)}]}}mapObjectTypeChildren(s,t,r,a){switch(s.type){case"title":return{...t,[s.type]:a,titleAttributes:{...r}};case"body":return{...t,bodyAttributes:{...r}};case"html":return{...t,htmlAttributes:{...r}};default:return{...t,[s.type]:{...r}}}}mapArrayTypeChildrenToProps(s,t){let r={...t};return Object.keys(s).forEach(a=>{r={...r,[a]:s[a]}}),r}warnOnInvalidChildren(s,t){return la(da.some(r=>s.type===r),typeof s.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${da.join(", ")} are allowed. Helmet does not support rendering <${s.type}> elements. Refer to our API for more information.`),la(!t||typeof t=="string"||Array.isArray(t)&&!t.some(r=>typeof r!="string"),`Helmet expects a string as a child of <${s.type}>. Did you forget to wrap your children in braces? ( <${s.type}>{\`\`}</${s.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(s,t){let r={};return ge.Children.forEach(s,a=>{if(!a||!a.props)return;const{children:i,...n}=a.props,o=Object.keys(n).reduce((c,d)=>(c[Ko[d]||d]=n[d],c),{});let{type:l}=a;switch(typeof l=="symbol"?l=l.toString():this.warnOnInvalidChildren(a,i),l){case"Symbol(react.fragment)":t=this.mapChildrenToProps(i,t);break;case"link":case"meta":case"noscript":case"script":case"style":r=this.flattenArrayTypeChildren(a,r,o,i);break;default:t=this.mapObjectTypeChildren(a,t,o,i);break}}),this.mapArrayTypeChildrenToProps(r,t)}render(){const{children:s,...t}=this.props;let r={...t},{helmetData:a}=t;if(s&&(r=this.mapChildrenToProps(s,r)),a&&!(a instanceof jr)){const i=a;a=new jr(i.context,!0),delete r.helmetData}return a?ge.createElement(ma,{...r,context:a.value}):ge.createElement(Bi.Consumer,null,i=>ge.createElement(ma,{...r,context:i}))}};function $s(s,t){var r={};for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&t.indexOf(a)<0&&(r[a]=s[a]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,a=Object.getOwnPropertySymbols(s);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(s,a[i])&&(r[a[i]]=s[a[i]]);return r}function hl(s,t,r,a){function i(n){return n instanceof r?n:new r(function(o){o(n)})}return new(r||(r=Promise))(function(n,o){function l(u){try{d(a.next(u))}catch(m){o(m)}}function c(u){try{d(a.throw(u))}catch(m){o(m)}}function d(u){u.done?n(u.value):i(u.value).then(l,c)}d((a=a.apply(s,t||[])).next())})}const ml=s=>s?(...t)=>s(...t):(...t)=>fetch(...t);class Kr extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class xl extends Kr{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class xa extends Kr{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class fa extends Kr{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Nr;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(Nr||(Nr={}));class fl{constructor(t,{headers:r={},customFetch:a,region:i=Nr.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=ml(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return hl(this,arguments,void 0,function*(r,a={}){var i;let n,o;try{const{headers:l,method:c,body:d,signal:u,timeout:m}=a;let p={},{region:h}=a;h||(h=this.region);const x=new URL(`${this.url}/${r}`);h&&h!=="any"&&(p["x-region"]=h,x.searchParams.set("forceFunctionRegion",h));let g;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",g=d):typeof d=="string"?(p["Content-Type"]="text/plain",g=d):typeof FormData<"u"&&d instanceof FormData?g=d:(p["Content-Type"]="application/json",g=JSON.stringify(d)):g=d;let f=u;m&&(o=new AbortController,n=setTimeout(()=>o.abort(),m),u?(f=o.signal,u.addEventListener("abort",()=>o.abort())):f=o.signal);const y=yield this.fetch(x.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),l),body:g,signal:f}).catch(S=>{throw new xl(S)}),k=y.headers.get("x-relay-error");if(k&&k==="true")throw new xa(y);if(!y.ok)throw new fa(y);let w=((i=y.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),v;return w==="application/json"?v=yield y.json():w==="application/octet-stream"||w==="application/pdf"?v=yield y.blob():w==="text/event-stream"?v=y:w==="multipart/form-data"?v=yield y.formData():v=yield y.text(),{data:v,error:null,response:y}}catch(l){return{data:null,error:l,response:l instanceof fa||l instanceof xa?l.context:void 0}}finally{n&&clearTimeout(n)}})}}var gl=class extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}},pl=class{constructor(s){var t,r;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(t=s.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=s.signal,this.isMaybeSingle=(r=s.isMaybeSingle)!==null&&r!==void 0?r:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,t){return this.headers=new Headers(this.headers),this.headers.set(s,t),this}then(s,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let i=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async n=>{let o=null,l=null,c=null,d=n.status,u=n.statusText;if(n.ok){var m,p;if(r.method!=="HEAD"){var h;const y=await n.text();y===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((h=r.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?l=y:l=JSON.parse(y))}const g=(m=r.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),f=(p=n.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");g&&f&&f.length>1&&(c=parseInt(f[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(l)&&(l.length>1?(o={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,d=406,u="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var x;const g=await n.text();try{o=JSON.parse(g),Array.isArray(o)&&n.status===404&&(l=[],o=null,d=200,u="OK")}catch{n.status===404&&g===""?(d=204,u="No Content"):o={message:g}}if(o&&r.isMaybeSingle&&(!(o==null||(x=o.details)===null||x===void 0)&&x.includes("0 rows"))&&(o=null,d=200,u="OK"),o&&r.shouldThrowOnError)throw new gl(o)}return{error:o,data:l,count:c,status:d,statusText:u}});return this.shouldThrowOnError||(i=i.catch(n=>{var o;let l="";const c=n?.cause;if(c){var d,u,m,p;const x=(d=c?.message)!==null&&d!==void 0?d:"",g=(u=c?.code)!==null&&u!==void 0?u:"";l=`${(m=n?.name)!==null&&m!==void 0?m:"FetchError"}: ${n?.message}`,l+=`

Caused by: ${(p=c?.name)!==null&&p!==void 0?p:"Error"}: ${x}`,g&&(l+=` (${g})`),c?.stack&&(l+=`
${c.stack}`)}else{var h;l=(h=n?.stack)!==null&&h!==void 0?h:""}return{error:{message:`${(o=n?.name)!==null&&o!==void 0?o:"FetchError"}: ${n?.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(s,t)}returns(){return this}overrideTypes(){return this}},bl=class extends pl{select(s){let t=!1;const r=(s??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:i=a}={}){const n=i?`${i}.order`:"order",o=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${o?`${o},`:""}${s}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:t,referencedTable:r=t}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${s}`),this}range(s,t,{foreignTable:r,referencedTable:a=r}={}){const i=typeof a>"u"?"offset":`${a}.offset`,n=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${s}`),this.url.searchParams.set(n,`${t-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:i=!1,format:n="text"}={}){var o;const l=[s?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${n}; for="${c}"; options=${l};`),n==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}};const ga=new RegExp("[,()]");var vt=class extends bl{eq(s,t){return this.url.searchParams.append(s,`eq.${t}`),this}neq(s,t){return this.url.searchParams.append(s,`neq.${t}`),this}gt(s,t){return this.url.searchParams.append(s,`gt.${t}`),this}gte(s,t){return this.url.searchParams.append(s,`gte.${t}`),this}lt(s,t){return this.url.searchParams.append(s,`lt.${t}`),this}lte(s,t){return this.url.searchParams.append(s,`lte.${t}`),this}like(s,t){return this.url.searchParams.append(s,`like.${t}`),this}likeAllOf(s,t){return this.url.searchParams.append(s,`like(all).{${t.join(",")}}`),this}likeAnyOf(s,t){return this.url.searchParams.append(s,`like(any).{${t.join(",")}}`),this}ilike(s,t){return this.url.searchParams.append(s,`ilike.${t}`),this}ilikeAllOf(s,t){return this.url.searchParams.append(s,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(s,t){return this.url.searchParams.append(s,`ilike(any).{${t.join(",")}}`),this}regexMatch(s,t){return this.url.searchParams.append(s,`match.${t}`),this}regexIMatch(s,t){return this.url.searchParams.append(s,`imatch.${t}`),this}is(s,t){return this.url.searchParams.append(s,`is.${t}`),this}isDistinct(s,t){return this.url.searchParams.append(s,`isdistinct.${t}`),this}in(s,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&ga.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(s,`in.(${r})`),this}notIn(s,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&ga.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(s,`not.in.(${r})`),this}contains(s,t){return typeof t=="string"?this.url.searchParams.append(s,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(s,`cs.{${t.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(t)}`),this}containedBy(s,t){return typeof t=="string"?this.url.searchParams.append(s,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(s,`cd.{${t.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(t)}`),this}rangeGt(s,t){return this.url.searchParams.append(s,`sr.${t}`),this}rangeGte(s,t){return this.url.searchParams.append(s,`nxl.${t}`),this}rangeLt(s,t){return this.url.searchParams.append(s,`sl.${t}`),this}rangeLte(s,t){return this.url.searchParams.append(s,`nxr.${t}`),this}rangeAdjacent(s,t){return this.url.searchParams.append(s,`adj.${t}`),this}overlaps(s,t){return typeof t=="string"?this.url.searchParams.append(s,`ov.${t}`):this.url.searchParams.append(s,`ov.{${t.join(",")}}`),this}textSearch(s,t,{config:r,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const n=r===void 0?"":`(${r})`;return this.url.searchParams.append(s,`${i}fts${n}.${t}`),this}match(s){return Object.entries(s).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(s,t,r){return this.url.searchParams.append(s,`not.${t}.${r}`),this}or(s,{foreignTable:t,referencedTable:r=t}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${s})`),this}filter(s,t,r){return this.url.searchParams.append(s,`${t}.${r}`),this}},yl=class{constructor(s,{headers:t={},schema:r,fetch:a}){this.url=s,this.headers=new Headers(t),this.schema=r,this.fetch=a}select(s,t){const{head:r=!1,count:a}=t??{},i=r?"HEAD":"GET";let n=!1;const o=(s??"*").split("").map(l=>/\s/.test(l)&&!n?"":(l==='"'&&(n=!n),l)).join("");return this.url.searchParams.set("select",o),a&&this.headers.append("Prefer",`count=${a}`),new vt({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:t,defaultToNull:r=!0}={}){var a;const i="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const n=s.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(n.length>0){const o=[...new Set(n)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new vt({method:i,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(s,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:i=!0}={}){var n;const o="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const l=s.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(l.length>0){const c=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new vt({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}update(s,{count:t}={}){var r;const a="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new vt({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:s}={}){var t;const r="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new vt({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},wl=class Hi{constructor(t,{headers:r={},schema:a,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=a,this.fetch=i}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new yl(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Hi(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:a=!1,get:i=!1,count:n}={}){var o;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;a||i?(l=a?"HEAD":"GET",Object.entries(r).filter(([m,p])=>p!==void 0).map(([m,p])=>[m,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([m,p])=>{c.searchParams.append(m,p)})):(l="POST",d=r);const u=new Headers(this.headers);return n&&u.set("Prefer",`count=${n}`),new vt({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class vl{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,i=parseInt(a.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const jl="2.89.0",kl=`realtime-js/${jl}`,Wi="1.0.0",Nl="2.0.0",pa=Wi,_r=1e4,_l=1e3,Sl=100;var Ve;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Ve||(Ve={}));var ie;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(ie||(ie={}));var Oe;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(Oe||(Oe={}));var Sr;(function(s){s.websocket="websocket"})(Sr||(Sr={}));var Ze;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(Ze||(Ze={}));class El{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let a=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,a;const i=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,a;const i=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},o=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,a){var i,n;const o=t.topic,l=(i=t.ref)!==null&&i!==void 0?i:"",c=(n=t.join_ref)!==null&&n!==void 0?n:"",d=t.payload.event,u=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},m=Object.keys(u).length===0?"":JSON.stringify(u);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+d.length+m.length,h=new ArrayBuffer(this.HEADER_LENGTH+p);let x=new DataView(h),g=0;x.setUint8(g++,this.KINDS.userBroadcastPush),x.setUint8(g++,c.length),x.setUint8(g++,l.length),x.setUint8(g++,o.length),x.setUint8(g++,d.length),x.setUint8(g++,m.length),x.setUint8(g++,r),Array.from(c,y=>x.setUint8(g++,y.charCodeAt(0))),Array.from(l,y=>x.setUint8(g++,y.charCodeAt(0))),Array.from(o,y=>x.setUint8(g++,y.charCodeAt(0))),Array.from(d,y=>x.setUint8(g++,y.charCodeAt(0))),Array.from(m,y=>x.setUint8(g++,y.charCodeAt(0)));var f=new Uint8Array(h.byteLength+a.byteLength);return f.set(new Uint8Array(h),0),f.set(new Uint8Array(a),h.byteLength),f.buffer}decode(t,r){if(this._isArrayBuffer(t)){let a=this._binaryDecode(t);return r(a)}if(typeof t=="string"){const a=JSON.parse(t),[i,n,o,l,c]=a;return r({join_ref:i,ref:n,topic:o,event:l,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),a=r.getUint8(0),i=new TextDecoder;if(a===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,r,i)}_decodeUserBroadcast(t,r,a){const i=r.getUint8(1),n=r.getUint8(2),o=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const d=a.decode(t.slice(c,c+i));c=c+i;const u=a.decode(t.slice(c,c+n));c=c+n;const m=a.decode(t.slice(c,c+o));c=c+o;const p=t.slice(c,t.byteLength),h=l===this.JSON_ENCODING?JSON.parse(a.decode(p)):p,x={type:this.BROADCAST_EVENT,event:u,payload:h};return o>0&&(x.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([a])=>r.includes(a)))}}class zi{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Y;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(Y||(Y={}));const ba=(s,t,r={})=>{var a;const i=(a=r.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((n,o)=>(n[o]=Tl(o,s,t,i),n),{}):{}},Tl=(s,t,r,a)=>{const i=t.find(l=>l.name===s),n=i?.type,o=r[s];return n&&!a.includes(n)?Vi(n,o):Er(o)},Vi=(s,t)=>{if(s.charAt(0)==="_"){const r=s.slice(1,s.length);return Ol(t,r)}switch(s){case Y.bool:return Cl(t);case Y.float4:case Y.float8:case Y.int2:case Y.int4:case Y.int8:case Y.numeric:case Y.oid:return Al(t);case Y.json:case Y.jsonb:return Pl(t);case Y.timestamp:return Rl(t);case Y.abstime:case Y.date:case Y.daterange:case Y.int4range:case Y.int8range:case Y.money:case Y.reltime:case Y.text:case Y.time:case Y.timestamptz:case Y.timetz:case Y.tsrange:case Y.tstzrange:return Er(t);default:return Er(t)}},Er=s=>s,Cl=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},Al=s=>{if(typeof s=="string"){const t=parseFloat(s);if(!Number.isNaN(t))return t}return s},Pl=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch{return s}return s},Ol=(s,t)=>{if(typeof s!="string")return s;const r=s.length-1,a=s[r];if(s[0]==="{"&&a==="}"){let n;const o=s.slice(1,r);try{n=JSON.parse("["+o+"]")}catch{n=o?o.split(","):[]}return n.map(l=>Vi(t,l))}return s},Rl=s=>typeof s=="string"?s.replace(" ","T"):s,Ki=s=>{const t=new URL(s);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Xs{constructor(t,r,a={},i=_r){this.channel=t,this.event=r,this.payload=a,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var ya;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(ya||(ya={}));class Wt{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},i=>{const{onJoin:n,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Wt.syncState(this.state,i,n,o),this.pendingDiffs.forEach(c=>{this.state=Wt.syncDiff(this.state,c,n,o)}),this.pendingDiffs=[],l()}),this.channel._on(a.diff,{},i=>{const{onJoin:n,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Wt.syncDiff(this.state,i,n,o),l())}),this.onJoin((i,n,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:n,newPresences:o})}),this.onLeave((i,n,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:n,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,i){const n=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(n,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const m=n[d];if(m){const p=u.map(f=>f.presence_ref),h=m.map(f=>f.presence_ref),x=u.filter(f=>h.indexOf(f.presence_ref)<0),g=m.filter(f=>p.indexOf(f.presence_ref)<0);x.length>0&&(l[d]=x),g.length>0&&(c[d]=g)}else l[d]=u}),this.syncDiff(n,{joins:l,leaves:c},a,i)}static syncDiff(t,r,a,i){const{joins:n,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),i||(i=()=>{}),this.map(n,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const m=t[l].map(h=>h.presence_ref),p=u.filter(h=>m.indexOf(h.presence_ref)<0);t[l].unshift(...p)}a(l,u,c)}),this.map(o,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(m=>m.presence_ref);d=d.filter(m=>u.indexOf(m.presence_ref)<0),t[l]=d,i(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const i=t[a];return"metas"in i?r[a]=i.metas.map(n=>(n.presence_ref=n.phx_ref,delete n.phx_ref,delete n.phx_ref_prev,n)):r[a]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var wa;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(wa||(wa={}));var zt;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(zt||(zt={}));var Fe;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Fe||(Fe={}));class _t{constructor(t,r={config:{}},a){var i,n;if(this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=ie.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Xs(this,Oe.join,this.params,this.timeout),this.rejoinTimer=new zi(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ie.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ie.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ie.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ie.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ie.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Oe.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Wt(this),this.broadcastEndpointURL=Ki(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((n=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||n===void 0)&&n.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var a,i,n;if(this.socket.isConnected()||this.socket.connect(),this.state==ie.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(i=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(h=>h.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[zt.PRESENCE]&&this.bindings[zt.PRESENCE].length>0||((n=this.params.config.presence)===null||n===void 0?void 0:n.enabled)===!0,m={},p={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(h=>t?.(Fe.CHANNEL_ERROR,h)),this._onClose(()=>t?.(Fe.CLOSED)),this.updateJoinPayload(Object.assign({config:p},m)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var x;if(this.socket._isManualToken()||this.socket.setAuth(),h===void 0){t?.(Fe.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,f=(x=g?.length)!==null&&x!==void 0?x:0,y=[];for(let k=0;k<f;k++){const w=g[k],{filter:{event:v,schema:S,table:_,filter:E}}=w,$=h&&h[k];if($&&$.event===v&&_t.isFilterValueEqual($.schema,S)&&_t.isFilterValueEqual($.table,_)&&_t.isFilterValueEqual($.filter,E))y.push(Object.assign(Object.assign({},w),{id:$.id}));else{this.unsubscribe(),this.state=ie.errored,t?.(Fe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(Fe.SUBSCRIBED);return}}).receive("error",h=>{this.state=ie.errored,t?.(Fe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t?.(Fe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===ie.joined&&t===zt.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,a)}async httpSend(t,r,a={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const n={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(n.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:n,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(i=a.timeout)!==null&&i!==void 0?i:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var a,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:n,payload:o}=t,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(n=>{var o,l,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&n("ok"),d.receive("ok",()=>n("ok")),d.receive("error",()=>n("error")),d.receive("timeout",()=>n("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ie.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Oe.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(i=>{a=new Xs(this,Oe.leave,{},t),a.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ie.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const i=new AbortController,n=setTimeout(()=>i.abort(),a),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(n),o}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Xs(this,t,r,a);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Sl){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var i,n;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=Oe;if(a&&[l,c,d,u].indexOf(o)>=0&&a!==this._joinRef())return;let p=this._onMessage(o,r,a);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(h=>{var x,g,f;return((x=h.filter)===null||x===void 0?void 0:x.event)==="*"||((f=(g=h.filter)===null||g===void 0?void 0:g.event)===null||f===void 0?void 0:f.toLocaleLowerCase())===o}).map(h=>h.callback(p,a)):(n=this.bindings[o])===null||n===void 0||n.filter(h=>{var x,g,f,y,k,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const v=h.id,S=(x=h.filter)===null||x===void 0?void 0:x.event;return v&&((g=r.ids)===null||g===void 0?void 0:g.includes(v))&&(S==="*"||S?.toLocaleLowerCase()===((f=r.data)===null||f===void 0?void 0:f.type.toLocaleLowerCase()))}else{const v=(k=(y=h?.filter)===null||y===void 0?void 0:y.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return v==="*"||v===((w=r?.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof p=="object"&&"ids"in p){const x=p.data,{schema:g,table:f,commit_timestamp:y,type:k,errors:w}=x;p=Object.assign(Object.assign({},{schema:g,table:f,commit_timestamp:y,eventType:k,new:{},old:{},errors:w}),this._getPayloadRecords(x))}h.callback(p,a)})}_isClosed(){return this.state===ie.closed}_isJoined(){return this.state===ie.joined}_isJoining(){return this.state===ie.joining}_isLeaving(){return this.state===ie.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const i=t.toLocaleLowerCase(),n={type:i,filter:r,callback:a};return this.bindings[i]?this.bindings[i].push(n):this.bindings[i]=[n],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(i=>{var n;return!(((n=i.type)===null||n===void 0?void 0:n.toLocaleLowerCase())===a&&_t.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Oe.close,{},t)}_onError(t){this._on(Oe.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ie.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=ba(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=ba(t.columns,t.old_record)),r}}const Qs=()=>{},ds={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Il=[1e3,2e3,5e3,1e4],$l=1e4,Ll=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ul{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=_r,this.transport=null,this.heartbeatIntervalMs=ds.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Qs,this.ref=0,this.reconnectTimer=null,this.vsn=pa,this.logger=Qs,this.conn=null,this.sendBuffer=[],this.serializer=new El,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...n)=>i(...n):(...n)=>fetch(...n),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Sr.websocket}`,this.httpEndpoint=Ki(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=vl.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case Ve.connecting:return Ze.Connecting;case Ve.open:return Ze.Open;case Ve.closing:return Ze.Closing;default:return Ze.Closed}}isConnected(){return this.connectionState()===Ze.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,i=this.getChannels().find(n=>n.topic===a);if(i)return i;{const n=new _t(`realtime:${t}`,r,this);return this.channels.push(n),n}}push(t){const{topic:r,event:a,payload:i,ref:n}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${a} (${n})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(_l,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},ds.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:i,payload:n,ref:o}=r,l=o?`(${o})`:"",c=n.status||"";this.log("receive",`${c} ${a} ${i} ${l}`.trim(),n),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(i,n,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Ve.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ve.open||this.conn.readyState===Ve.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Oe.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${a}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([Ll],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,a=!1;if(t)r=t,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const n={access_token:r,version:kl};r&&i.updateJoinPayload(n),i.joinedOnce&&i._isJoined()&&i._push(Oe.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new zi(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ds.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,i,n,o,l,c,d,u,m,p,h;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t?.timeout)!==null&&a!==void 0?a:_r,this.heartbeatIntervalMs=(i=t?.heartbeatIntervalMs)!==null&&i!==void 0?i:ds.HEARTBEAT_INTERVAL,this.worker=(n=t?.worker)!==null&&n!==void 0?n:!1,this.accessToken=(o=t?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t?.heartbeatCallback)!==null&&l!==void 0?l:Qs,this.vsn=(c=t?.vsn)!==null&&c!==void 0?c:pa,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t?.reconnectAfterMs)!==null&&d!==void 0?d:(x=>Il[x-1]||$l),this.vsn){case Wi:this.encode=(u=t?.encode)!==null&&u!==void 0?u:((x,g)=>g(JSON.stringify(x))),this.decode=(m=t?.decode)!==null&&m!==void 0?m:((x,g)=>g(JSON.parse(x)));break;case Nl:this.encode=(p=t?.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(h=t?.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var Yt=class extends Error{constructor(s,t){super(s),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Dl(s,t,r){const a=new URL(t,s);if(r)for(const[i,n]of Object.entries(r))n!==void 0&&a.searchParams.set(i,n);return a.toString()}async function Ml(s){return!s||s.type==="none"?{}:s.type==="bearer"?{Authorization:`Bearer ${s.token}`}:s.type==="header"?{[s.name]:s.value}:s.type==="custom"?await s.getHeaders():{}}function Bl(s){const t=s.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:i,body:n,headers:o}){const l=Dl(s.baseUrl,a,i),c=await Ml(s.auth),d=await t(l,{method:r,headers:{...n?{"Content-Type":"application/json"}:{},...c,...o},body:n?JSON.stringify(n):void 0}),u=await d.text(),m=(d.headers.get("content-type")||"").includes("application/json"),p=m&&u?JSON.parse(u):u;if(!d.ok){const h=m?p:void 0,x=h?.error;throw new Yt(x?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:x?.type,icebergCode:x?.code,details:h})}return{status:d.status,headers:d.headers,data:p}}}}function us(s){return s.join("")}var Fl=class{constructor(s,t=""){this.client=s,this.prefix=t}async listNamespaces(s){const t=s?{parent:us(s.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(s,t){const r={namespace:s.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(s){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${us(s.namespace)}`})}async loadNamespaceMetadata(s){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${us(s.namespace)}`})).data.properties}}async namespaceExists(s){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${us(s.namespace)}`}),!0}catch(t){if(t instanceof Yt&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(s,t){try{return await this.createNamespace(s,t)}catch(r){if(r instanceof Yt&&r.status===409)return;throw r}}};function mt(s){return s.join("")}var ql=class{constructor(s,t="",r){this.client=s,this.prefix=t,this.accessDelegation=r}async listTables(s){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${mt(s.namespace)}/tables`})).data.identifiers}async createTable(s,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${mt(s.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(s,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${mt(s.namespace)}/tables/${s.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(s,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${mt(s.namespace)}/tables/${s.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(s){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${mt(s.namespace)}/tables/${s.name}`,headers:t})).data.metadata}async tableExists(s){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${mt(s.namespace)}/tables/${s.name}`,headers:t}),!0}catch(r){if(r instanceof Yt&&r.status===404)return!1;throw r}}async createTableIfNotExists(s,t){try{return await this.createTable(s,t)}catch(r){if(r instanceof Yt&&r.status===409)return await this.loadTable({namespace:s.namespace,name:t.name});throw r}}},Hl=class{constructor(s){let t="v1";s.catalogName&&(t+=`/${s.catalogName}`);const r=s.baseUrl.endsWith("/")?s.baseUrl:`${s.baseUrl}/`;this.client=Bl({baseUrl:r,auth:s.auth,fetchImpl:s.fetch}),this.accessDelegation=s.accessDelegation?.join(","),this.namespaceOps=new Fl(this.client,t),this.tableOps=new ql(this.client,t,this.accessDelegation)}async listNamespaces(s){return this.namespaceOps.listNamespaces(s)}async createNamespace(s,t){return this.namespaceOps.createNamespace(s,t)}async dropNamespace(s){await this.namespaceOps.dropNamespace(s)}async loadNamespaceMetadata(s){return this.namespaceOps.loadNamespaceMetadata(s)}async listTables(s){return this.tableOps.listTables(s)}async createTable(s,t){return this.tableOps.createTable(s,t)}async updateTable(s,t){return this.tableOps.updateTable(s,t)}async dropTable(s,t){await this.tableOps.dropTable(s,t)}async loadTable(s){return this.tableOps.loadTable(s)}async namespaceExists(s){return this.namespaceOps.namespaceExists(s)}async tableExists(s){return this.tableOps.tableExists(s)}async createNamespaceIfNotExists(s,t){return this.namespaceOps.createNamespaceIfNotExists(s,t)}async createTableIfNotExists(s,t){return this.tableOps.createTableIfNotExists(s,t)}},Ls=class extends Error{constructor(s){super(s),this.__isStorageError=!0,this.name="StorageError"}};function ee(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}var Wl=class extends Ls{constructor(s,t,r){super(s),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Tr=class extends Ls{constructor(s,t){super(s),this.name="StorageUnknownError",this.originalError=t}};const Gr=s=>s?(...t)=>s(...t):(...t)=>fetch(...t),zl=()=>Response,Cr=s=>{if(Array.isArray(s))return s.map(r=>Cr(r));if(typeof s=="function"||s!==Object(s))return s;const t={};return Object.entries(s).forEach(([r,a])=>{const i=r.replace(/([-_][a-z])/gi,n=>n.toUpperCase().replace(/[-_]/g,""));t[i]=Cr(a)}),t},Vl=s=>{if(typeof s!="object"||s===null)return!1;const t=Object.getPrototypeOf(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},Kl=s=>!s||typeof s!="string"||s.length===0||s.length>100||s.trim()!==s||s.includes("/")||s.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(s);function Xt(s){"@babel/helpers - typeof";return Xt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(s)}function Gl(s,t){if(Xt(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var a=r.call(s,t);if(Xt(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function Jl(s){var t=Gl(s,"string");return Xt(t)=="symbol"?t:t+""}function Yl(s,t,r){return(t=Jl(t))in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function va(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),r.push.apply(r,a)}return r}function D(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?va(Object(r),!0).forEach(function(a){Yl(s,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):va(Object(r)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(r,a))})}return s}const Zs=s=>{var t;return s.msg||s.message||s.error_description||(typeof s.error=="string"?s.error:(t=s.error)===null||t===void 0?void 0:t.message)||JSON.stringify(s)},Xl=async(s,t,r)=>{s instanceof await zl()&&!r?.noResolveJson?s.json().then(a=>{const i=s.status||500,n=a?.statusCode||i+"";t(new Wl(Zs(a),i,n))}).catch(a=>{t(new Tr(Zs(a),a))}):t(new Tr(Zs(s),s))},Ql=(s,t,r,a)=>{const i={method:s,headers:t?.headers||{}};return s==="GET"||!a?i:(Vl(a)?(i.headers=D({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(a)):i.body=a,t?.duplex&&(i.duplex=t.duplex),D(D({},i),r))};async function ss(s,t,r,a,i,n){return new Promise((o,l)=>{s(r,Ql(t,a,i,n)).then(c=>{if(!c.ok)throw c;return a?.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Xl(c,l,a))})}async function Qt(s,t,r,a){return ss(s,"GET",t,r,a)}async function Pe(s,t,r,a,i){return ss(s,"POST",t,a,i,r)}async function Ar(s,t,r,a,i){return ss(s,"PUT",t,a,i,r)}async function Zl(s,t,r,a){return ss(s,"HEAD",t,D(D({},r),{},{noResolveJson:!0}),a)}async function Jr(s,t,r,a,i){return ss(s,"DELETE",t,a,i,r)}var ec=class{constructor(s,t){this.downloadFn=s,this.shouldThrowOnError=t}then(s,t){return this.execute().then(s,t)}async execute(){var s=this;try{return{data:(await s.downloadFn()).body,error:null}}catch(t){if(s.shouldThrowOnError)throw t;if(ee(t))return{data:null,error:t};throw t}}};let Gi;Gi=Symbol.toStringTag;var tc=class{constructor(s,t){this.downloadFn=s,this.shouldThrowOnError=t,this[Gi]="BlobDownloadBuilder",this.promise=null}asStream(){return new ec(this.downloadFn,this.shouldThrowOnError)}then(s,t){return this.getPromise().then(s,t)}catch(s){return this.getPromise().catch(s)}finally(s){return this.getPromise().finally(s)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var s=this;try{return{data:await(await s.downloadFn()).blob(),error:null}}catch(t){if(s.shouldThrowOnError)throw t;if(ee(t))return{data:null,error:t};throw t}}};const sc={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ja={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var rc=class{constructor(s,t={},r,a){this.shouldThrowOnError=!1,this.url=s,this.headers=t,this.bucketId=r,this.fetch=Gr(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(s,t,r,a){var i=this;try{let n;const o=D(D({},ja),a);let l=D(D({},i.headers),s==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(n=new FormData,n.append("cacheControl",o.cacheControl),c&&n.append("metadata",i.encodeMetadata(c)),n.append("",r)):typeof FormData<"u"&&r instanceof FormData?(n=r,n.has("cacheControl")||n.append("cacheControl",o.cacheControl),c&&!n.has("metadata")&&n.append("metadata",i.encodeMetadata(c))):(n=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=i.toBase64(i.encodeMetadata(c))),(typeof ReadableStream<"u"&&n instanceof ReadableStream||n&&typeof n=="object"&&"pipe"in n&&typeof n.pipe=="function")&&!o.duplex&&(o.duplex="half")),a?.headers&&(l=D(D({},l),a.headers));const d=i._removeEmptyFolders(t),u=i._getFinalPath(d),m=await(s=="PUT"?Ar:Pe)(i.fetch,`${i.url}/object/${u}`,n,D({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:m.Id,fullPath:m.Key},error:null}}catch(n){if(i.shouldThrowOnError)throw n;if(ee(n))return{data:null,error:n};throw n}}async upload(s,t,r){return this.uploadOrUpdate("POST",s,t,r)}async uploadToSignedUrl(s,t,r,a){var i=this;const n=i._removeEmptyFolders(s),o=i._getFinalPath(n),l=new URL(i.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=D({upsert:ja.upsert},a),u=D(D({},i.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType),{data:{path:n,fullPath:(await Ar(i.fetch,l.toString(),c,{headers:u})).Key},error:null}}catch(c){if(i.shouldThrowOnError)throw c;if(ee(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(s,t){var r=this;try{let a=r._getFinalPath(s);const i=D({},r.headers);t?.upsert&&(i["x-upsert"]="true");const n=await Pe(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:i}),o=new URL(r.url+n.url),l=o.searchParams.get("token");if(!l)throw new Ls("No token returned by API");return{data:{signedUrl:o.toString(),path:s,token:l},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(ee(a))return{data:null,error:a};throw a}}async update(s,t,r){return this.uploadOrUpdate("PUT",s,t,r)}async move(s,t,r){var a=this;try{return{data:await Pe(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:s,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:a.headers}),error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(ee(i))return{data:null,error:i};throw i}}async copy(s,t,r){var a=this;try{return{data:{path:(await Pe(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:s,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:a.headers})).Key},error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(ee(i))return{data:null,error:i};throw i}}async createSignedUrl(s,t,r){var a=this;try{let i=a._getFinalPath(s),n=await Pe(a.fetch,`${a.url}/object/sign/${i}`,D({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:a.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return n={signedUrl:encodeURI(`${a.url}${n.signedURL}${o}`)},{data:n,error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(ee(i))return{data:null,error:i};throw i}}async createSignedUrls(s,t,r){var a=this;try{const i=await Pe(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:s},{headers:a.headers}),n=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>D(D({},o),{},{signedUrl:o.signedURL?encodeURI(`${a.url}${o.signedURL}${n}`):null})),error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(ee(i))return{data:null,error:i};throw i}}download(s,t){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),i=a?`?${a}`:"",n=this._getFinalPath(s),o=()=>Qt(this.fetch,`${this.url}/${r}/${n}${i}`,{headers:this.headers,noResolveJson:!0});return new tc(o,this.shouldThrowOnError)}async info(s){var t=this;const r=t._getFinalPath(s);try{return{data:Cr(await Qt(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(ee(a))return{data:null,error:a};throw a}}async exists(s){var t=this;const r=t._getFinalPath(s);try{return await Zl(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(ee(a)&&a instanceof Tr){const i=a.originalError;if([400,404].includes(i?.status))return{data:!1,error:a}}throw a}}getPublicUrl(s,t){const r=this._getFinalPath(s),a=[],i=t?.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&a.push(i);const n=typeof t?.transform<"u"?"render/image":"object",o=this.transformOptsToQueryString(t?.transform||{});o!==""&&a.push(o);let l=a.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${n}/public/${r}${l}`)}}}async remove(s){var t=this;try{return{data:await Jr(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:s},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}async list(s,t,r){var a=this;try{const i=D(D(D({},sc),t),{},{prefix:s||""});return{data:await Pe(a.fetch,`${a.url}/object/list/${a.bucketId}`,i,{headers:a.headers},r),error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(ee(i))return{data:null,error:i};throw i}}async listV2(s,t){var r=this;try{const a=D({},s);return{data:await Pe(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},t),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(ee(a))return{data:null,error:a};throw a}}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s.replace(/^\/+/,"")}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){const t=[];return s.width&&t.push(`width=${s.width}`),s.height&&t.push(`height=${s.height}`),s.resize&&t.push(`resize=${s.resize}`),s.format&&t.push(`format=${s.format}`),s.quality&&t.push(`quality=${s.quality}`),t.join("&")}};const Ji="2.89.0",Yi={"X-Client-Info":`storage-js/${Ji}`};var ac=class{constructor(s,t={},r,a){this.shouldThrowOnError=!1;const i=new URL(s);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=D(D({},Yi),t),this.fetch=Gr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(s){var t=this;try{const r=t.listBucketOptionsToQueryString(s);return{data:await Qt(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}async getBucket(s){var t=this;try{return{data:await Qt(t.fetch,`${t.url}/bucket/${s}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}async createBucket(s,t={public:!1}){var r=this;try{return{data:await Pe(r.fetch,`${r.url}/bucket`,{id:s,name:s,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(ee(a))return{data:null,error:a};throw a}}async updateBucket(s,t){var r=this;try{return{data:await Ar(r.fetch,`${r.url}/bucket/${s}`,{id:s,name:s,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(ee(a))return{data:null,error:a};throw a}}async emptyBucket(s){var t=this;try{return{data:await Pe(t.fetch,`${t.url}/bucket/${s}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}async deleteBucket(s){var t=this;try{return{data:await Jr(t.fetch,`${t.url}/bucket/${s}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(s){const t={};return s&&("limit"in s&&(t.limit=String(s.limit)),"offset"in s&&(t.offset=String(s.offset)),s.search&&(t.search=s.search),s.sortColumn&&(t.sortColumn=s.sortColumn),s.sortOrder&&(t.sortOrder=s.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},ic=class{constructor(s,t={},r){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=D(D({},Yi),t),this.fetch=Gr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(s){var t=this;try{return{data:await Pe(t.fetch,`${t.url}/bucket`,{name:s},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}async listBuckets(s){var t=this;try{const r=new URLSearchParams;s?.limit!==void 0&&r.set("limit",s.limit.toString()),s?.offset!==void 0&&r.set("offset",s.offset.toString()),s?.sortColumn&&r.set("sortColumn",s.sortColumn),s?.sortOrder&&r.set("sortOrder",s.sortOrder),s?.search&&r.set("search",s.search);const a=r.toString(),i=a?`${t.url}/bucket?${a}`:`${t.url}/bucket`;return{data:await Qt(t.fetch,i,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}async deleteBucket(s){var t=this;try{return{data:await Jr(t.fetch,`${t.url}/bucket/${s}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}from(s){var t=this;if(!Kl(s))throw new Ls("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Hl({baseUrl:this.url,catalogName:s,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(i,n){const o=i[n];return typeof o!="function"?o:async(...l)=>{try{return{data:await o.apply(i,l),error:null}}catch(c){if(a)throw c;return{data:null,error:c}}}}})}};const Yr={"X-Client-Info":`storage-js/${Ji}`,"Content-Type":"application/json"};var Xi=class extends Error{constructor(s){super(s),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Se(s){return typeof s=="object"&&s!==null&&"__isStorageVectorsError"in s}var er=class extends Xi{constructor(s,t,r){super(s),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},nc=class extends Xi{constructor(s,t){super(s),this.name="StorageVectorsUnknownError",this.originalError=t}};const Xr=s=>s?(...t)=>s(...t):(...t)=>fetch(...t),oc=s=>{if(typeof s!="object"||s===null)return!1;const t=Object.getPrototypeOf(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},ka=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),lc=async(s,t,r)=>{if(s&&typeof s=="object"&&"status"in s&&"ok"in s&&typeof s.status=="number"&&!r?.noResolveJson){const a=s.status||500,i=s;if(typeof i.json=="function")i.json().then(n=>{const o=n?.statusCode||n?.code||a+"";t(new er(ka(n),a,o))}).catch(()=>{const n=a+"";t(new er(i.statusText||`HTTP ${a} error`,a,n))});else{const n=a+"";t(new er(i.statusText||`HTTP ${a} error`,a,n))}}else t(new nc(ka(s),s))},cc=(s,t,r,a)=>{const i={method:s,headers:t?.headers||{}};return a?(oc(a)?(i.headers=D({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(a)):i.body=a,D(D({},i),r)):i};async function dc(s,t,r,a,i,n){return new Promise((o,l)=>{s(r,cc(t,a,i,n)).then(c=>{if(!c.ok)throw c;if(a?.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>lc(c,l,a))})}async function Ee(s,t,r,a,i){return dc(s,"POST",t,a,i,r)}var uc=class{constructor(s,t={},r){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=D(D({},Yr),t),this.fetch=Xr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(s){var t=this;try{return{data:await Ee(t.fetch,`${t.url}/CreateIndex`,s,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}}async getIndex(s,t){var r=this;try{return{data:await Ee(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:s,indexName:t},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Se(a))return{data:null,error:a};throw a}}async listIndexes(s){var t=this;try{return{data:await Ee(t.fetch,`${t.url}/ListIndexes`,s,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}}async deleteIndex(s,t){var r=this;try{return{data:await Ee(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:s,indexName:t},{headers:r.headers})||{},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Se(a))return{data:null,error:a};throw a}}},hc=class{constructor(s,t={},r){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=D(D({},Yr),t),this.fetch=Xr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(s){var t=this;try{if(s.vectors.length<1||s.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Ee(t.fetch,`${t.url}/PutVectors`,s,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}}async getVectors(s){var t=this;try{return{data:await Ee(t.fetch,`${t.url}/GetVectors`,s,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}}async listVectors(s){var t=this;try{if(s.segmentCount!==void 0){if(s.segmentCount<1||s.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(s.segmentIndex!==void 0&&(s.segmentIndex<0||s.segmentIndex>=s.segmentCount))throw new Error(`segmentIndex must be between 0 and ${s.segmentCount-1}`)}return{data:await Ee(t.fetch,`${t.url}/ListVectors`,s,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}}async queryVectors(s){var t=this;try{return{data:await Ee(t.fetch,`${t.url}/QueryVectors`,s,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}}async deleteVectors(s){var t=this;try{if(s.keys.length<1||s.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Ee(t.fetch,`${t.url}/DeleteVectors`,s,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}}},mc=class{constructor(s,t={},r){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=D(D({},Yr),t),this.fetch=Xr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(s){var t=this;try{return{data:await Ee(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:s},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}}async getBucket(s){var t=this;try{return{data:await Ee(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:s},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}}async listBuckets(s={}){var t=this;try{return{data:await Ee(t.fetch,`${t.url}/ListVectorBuckets`,s,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}}async deleteBucket(s){var t=this;try{return{data:await Ee(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:s},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Se(r))return{data:null,error:r};throw r}}},xc=class extends mc{constructor(s,t={}){super(s,t.headers||{},t.fetch)}from(s){return new fc(this.url,this.headers,s,this.fetch)}async createBucket(s){var t=()=>super.createBucket,r=this;return t().call(r,s)}async getBucket(s){var t=()=>super.getBucket,r=this;return t().call(r,s)}async listBuckets(s={}){var t=()=>super.listBuckets,r=this;return t().call(r,s)}async deleteBucket(s){var t=()=>super.deleteBucket,r=this;return t().call(r,s)}},fc=class extends uc{constructor(s,t,r,a){super(s,t,a),this.vectorBucketName=r}async createIndex(s){var t=()=>super.createIndex,r=this;return t().call(r,D(D({},s),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(s={}){var t=()=>super.listIndexes,r=this;return t().call(r,D(D({},s),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(s){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,s)}async deleteIndex(s){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,s)}index(s){return new gc(this.url,this.headers,this.vectorBucketName,s,this.fetch)}},gc=class extends hc{constructor(s,t,r,a,i){super(s,t,i),this.vectorBucketName=r,this.indexName=a}async putVectors(s){var t=()=>super.putVectors,r=this;return t().call(r,D(D({},s),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(s){var t=()=>super.getVectors,r=this;return t().call(r,D(D({},s),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(s={}){var t=()=>super.listVectors,r=this;return t().call(r,D(D({},s),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(s){var t=()=>super.queryVectors,r=this;return t().call(r,D(D({},s),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(s){var t=()=>super.deleteVectors,r=this;return t().call(r,D(D({},s),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},pc=class extends ac{constructor(s,t={},r,a){super(s,t,r,a)}from(s){return new rc(this.url,this.headers,s,this.fetch)}get vectors(){return new xc(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ic(this.url+"/iceberg",this.headers,this.fetch)}};const Qi="2.89.0",jt=30*1e3,Pr=3,tr=Pr*jt,bc="http://localhost:9999",yc="supabase.auth.token",wc={"X-Client-Info":`gotrue-js/${Qi}`},Or="X-Supabase-Api-Version",Zi={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},vc=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,jc=600*1e3;class Zt extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function L(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class kc extends Zt{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function Nc(s){return L(s)&&s.name==="AuthApiError"}class et extends Zt{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class He extends Zt{constructor(t,r,a,i){super(t,a,i),this.name=r,this.status=a}}class _e extends He{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function _c(s){return L(s)&&s.name==="AuthSessionMissingError"}class xt extends He{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class hs extends He{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ms extends He{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Sc(s){return L(s)&&s.name==="AuthImplicitGrantRedirectError"}class Na extends He{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ec extends He{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Rr extends He{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function sr(s){return L(s)&&s.name==="AuthRetryableFetchError"}class _a extends He{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class Ir extends He{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ss="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Sa=` 	
\r=`.split(""),Tc=(()=>{const s=new Array(128);for(let t=0;t<s.length;t+=1)s[t]=-1;for(let t=0;t<Sa.length;t+=1)s[Sa[t].charCodeAt(0)]=-2;for(let t=0;t<Ss.length;t+=1)s[Ss[t].charCodeAt(0)]=t;return s})();function Ea(s,t,r){if(s!==null)for(t.queue=t.queue<<8|s,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Ss[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Ss[a]),t.queuedBits-=6}}function en(s,t,r){const a=Tc[s];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function Ta(s){const t=[],r=o=>{t.push(String.fromCodePoint(o))},a={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},n=o=>{Pc(o,a,r)};for(let o=0;o<s.length;o+=1)en(s.charCodeAt(o),i,n);return t.join("")}function Cc(s,t){if(s<=127){t(s);return}else if(s<=2047){t(192|s>>6),t(128|s&63);return}else if(s<=65535){t(224|s>>12),t(128|s>>6&63),t(128|s&63);return}else if(s<=1114111){t(240|s>>18),t(128|s>>12&63),t(128|s>>6&63),t(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function Ac(s,t){for(let r=0;r<s.length;r+=1){let a=s.charCodeAt(r);if(a>55295&&a<=56319){const i=(a-55296)*1024&65535;a=(s.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}Cc(a,t)}}function Pc(s,t,r){if(t.utf8seq===0){if(s<=127){r(s);return}for(let a=1;a<6;a+=1)if((s>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=s&31;else if(t.utf8seq===3)t.codepoint=s&15;else if(t.utf8seq===4)t.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|s&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Ct(s){const t=[],r={queue:0,queuedBits:0},a=i=>{t.push(i)};for(let i=0;i<s.length;i+=1)en(s.charCodeAt(i),r,a);return new Uint8Array(t)}function Oc(s){const t=[];return Ac(s,r=>t.push(r)),new Uint8Array(t)}function st(s){const t=[],r={queue:0,queuedBits:0},a=i=>{t.push(i)};return s.forEach(i=>Ea(i,r,a)),Ea(null,r,a),t.join("")}function Rc(s){return Math.round(Date.now()/1e3)+s}function Ic(){return Symbol("auth-callback")}const ue=()=>typeof window<"u"&&typeof document<"u",Ye={tested:!1,writable:!1},tn=()=>{if(!ue())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ye.tested)return Ye.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Ye.tested=!0,Ye.writable=!0}catch{Ye.tested=!0,Ye.writable=!1}return Ye.writable};function $c(s){const t={},r=new URL(s);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,n)=>{t[n]=i})}catch{}return r.searchParams.forEach((a,i)=>{t[i]=a}),t}const sn=s=>s?(...t)=>s(...t):(...t)=>fetch(...t),Lc=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",kt=async(s,t,r)=>{await s.setItem(t,JSON.stringify(r))},Xe=async(s,t)=>{const r=await s.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},de=async(s,t)=>{await s.removeItem(t)};class Us{constructor(){this.promise=new Us.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Us.promiseConstructor=Promise;function rr(s){const t=s.split(".");if(t.length!==3)throw new Ir("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!vc.test(t[a]))throw new Ir("JWT not in base64url format");return{header:JSON.parse(Ta(t[0])),payload:JSON.parse(Ta(t[1])),signature:Ct(t[2]),raw:{header:t[0],payload:t[1]}}}async function Uc(s){return await new Promise(t=>{setTimeout(()=>t(null),s)})}function Dc(s,t){return new Promise((a,i)=>{(async()=>{for(let n=0;n<1/0;n++)try{const o=await s(n);if(!t(n,null,o)){a(o);return}}catch(o){if(!t(n,o)){i(o);return}}})()})}function Mc(s){return("0"+s.toString(16)).substr(-2)}function Bc(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let i="";for(let n=0;n<56;n++)i+=r.charAt(Math.floor(Math.random()*a));return i}return crypto.getRandomValues(t),Array.from(t,Mc).join("")}async function Fc(s){const r=new TextEncoder().encode(s),a=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(a);return Array.from(i).map(n=>String.fromCharCode(n)).join("")}async function qc(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const r=await Fc(s);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ft(s,t,r=!1){const a=Bc();let i=a;r&&(i+="/PASSWORD_RECOVERY"),await kt(s,`${t}-code-verifier`,i);const n=await qc(a);return[n,a===n?"plain":"s256"]}const Hc=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Wc(s){const t=s.headers.get(Or);if(!t||!t.match(Hc))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function zc(s){if(!s)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(s<=t)throw new Error("JWT has expired")}function Vc(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Kc=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function gt(s){if(!Kc.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ar(){const s={};return new Proxy(s,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Gc(s,t){return new Proxy(s,{get:(r,a,i)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const n=a.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)"||n==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,i)}return!t.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,a,i)}})}function Ca(s){return JSON.parse(JSON.stringify(s))}const Qe=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Jc=[502,503,504];async function Aa(s){var t;if(!Lc(s))throw new Rr(Qe(s),0);if(Jc.includes(s.status))throw new Rr(Qe(s),s.status);let r;try{r=await s.json()}catch(n){throw new et(Qe(n),n)}let a;const i=Wc(s);if(i&&i.getTime()>=Zi["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new _a(Qe(r),s.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new _e}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((n,o)=>n&&typeof o=="string",!0))throw new _a(Qe(r),s.status,r.weak_password.reasons);throw new kc(Qe(r),s.status||500,a)}const Yc=(s,t,r,a)=>{const i={method:s,headers:t?.headers||{}};return s==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),i.body=JSON.stringify(a),Object.assign(Object.assign({},i),r))};async function U(s,t,r,a){var i;const n=Object.assign({},a?.headers);n[Or]||(n[Or]=Zi["2024-01-01"].name),a?.jwt&&(n.Authorization=`Bearer ${a.jwt}`);const o=(i=a?.query)!==null&&i!==void 0?i:{};a?.redirectTo&&(o.redirect_to=a.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Xc(s,t,r+l,{headers:n,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(c):{data:Object.assign({},c),error:null}}async function Xc(s,t,r,a,i,n){const o=Yc(t,a,i,n);let l;try{l=await s(r,Object.assign({},o))}catch(c){throw console.error(c),new Rr(Qe(c),0)}if(l.ok||await Aa(l),a?.noResolveJson)return l;try{return await l.json()}catch(c){await Aa(c)}}function Ae(s){var t;let r=null;ed(s)&&(r=Object.assign({},s),s.expires_at||(r.expires_at=Rc(s.expires_in)));const a=(t=s.user)!==null&&t!==void 0?t:s;return{data:{session:r,user:a},error:null}}function Pa(s){const t=Ae(s);return!t.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=s.weak_password),t}function Ke(s){var t;return{data:{user:(t=s.user)!==null&&t!==void 0?t:s},error:null}}function Qc(s){return{data:s,error:null}}function Zc(s){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:i,verification_type:n}=s,o=$s(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:a,redirect_to:i,verification_type:n},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Oa(s){return s}function ed(s){return s.access_token&&s.refresh_token&&s.expires_in}const ir=["global","local","others"];class td{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=sn(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=ir[0]){if(ir.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ir.join(", ")}`);try{return await U(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(L(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await U(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ke})}catch(a){if(L(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=$s(t,["options"]),i=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(i.new_email=a?.newEmail,delete i.newEmail),await U(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Zc,redirectTo:r?.redirectTo})}catch(r){if(L(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await U(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ke})}catch(r){if(L(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,i,n,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await U(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(n=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&n!==void 0?n:""},xform:Oa});if(u.error)throw u.error;const m=await u.json(),p=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(x=>{const g=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),f=JSON.parse(x.split(";")[1].split("=")[1]);d[`${f}Page`]=g}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(L(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){gt(t);try{return await U(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ke})}catch(r){if(L(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){gt(t);try{return await U(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ke})}catch(a){if(L(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){gt(t);try{return await U(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ke})}catch(a){if(L(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){gt(t.userId);try{const{data:r,error:a}=await U(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:a}}catch(r){if(L(r))return{data:null,error:r};throw r}}async _deleteFactor(t){gt(t.userId),gt(t.id);try{return{data:await U(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,a,i,n,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await U(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(n=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&n!==void 0?n:""},xform:Oa});if(u.error)throw u.error;const m=await u.json(),p=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(x=>{const g=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),f=JSON.parse(x.split(";")[1].split("=")[1]);d[`${f}Page`]=g}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(L(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await U(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(L(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await U(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(L(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await U(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(L(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(t){try{return await U(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await U(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(L(r))return{data:null,error:r};throw r}}}function Ra(s={}){return{getItem:t=>s[t]||null,setItem:(t,r)=>{s[t]=r},removeItem:t=>{delete s[t]}}}const pt={debug:!!(globalThis&&tn()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class rn extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class sd extends rn{}async function rd(s,t,r){pt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),pt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async i=>{if(i){pt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,i.name);try{return await r()}finally{pt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,i.name)}}else{if(t===0)throw pt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new sd(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(pt.debug)try{const n=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(n,null,"  "))}catch(n){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",n)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function ad(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function an(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function id(s){return parseInt(s,16)}function nd(s){const t=new TextEncoder().encode(s);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function od(s){var t;const{chainId:r,domain:a,expirationTime:i,issuedAt:n=new Date,nonce:o,notBefore:l,requestId:c,resources:d,scheme:u,uri:m,version:p}=s;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((t=s.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const h=an(s.address),x=u?`${u}://${a}`:a,g=s.statement?`${s.statement}
`:"",f=`${x} wants you to sign in with your Ethereum account:
${h}

${g}`;let y=`URI: ${m}
Version: ${p}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${n.toISOString()}`;if(i&&(y+=`
Expiration Time: ${i.toISOString()}`),l&&(y+=`
Not Before: ${l.toISOString()}`),c&&(y+=`
Request ID: ${c}`),d){let k=`
Resources:`;for(const w of d){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);k+=`
- ${w}`}y+=k}return`${f}
${y}`}class ae extends Error{constructor({message:t,code:r,cause:a,name:i}){var n;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(n=i??(a instanceof Error?a.name:void 0))!==null&&n!==void 0?n:"Unknown Error",this.code=r}}class Es extends ae{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function ld({error:s,options:t}){var r,a,i;const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ae({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((r=n.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new ae({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(t.mediation==="conditional"&&((a=n.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new ae({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((i=n.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new ae({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new ae({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new ae({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return n.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new ae({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new ae({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const o=window.location.hostname;if(nn(o)){if(n.rp.id!==o)return new ae({message:`The RP ID "${n.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new ae({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(n.user.id.byteLength<1||n.user.id.byteLength>64)return new ae({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new ae({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new ae({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function cd({error:s,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ae({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new ae({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const a=window.location.hostname;if(nn(a)){if(r.rpId!==a)return new ae({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new ae({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new ae({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new ae({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}class dd{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const ud=new dd;function hd(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:t,user:r,excludeCredentials:a}=s,i=$s(s,["challenge","user","excludeCredentials"]),n=Ct(t).buffer,o=Object.assign(Object.assign({},r),{id:Ct(r.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:n,user:o});if(a&&a.length>0){l.excludeCredentials=new Array(a.length);for(let c=0;c<a.length;c++){const d=a[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:Ct(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function md(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:t,allowCredentials:r}=s,a=$s(s,["challenge","allowCredentials"]),i=Ct(t).buffer,n=Object.assign(Object.assign({},a),{challenge:i});if(r&&r.length>0){n.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];n.allowCredentials[o]=Object.assign(Object.assign({},l),{id:Ct(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return n}function xd(s){var t;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const r=s;return{id:s.id,rawId:s.id,response:{attestationObject:st(new Uint8Array(s.response.attestationObject)),clientDataJSON:st(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function fd(s){var t;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const r=s,a=s.getClientExtensionResults(),i=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:st(new Uint8Array(i.authenticatorData)),clientDataJSON:st(new Uint8Array(i.clientDataJSON)),signature:st(new Uint8Array(i.signature)),userHandle:i.userHandle?st(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function nn(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function Ia(){var s,t;return!!(ue()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator?.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function gd(s){try{const t=await navigator.credentials.create(s);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Es("Browser returned unexpected credential type",t)}:{data:null,error:new Es("Empty credential response",t)}}catch(t){return{data:null,error:ld({error:t,options:s})}}}async function pd(s){try{const t=await navigator.credentials.get(s);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Es("Browser returned unexpected credential type",t)}:{data:null,error:new Es("Empty credential response",t)}}catch(t){return{data:null,error:cd({error:t,options:s})}}}const bd={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},yd={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ts(...s){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),a={};for(const i of s)if(i)for(const n in i){const o=i[n];if(o!==void 0)if(Array.isArray(o))a[n]=o;else if(r(o))a[n]=o;else if(t(o)){const l=a[n];t(l)?a[n]=Ts(l,o):a[n]=Ts(o)}else a[n]=o}return a}function wd(s,t){return Ts(bd,s,t||{})}function vd(s,t){return Ts(yd,s,t||{})}class jd{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:a,signal:i},n){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const c=i??ud.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${a}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=wd(o.webauthn.credential_options.publicKey,n?.create),{data:u,error:m}=await gd({publicKey:d,signal:c});return u?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:m}}case"request":{const d=vd(o.webauthn.credential_options.publicKey,n?.request),{data:u,error:m}=await pd(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:m}}}}catch(o){return L(o)?{data:null,error:o}:{data:null,error:new et("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},n){if(!r)return{data:null,error:new Zt("rpId is required for WebAuthn authentication")};try{if(!Ia())return{data:null,error:new et("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:a},signal:i},{request:n});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:a,credential_response:c.credential_response}})}catch(o){return L(o)?{data:null,error:o}:{data:null,error:new et("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},n){if(!r)return{data:null,error:new Zt("rpId is required for WebAuthn registration")};try{if(!Ia())return{data:null,error:new et("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(u=>{var m;return(m=u.data)===null||m===void 0?void 0:m.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===t&&p.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:i},{create:n});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:a,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(o){return L(o)?{data:null,error:o}:{data:null,error:new et("Unexpected error in register",o)}}}}ad();const kd={url:bc,storageKey:yc,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:wc,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function $a(s,t,r){return await r()}const bt={};class es{get jwks(){var t,r;return(r=(t=bt[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){bt[this.storageKey]=Object.assign(Object.assign({},bt[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=bt[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){bt[this.storageKey]=Object.assign(Object.assign({},bt[this.storageKey]),{cachedAt:t})}constructor(t){var r,a,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const n=Object.assign(Object.assign({},kd),t);if(this.storageKey=n.storageKey,this.instanceID=(r=es.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,es.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.instanceID>0&&ue()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=n.persistSession,this.autoRefreshToken=n.autoRefreshToken,this.admin=new td({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=sn(n.fetch),this.lock=n.lock||$a,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,this.throwOnError=n.throwOnError,n.lock?this.lock=n.lock:this.persistSession&&ue()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=rd:this.lock=$a,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new jd(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:tn()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ra(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Ra(this.memoryStorage)),ue()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Qi}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},a="none";if(ue()&&(r=$c(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),ue()&&this.detectSessionInUrl&&a!=="none"){const{data:i,error:n}=await this._getSessionFromURL(r,a);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),Sc(n)){const c=(t=n.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:n}}return await this._removeSession(),{error:n}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return L(r)?this._returnResult({error:r}):this._returnResult({error:new et("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,i;try{const n=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(i=t?.options)===null||i===void 0?void 0:i.captchaToken}},xform:Ae}),{data:o,error:l}=n;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(n){if(L(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signUp(t){var r,a,i;try{let n;if("email"in t){const{email:u,password:m,options:p}=t;let h=null,x=null;this.flowType==="pkce"&&([h,x]=await ft(this.storage,this.storageKey)),n=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p?.emailRedirectTo,body:{email:u,password:m,data:(r=p?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:h,code_challenge_method:x},xform:Ae})}else if("phone"in t){const{phone:u,password:m,options:p}=t;n=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:m,data:(a=p?.data)!==null&&a!==void 0?a:{},channel:(i=p?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:Ae})}else throw new hs("You must provide either an email or phone number and a password");const{data:o,error:l}=n;if(l||!o)return await de(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(n){if(await de(this.storage,`${this.storageKey}-code-verifier`),L(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithPassword(t){try{let r;if("email"in t){const{email:n,password:o,options:l}=t;r=await U(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:n,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Pa})}else if("phone"in t){const{phone:n,password:o,options:l}=t;r=await U(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:n,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Pa})}else throw new hs("You must provide either an email or phone number and a password");const{data:a,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!a||!a.session||!a.user){const n=new xt;return this._returnResult({data:{user:null,session:null},error:n})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:i})}catch(r){if(L(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,a,i,n;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(n=t.options)===null||n===void 0?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,a,i,n,o,l,c,d,u,m,p;let h,x;if("message"in t)h=t.message,x=t.signature;else{const{chain:g,wallet:f,statement:y,options:k}=t;let w;if(ue())if(typeof f=="object")w=f;else{const T=window;if("ethereum"in T&&typeof T.ethereum=="object"&&"request"in T.ethereum&&typeof T.ethereum.request=="function")w=T.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof f!="object"||!k?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=f}const v=new URL((r=k?.url)!==null&&r!==void 0?r:window.location.href),S=await w.request({method:"eth_requestAccounts"}).then(T=>T).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const _=an(S[0]);let E=(a=k?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!E){const T=await w.request({method:"eth_chainId"});E=id(T)}const $={domain:v.host,address:_,statement:y,uri:v.href,version:"1",chainId:E,nonce:(i=k?.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(o=(n=k?.signInWithEthereum)===null||n===void 0?void 0:n.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=k?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=k?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=k?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=k?.signInWithEthereum)===null||u===void 0?void 0:u.resources};h=od($),x=await w.request({method:"personal_sign",params:[nd(h),_]})}try{const{data:g,error:f}=await U(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:x},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Ae});if(f)throw f;if(!g||!g.session||!g.user){const y=new xt;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:f})}catch(g){if(L(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(t){var r,a,i,n,o,l,c,d,u,m,p,h;let x,g;if("message"in t)x=t.message,g=t.signature;else{const{chain:f,wallet:y,statement:k,options:w}=t;let v;if(ue())if(typeof y=="object")v=y;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))v=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=y}const S=new URL((r=w?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in v&&v.signIn){const _=await v.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w?.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),k?{statement:k}:null));let E;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")E=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)E=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)x=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),g=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in v)||typeof v.signMessage!="function"||!("publicKey"in v)||typeof v!="object"||!v.publicKey||!("toBase58"in v.publicKey)||typeof v.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${S.host} wants you to sign in with your Solana account:`,v.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(i=(a=w?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((n=w?.signInWithSolana)===null||n===void 0)&&n.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((d=w?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((m=(u=w?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||m===void 0)&&m.length?["Resources",...w.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const _=await v.signMessage(new TextEncoder().encode(x),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=_}}try{const{data:f,error:y}=await U(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:st(g)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Ae});if(y)throw y;if(!f||!f.session||!f.user){const k=new xt;return this._returnResult({data:{user:null,session:null},error:k})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:Object.assign({},f),error:y})}catch(f){if(L(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async _exchangeCodeForSession(t){const r=await Xe(this.storage,`${this.storageKey}-code-verifier`),[a,i]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new Ec;const{data:n,error:o}=await U(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:Ae});if(await de(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!n||!n.session||!n.user){const l=new xt;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign(Object.assign({},n),{redirectType:i??null}),error:o})}catch(n){if(await de(this.storage,`${this.storageKey}-code-verifier`),L(n))return this._returnResult({data:{user:null,session:null,redirectType:null},error:n});throw n}}async signInWithIdToken(t){try{const{options:r,provider:a,token:i,access_token:n,nonce:o}=t,l=await U(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:i,access_token:n,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Ae}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const u=new xt;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(r){if(L(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,a,i,n,o;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await ft(this.storage,this.storageKey));const{error:m}=await U(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(a=c?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await U(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c?.data)!==null&&i!==void 0?i:{},create_user:(n=c?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(o=c?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:u})}throw new hs("You must provide either an email or phone number.")}catch(l){if(await de(this.storage,`${this.storageKey}-code-verifier`),L(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,a;try{let i,n;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,n=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:o,error:l}=await U(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:n}}),redirectTo:i,xform:Ae});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(L(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,a,i,n,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await ft(this.storage,this.storageKey));const d=await U(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((i=t?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:Qc});return!((n=d.data)===null||n===void 0)&&n.url&&ue()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(l){if(await de(this.storage,`${this.storageKey}-code-verifier`),L(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new _e;const{error:i}=await U(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(L(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:i,options:n}=t,{error:o}=await U(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:i,gotrue_meta_security:{captcha_token:n?.captchaToken}},redirectTo:n?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:a,type:i,options:n}=t,{data:o,error:l}=await U(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:i,gotrue_meta_security:{captcha_token:n?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:l})}throw new hs("You must provide either an email or phone number and a type")}catch(r){if(L(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Xe(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<tr:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const o=await Xe(this.userStorage,this.storageKey+"-user");o?.user?t.user=o.user:t.user=ar()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=Gc(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:n}=await this._callRefreshToken(t.refresh_token);return n?this._returnResult({data:{session:null},error:n}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await U(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ke}):await this._useSession(async r=>{var a,i,n;const{data:o,error:l}=r;if(l)throw l;return!(!((a=o.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new _e}:await U(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(n=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&n!==void 0?n:void 0,xform:Ke})})}catch(r){if(L(r))return _c(r)&&(await this._removeSession(),await de(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:i,error:n}=a;if(n)throw n;if(!i.session)throw new _e;const o=i.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await ft(this.storage,this.storageKey));const{data:d,error:u}=await U(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Ke});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(a){if(await de(this.storage,`${this.storageKey}-code-verifier`),L(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new _e;const r=Date.now()/1e3;let a=r,i=!0,n=null;const{payload:o}=rr(t.access_token);if(o.exp&&(a=o.exp,i=a<=r),i){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};n=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;n={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return this._returnResult({data:{user:n.user,session:n},error:null})}catch(r){if(L(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(a=o.session)!==null&&a!==void 0?a:void 0}if(!t?.refresh_token)throw new _e;const{data:i,error:n}=await this._callRefreshToken(t.refresh_token);return n?this._returnResult({data:{user:null,session:null},error:n}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(L(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!ue())throw new ms("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ms(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Na("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ms("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Na("No code detected.");const{data:k,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const v=new URL(window.location.href);return v.searchParams.delete("code"),window.history.replaceState(window.history.state,"",v.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:i,access_token:n,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=t;if(!n||!l||!o||!d)throw new ms("No session defined in URL");const u=Math.round(Date.now()/1e3),m=parseInt(l);let p=u+m;c&&(p=parseInt(c));const h=p-u;h*1e3<=jt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${m}s`);const x=p-m;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,p,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,p,u);const{data:g,error:f}=await this._getUser(n);if(f)throw f;const y={provider_token:a,provider_refresh_token:i,access_token:n,expires_in:m,expires_at:p,refresh_token:o,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:t.type},error:null})}catch(a){if(L(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Xe(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:i,error:n}=r;if(n)return this._returnResult({error:n});const o=(a=i.session)===null||a===void 0?void 0:a.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(Nc(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await de(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Ic(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,i;try{const{data:{session:n},error:o}=r;if(o)throw o;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",t,"session",n)}catch(n){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",n),console.error(n)}})}async resetPasswordForEmail(t,r={}){let a=null,i=null;this.flowType==="pkce"&&([a,i]=await ft(this.storage,this.storageKey,!0));try{return await U(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(n){if(await de(this.storage,`${this.storageKey}-code-verifier`),L(n))return this._returnResult({data:null,error:n});throw n}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(L(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:a,error:i}=await this._useSession(async n=>{var o,l,c,d,u;const{data:m,error:p}=n;if(p)throw p;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await U(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return ue()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:t.provider,url:a?.url},error:null})}catch(a){if(L(a))return this._returnResult({data:{provider:t.provider,url:null},error:a});throw a}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var a;try{const{error:i,data:{session:n}}=r;if(i)throw i;const{options:o,provider:l,token:c,access_token:d,nonce:u}=t,m=await U(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=n?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Ae}),{data:p,error:h}=m;return h?this._returnResult({data:{user:null,session:null},error:h}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new xt}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:h}))}catch(i){if(await de(this.storage,`${this.storageKey}-code-verifier`),L(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,i;const{data:n,error:o}=r;if(o)throw o;return await U(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(a=n.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(L(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await Dc(async i=>(i>0&&await Uc(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await U(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ae})),(i,n)=>{const o=200*Math.pow(2,i);return n&&sr(n)&&Date.now()+o-a<jt})}catch(a){if(this._debug(r,"error",a),L(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),ue()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const i=await Xe(this.storage,this.storageKey);if(i&&this.userStorage){let o=await Xe(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await kt(this.userStorage,this.storageKey+"-user",o)),i.user=(t=o?.user)!==null&&t!==void 0?t:ar()}else if(i&&!i.user&&!i.user){const o=await Xe(this.storage,this.storageKey+"-user");o&&o?.user?(i.user=o.user,await de(this.storage,this.storageKey+"-user"),await kt(this.storage,this.storageKey,i)):i.user=ar()}if(this._debug(a,"session from storage",i),!this._isValidSession(i)){this._debug(a,"session is not valid"),i!==null&&await this._removeSession();return}const n=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<tr;if(this._debug(a,`session has${n?"":" not"} expired with margin of ${tr}s`),n){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),sr(o)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&o?.user?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(a,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(a,"error",i),console.error(i);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new _e;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Us;const{data:n,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!n.session)throw new _e;await this._saveSession(n.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",n.session);const l={data:n.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(n){if(this._debug(i,"error",n),L(n)){const o={data:null,error:n};return sr(n)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(n),n}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,a=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const n=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){n.push(c)}});if(await Promise.all(o),n.length>0){for(let l=0;l<n.length;l+=1)console.error(n[l]);throw n[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await de(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await kt(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const n=Ca(i);await kt(this.storage,this.storageKey,n)}else{const i=Ca(r);await kt(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await de(this.storage,this.storageKey),await de(this.storage,this.storageKey+"-code-verifier"),await de(this.storage,this.storageKey+"-user"),this.userStorage&&await de(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ue()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),jt);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((a.expires_at*1e3-t)/jt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${jt}ms, refresh threshold is ${Pr} ticks`),i<=Pr&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof rn)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ue()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const i=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&i.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[n,o]=await ft(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(n)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(a?.queryParams){const n=new URLSearchParams(a.queryParams);i.push(n.toString())}return a?.skipBrowserRedirect&&i.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:i,error:n}=r;return n?this._returnResult({data:null,error:n}):await U(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=i?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(L(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,i;const{data:n,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:d}=await U(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token});return d?this._returnResult({data:null,error:d}):(t.factorType==="totp"&&c.type==="totp"&&(!((i=c?.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(L(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:i,error:n}=r;if(n)return this._returnResult({data:null,error:n});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?xd(t.webauthn.credential_response):fd(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await U(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(a=i?.session)===null||a===void 0?void 0:a.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(L(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:i,error:n}=r;if(n)return this._returnResult({data:null,error:n});const o=await U(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=i?.session)===null||a===void 0?void 0:a.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:hd(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:md(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(L(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const i={all:[],phone:[],totp:[],webauthn:[]};for(const n of(t=r?.factors)!==null&&t!==void 0?t:[])i.all.push(n),n.status==="verified"&&i[n.factor_type].push(n);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:a},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:n}=rr(a.access_token);let o=null;n.aal&&(o=n.aal);let l=o;((r=(t=a.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const d=n.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:a},error:i}=r;return i?this._returnResult({data:null,error:i}):a?await U(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:a.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new _e})})}catch(r){if(L(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:i},error:n}=a;if(n)return this._returnResult({data:null,error:n});if(!i)return this._returnResult({data:null,error:new _e});const o=await U(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&ue()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(a){if(L(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:i},error:n}=a;if(n)return this._returnResult({data:null,error:n});if(!i)return this._returnResult({data:null,error:new _e});const o=await U(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&ue()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(a){if(L(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await U(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new _e})})}catch(t){if(L(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:a},error:i}=r;return i?this._returnResult({data:null,error:i}):a?(await U(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new _e})})}catch(r){if(L(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(l=>l.kid===t);if(a)return a;const i=Date.now();if(a=this.jwks.keys.find(l=>l.kid===t),a&&this.jwks_cached_at+jc>i)return a;const{data:n,error:o}=await U(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!n.keys||n.keys.length===0||(this.jwks=n,this.jwks_cached_at=i,a=n.keys.find(l=>l.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:h,error:x}=await this.getSession();if(x||!h.session)return this._returnResult({data:null,error:x});a=h.session.access_token}const{header:i,payload:n,signature:o,raw:{header:l,payload:c}}=rr(a);r?.allowExpired||zc(n.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:h}=await this.getUser(a);if(h)throw h;return{data:{claims:n,header:i,signature:o},error:null}}const u=Vc(i.alg),m=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,m,o,Oc(`${l}.${c}`)))throw new Ir("Invalid JWT signature");return{data:{claims:n,header:i,signature:o},error:null}}catch(a){if(L(a))return this._returnResult({data:null,error:a});throw a}}}es.nextInstanceID={};const Nd=es,_d="2.89.0";let Ft="";typeof Deno<"u"?Ft="deno":typeof document<"u"?Ft="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ft="react-native":Ft="node";const Sd={"X-Client-Info":`supabase-js-${Ft}/${_d}`},Ed={headers:Sd},Td={schema:"public"},Cd={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ad={};function ts(s){"@babel/helpers - typeof";return ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ts(s)}function Pd(s,t){if(ts(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var a=r.call(s,t);if(ts(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function Od(s){var t=Pd(s,"string");return ts(t)=="symbol"?t:t+""}function Rd(s,t,r){return(t=Od(t))in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function La(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),r.push.apply(r,a)}return r}function se(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?La(Object(r),!0).forEach(function(a){Rd(s,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):La(Object(r)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(r,a))})}return s}const Id=s=>s?(...t)=>s(...t):(...t)=>fetch(...t),$d=()=>Headers,Ld=(s,t,r)=>{const a=Id(r),i=$d();return async(n,o)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:s;let d=new i(o?.headers);return d.has("apikey")||d.set("apikey",s),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),a(n,se(se({},o),{},{headers:d}))}};function Ud(s){return s.endsWith("/")?s:s+"/"}function Dd(s,t){var r,a;const{db:i,auth:n,realtime:o,global:l}=s,{db:c,auth:d,realtime:u,global:m}=t,p={db:se(se({},c),i),auth:se(se({},d),n),realtime:se(se({},u),o),storage:{},global:se(se(se({},m),l),{},{headers:se(se({},(r=m?.headers)!==null&&r!==void 0?r:{}),(a=l?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return s.accessToken?p.accessToken=s.accessToken:delete p.accessToken,p}function Md(s){const t=s?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ud(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Bd=class extends Nd{constructor(s){super(s)}},Fd=class{constructor(s,t,r){var a,i;this.supabaseUrl=s,this.supabaseKey=t;const n=Md(s);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",n),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",n),this.storageUrl=new URL("storage/v1",n),this.functionsUrl=new URL("functions/v1",n);const o=`sb-${n.hostname.split(".")[0]}-auth-token`,l={db:Td,realtime:Ad,auth:se(se({},Cd),{},{storageKey:o}),global:Ed},c=Dd(r??{},l);if(this.storageKey=(a=c.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=c.global.headers)!==null&&i!==void 0?i:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(u,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=c.auth)!==null&&d!==void 0?d:{},this.headers,c.global.fetch)}this.fetch=Ld(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(se({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new wl(new URL("rest/v1",n).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new pc(this.storageUrl.href,this.headers,this.fetch,r?.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new fl(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(s){return this.rest.from(s)}schema(s){return this.rest.schema(s)}rpc(s,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(s,t,r)}channel(s,t={config:{}}){return this.realtime.channel(s,t)}getChannels(){return this.realtime.getChannels()}removeChannel(s){return this.realtime.removeChannel(s)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var s=this,t,r;if(s.accessToken)return await s.accessToken();const{data:a}=await s.auth.getSession();return(t=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:s.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:s,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:i,storageKey:n,flowType:o,lock:l,debug:c,throwOnError:d},u,m){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Bd({url:this.authUrl.href,headers:se(se({},p),u),storageKey:n,autoRefreshToken:s,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:i,flowType:o,lock:l,debug:c,throwOnError:d,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(s){return new Ul(this.realtimeUrl.href,se(se({},s),{},{params:se(se({},{apikey:this.supabaseKey}),s?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,t)=>{this._handleTokenChanged(s,"CLIENT",t?.access_token)})}_handleTokenChanged(s,t,r){(s==="TOKEN_REFRESHED"||s==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):s==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Ua=(s,t,r)=>new Fd(s,t,r);function qd(){if(typeof window<"u"||typeof process>"u")return!1;const s=process.version;if(s==null)return!1;const t=s.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}qd()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Da="https://zgiwqbpalykrztvvekcg.supabase.co",Ma="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpnaXdxYnBhbHlrcnp0dnZla2NnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyODkzMjYsImV4cCI6MjA3ODg2NTMyNn0.5IZUMcthWc9QTUJihd8-0785PLCk3v9zfyjxAFun7Cw";let F;typeof window<"u"?(window.__supabase||(window.__supabase=Ua(Da,Ma,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"sb-nexveris-auth"}}),console.log(" Supabase client initialized")),F=window.__supabase):F=Ua(Da,Ma,{auth:{persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1}});const ne=Po((s,t)=>({user:null,session:null,loading:!1,error:null,isAuthenticated:!1,setUser:r=>s({user:r,isAuthenticated:!!r}),setSession:r=>s({session:r}),setLoading:r=>s({loading:r}),setError:r=>s({error:r}),clearError:()=>s({error:null}),signUp:async(r,a)=>{try{s({loading:!0,error:null}),console.log(" Supabase signUp start:",r);const{data:i,error:n}=await F.auth.signUp({email:r,password:a});if(n)throw n;console.log(" Supabase signUp success:",i.user?.id)}catch(i){throw console.error(" signUp error:",i),s({error:i}),i}finally{s({loading:!1})}},signIn:async(r,a)=>{try{s({loading:!0,error:null}),console.log(" Supabase signIn start:",r);const{data:i,error:n}=await F.auth.signInWithPassword({email:r,password:a});if(n)throw n;console.log(" Supabase signIn success:",i.user?.id)}catch(i){throw console.error(" signIn error:",i),s({error:i}),i}finally{s({loading:!1})}},signInWithOAuth:async r=>{try{s({loading:!0,error:null}),console.log(" OAuth signIn start:",r);const{error:a}=await F.auth.signInWithOAuth({provider:r,options:{redirectTo:`${window.location.origin}/auth/callback`}});if(a)throw a;console.log(" OAuth redirect initiated:",r)}catch(a){throw console.error(" OAuth error:",a),s({error:a}),a}finally{s({loading:!1})}},signOut:async()=>{try{s({loading:!0,error:null}),console.log(" Signing out...");const{error:r}=await F.auth.signOut();if(r)throw r;s({user:null,session:null,isAuthenticated:!1}),console.log(" Signed out successfully")}catch(r){console.error(" Sign out error:",r),s({error:r})}finally{s({loading:!1})}}})),Hd=["free","starter","pro","business"],Ba=s=>Hd.includes(s);function Wd({children:s}){const t=ne(l=>l.setUser),r=ne(l=>l.setSession),a=ne(l=>l.clearError),[i,n]=b.useState(!1),o=b.useCallback(async l=>{if(!l?.user){console.log(" No session user - clearing auth state"),r(null),t(null),n(!0);return}const c=l.user;console.log(" Session user detected:",c.email),r(l);try{const d=F.from("profiles").select("plan, billing_cycle, scans_used_this_month, scans_limit").eq("id",c.id).maybeSingle(),u=new Promise((h,x)=>setTimeout(()=>x(new Error("Database fetch timeout")),5e3)),{data:m,error:p}=await Promise.race([d,u]);if(p)throw console.warn(" Database error fetching user profile:",p.message),p;t({id:c.id,email:c.email||"",plan:Ba(m?.plan)?m.plan:"free",billingCycle:m?.billing_cycle||null,scansUsed:m?.scans_used_this_month??0,scansLimit:m?.scans_limit??10})}catch(d){console.warn(" Failed to fetch user profile, using fallback:",d.message),t({id:c.id,email:c.email||"",plan:"free",billingCycle:null,scansUsed:0,scansLimit:10}),(d.message.includes("timeout")||d.message.includes("network"))&&setTimeout(async()=>{try{const{data:u}=await F.from("profiles").select("plan, billing_cycle, scans_used_this_month, scans_limit").eq("id",c.id).maybeSingle();u&&(t({id:c.id,email:c.email||"",plan:Ba(u.plan)?u.plan:"free",billingCycle:u.billing_cycle||null,scansUsed:u.scans_used_this_month??0,scansLimit:u.scans_limit??10}),console.log(" User profile loaded on retry"))}catch{console.warn(" Retry also failed, staying on fallback")}},2e3)}finally{n(!0)}},[t,r]);return b.useEffect(()=>{let l=!0;(async()=>{if(l){console.log(" AuthProvider initializing..."),a();try{const{data:u,error:m}=await F.auth.getSession();if(m){console.error(" Failed to get session:",m.message),n(!0);return}if(!l)return;await o(u.session)}catch(u){console.error(" Auth initialization error:",u.message),n(!0)}}})();const{data:{subscription:d}}=F.auth.onAuthStateChange(async(u,m)=>{if(l){switch(console.log(" Auth event:",u),a(),u){case"SIGNED_IN":console.log(" User signed in");break;case"SIGNED_OUT":console.log(" User signed out");break;case"TOKEN_REFRESHED":break;case"USER_UPDATED":console.log(" User updated");break}await o(m)}});return()=>{l=!1,d.unsubscribe(),console.log(" AuthProvider unmounted")}},[o,a]),e.jsx(e.Fragment,{children:s})}const on=b.createContext(void 0),zd={free:["summary","credibility_basic","pestle_lite","hidden_motive_lite"],starter:["summary","credibility_full","pestle_full","hidden_motive_lite","hidden_motive_full"],pro:["*"],business:["*"]},Vd={summary:"free",credibility_basic:"free",pestle_lite:"free",hidden_motive_lite:"free",credibility_full:"starter",pestle_full:"starter",hidden_motive_full:"starter",stakeholder_impact:"pro",market_impact:"pro",predictive_modeling:"pro",pdf_export:"business",csv_export:"business"},Kd={hidden_motive_full:"Upgrade to view full narrative motives, incentives, and framing mechanics.",stakeholder_impact:"Upgrade to analyze power dynamics and stakeholder influence.",market_impact:"Upgrade to see market impact, beneficiaries, and downside risks.",predictive_modeling:"Upgrade to access future scenarios, signal quality, and chain reactions.",pdf_export:"Upgrade to Business to export reports and retain extended history.",csv_export:"Upgrade to Business to export structured data and analytics."},Ut={free:5,starter:40,pro:200,business:800};function Gd({children:s}){const[t,r]=b.useState(!0),[a,i]=b.useState({plan:"free",billingCycle:null,analysesUsed:0,analysesLimit:Ut.free,usageMonth:null}),n=m=>{const p=(m||"").trim().toLowerCase();return p==="starter"||p==="pro"||p==="business"||p==="free"?p:p==="premium"?"pro":"free"},o=async()=>{r(!0);try{const{data:{user:m},error:p}=await F.auth.getUser();if(p&&console.warn("[SUB] getUser error:",p),!m){i({plan:"guest",billingCycle:null,analysesUsed:0,analysesLimit:Ut.free,usageMonth:null});return}const{data:h,error:x}=await F.from("profiles").select("plan, billing_cycle, analyses_used, analyses_limit, usage_month").eq("id",m.id).single();if(x||!h){console.error("[SUB] profiles select failed:",x),i({plan:"free",billingCycle:null,analysesUsed:0,analysesLimit:Ut.free,usageMonth:null});return}const g=n(h.plan),f=h.billing_cycle==="monthly"||h.billing_cycle==="yearly"?h.billing_cycle:null;i({plan:g,billingCycle:f,analysesUsed:Number(h.analyses_used||0),analysesLimit:typeof h.analyses_limit=="number"?h.analyses_limit:Ut[g==="guest"?"free":g],usageMonth:h.usage_month||null}),console.log("[SUB] refreshed:",{userId:m.id,plan:g,billingCycle:f,analysesUsed:Number(h.analyses_used||0),analysesLimit:typeof h.analyses_limit=="number"?h.analyses_limit:Ut[g==="guest"?"free":g],usageMonth:h.usage_month||null})}finally{r(!1)}};b.useEffect(()=>{o();const{data:m}=F.auth.onAuthStateChange(()=>{o()});return()=>{m?.subscription?.unsubscribe()}},[]);const l=m=>{const p=a.plan==="guest"?"free":a.plan;if(p==="pro"||p==="business")return!0;const h=zd[p];return h?.[0]==="*"?!0:h.includes(m)},c=m=>Kd[m]||"This feature requires an upgrade.",d=m=>{const p=a.plan==="guest"?"free":a.plan,h=Vd[m]||"pro";return p==="free"&&h==="starter"?"Upgrade to Starter":(p==="free"||p==="starter")&&h==="pro"?"Upgrade to Pro":p!=="business"&&h==="business"?"Upgrade to Business":"View Plans"},u=b.useMemo(()=>({loading:t,plan:a.plan,billingCycle:a.billingCycle,analysesUsed:a.analysesUsed,analysesLimit:a.analysesLimit,usageMonth:a.usageMonth,canAccess:l,getUpgradeMessage:c,getUpgradeCTA:d,refreshSubscription:o}),[t,a]);return e.jsx(on.Provider,{value:u,children:s})}function ct(){const s=b.useContext(on);if(!s)throw new Error("useSubscription must be used inside SubscriptionProvider");return s}function yt({children:s}){const t=ne(a=>a.user);return ne(a=>a.loading)?e.jsx("div",{className:"flex h-[60vh] items-center justify-center text-slate-500",children:"Loading"}):t?s:e.jsx(Wr,{to:"/login",replace:!0})}function Fa({children:s}){const t=ne(a=>a.user);return ne(a=>a.loading)?e.jsx("div",{className:"flex h-[60vh] items-center justify-center text-slate-500",children:"Checking session"}):t?e.jsx(Wr,{to:"/",replace:!0}):s}const Nt="NexVeris AI",Jd="https://zgiwqbpalykrztvvekcg.supabase.co/storage/v1/object/public/Nex/NexV%20Logo.png",Yd="/brand/nexveris-gold.png";function Xd({className:s="",showText:t=!0,stacked:r=!1,size:a=64,tagline:i=!1,imageSrc:n}){const[o,l]=b.useState(!1),[c,d]=b.useState(!1),u=n||Jd;return e.jsxs("div",{className:`flex items-center ${r?"flex-col gap-2":"gap-3"} ${s}`,"aria-label":Nt,children:[o?c?e.jsx("div",{style:{width:a,height:a},className:"shrink-0 flex items-center justify-center text-slate-900 font-extrabold bg-slate-200 rounded",children:Nt[0]}):e.jsx("img",{src:Yd,alt:`${Nt} fallback logo`,width:a,height:a,className:"shrink-0 object-contain",onError:()=>d(!0)}):e.jsx("img",{src:u,alt:`${Nt} logo`,width:a,height:a,className:"shrink-0 object-contain",onError:()=>l(!0)}),t&&e.jsxs("div",{className:`leading-tight ${r?"text-center":""}`,children:[e.jsx("div",{className:"text-2xl font-extrabold tracking-tight text-slate-900",children:Nt}),i&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-px w-6 bg-slate-300"}),e.jsx("span",{className:"text-[10px] font-semibold tracking-[0.25em] text-slate-500 uppercase",children:"Intelligence"}),e.jsx("span",{className:"h-px w-6 bg-slate-300"})]})]})]})}function Qd(){const[s,t]=b.useState(()=>{if(typeof document>"u")return!1;const r=localStorage.getItem("theme");return r?r==="dark":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches});return b.useEffect(()=>{const r=document.documentElement;s?(r.classList.add("dark"),localStorage.setItem("theme","dark")):(r.classList.remove("dark"),localStorage.setItem("theme","light"))},[s]),e.jsxs("button",{type:"button","aria-label":s?"Switch to light mode":"Switch to dark mode",onClick:()=>t(r=>!r),className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-md transition text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-800",children:[s?e.jsx(Dn,{className:"w-4 h-4 mr-2"}):e.jsx(Mn,{className:"w-4 h-4 mr-2"}),s?"Light":"Dark"]})}function Zd(){const{plan:s,loading:t}=ct(),r=De(),a=zr(),i=ne(x=>x.user),n=!!i,[o,l]=b.useState(!1),[c,d]=b.useState(!1),u=x=>a.pathname===x,m=x=>{a.pathname!=="/"?r("/",{state:{scrollTo:x}}):document.getElementById(x)?.scrollIntoView({behavior:"smooth",block:"start"}),d(!1)},p=async()=>{try{await F.auth.signOut()}catch{}await ne.getState().signOut(),r("/login")},h=a.pathname.split("/").filter(Boolean).map((x,g)=>e.jsx("span",{className:"text-sm text-gray-500",children:x},g));return e.jsx("header",{className:"bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 shadow-sm sticky top-0 z-50 h-14",style:{"--header-height":"3.5rem"},children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"flex items-center h-14 justify-between",children:[e.jsxs("div",{className:"cursor-pointer flex items-center gap-2",onClick:()=>r("/"),"aria-label":Nt,children:[e.jsx(Xd,{size:48,showText:!1}),e.jsxs("div",{className:"text-lg font-extrabold tracking-tight",children:[e.jsx("span",{className:"text-slate-900 dark:text-white",children:"NexVeris"}),e.jsx("span",{className:"text-blue-600",children:".ai"})]})]}),e.jsxs("nav",{className:"hidden md:flex items-center gap-8 justify-center flex-1",role:"navigation","aria-label":"Main navigation",children:[" ",e.jsx(Me,{active:u("/"),label:"Home",icon:e.jsx(Bn,{className:"w-4 h-4 mr-2"}),onClick:()=>r("/")}),e.jsx(Me,{active:u("/analyze")||u("/news-analysis"),label:"Analyse",icon:e.jsx(Os,{className:"w-4 h-4 mr-2"}),onClick:()=>r("/analyze")}),e.jsx(Me,{active:u("/history"),label:"History",icon:e.jsx(gi,{className:"w-4 h-4 mr-2"}),onClick:()=>r("/history")}),e.jsx(Me,{active:u("/pricing"),label:"Pricing",icon:e.jsx(fr,{className:"w-4 h-4 mr-2"}),onClick:()=>r("/pricing")}),e.jsxs("div",{className:"relative",onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:[e.jsxs("button",{className:"inline-flex items-center px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-slate-800 rounded-md transition","aria-haspopup":"true","aria-expanded":c,children:[e.jsx(Fn,{className:"w-4 h-4 mr-2"}),"Learn",e.jsx(Rs,{className:"w-4 h-4 ml-1"})]}),c&&e.jsxs("div",{className:"absolute top-full left-0 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-md shadow-lg py-2",style:{transitionDelay:"150ms"},children:[e.jsx(Me,{label:"How it Works",onClick:()=>m("explanation")}),e.jsx(Me,{label:"Features",onClick:()=>m("features")}),e.jsx(Me,{label:"FAQ",onClick:()=>m("faq")})]})]}),e.jsx(Me,{active:u("/account"),label:"Account",icon:e.jsx(Is,{className:"w-4 h-4 mr-2"}),onClick:()=>r("/account")})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[" ",e.jsx(Qd,{}),n?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"hidden sm:block text-sm text-gray-700 dark:text-gray-300 whitespace-nowrap",children:[" ",i?.email]}),!t&&e.jsx("span",{className:"px-2 py-1 text-xs rounded bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-300",children:s.toUpperCase()}),e.jsxs("button",{onClick:p,className:`inline-flex items-center px-3 py-2 text-sm font-medium 
                  text-gray-700 dark:text-gray-300 
                  hover:bg-gray-100 dark:hover:bg-slate-800 
                  rounded-md transition`,"aria-label":"Logout",children:[e.jsx(pi,{className:"w-4 h-4 mr-1"}),"Logout"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{active:u("/login"),label:"Login",icon:e.jsx(qn,{className:"w-4 h-4 mr-1"}),onClick:()=>r("/login")}),e.jsxs("button",{onClick:()=>r("/signup"),className:`inline-flex items-center px-3 py-2 text-sm font-medium 
                  rounded-md bg-blue-600 text-white hover:bg-blue-700 
                  dark:bg-blue-500 dark:hover:bg-blue-600`,"aria-label":"Sign Up",children:[e.jsx(Hn,{className:"w-4 h-4 mr-1"}),"Sign Up"]})]})]}),e.jsx("div",{className:"md:hidden",children:e.jsx("button",{className:`inline-flex items-center p-2 rounded-md 
              text-gray-700 dark:text-gray-200 
              hover:bg-gray-100 dark:hover:bg-slate-800`,"aria-label":"Toggle menu",onClick:()=>l(x=>!x),children:o?e.jsx(St,{className:"w-6 h-6"}):e.jsx(Wn,{className:"w-6 h-6"})})})]}),e.jsxs("div",{className:`md:hidden ${o?"block":"hidden"} border-t border-slate-200 dark:border-slate-800 mt-2`,children:[e.jsx("div",{className:"px-2 pt-2 pb-3 space-y-1",children:[{path:"/",label:"Home"},{path:"/analyze",label:"Analyse"},{path:"/history",label:"History"},{path:"/pricing",label:"Pricing"},{path:"/how-it-works",label:"How it Works"},{path:"/features",label:"Features"},{path:"/faq",label:"FAQ"},{path:"/account",label:"Account"}].map(x=>e.jsx("button",{onClick:()=>{r(x.path),l(!1)},className:`block w-full text-left px-3 py-2 rounded-md transition whitespace-nowrap 
                  ${u(x.path)?"text-blue-600 bg-blue-50 dark:bg-blue-900/40 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-800"}`,"aria-current":u(x.path)?"page":void 0,children:x.label},x.path))}),e.jsxs("div",{className:"px-4 py-2 text-sm flex gap-2 border-t",children:[" ",h]})]})]})})}function Me({active:s=!1,label:t,icon:r=null,onClick:a}){return e.jsxs("button",{onClick:a,className:`inline-flex items-center px-3 py-2 text-sm font-medium rounded-md transition whitespace-nowrap
        ${s?"text-blue-600 bg-blue-50 dark:bg-blue-900/40 dark:text-blue-300":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-slate-800"}`,"aria-current":s?"page":void 0,children:[r,t]})}function eu(){const s=zr();ne(k=>k.user);const[t,r]=b.useState(!1),[a,i]=b.useState(!1),[n,o]=b.useState(""),[l,c]=b.useState(!1),[d,u]=b.useState(null),[m,p]=b.useState(null),[h,x]=b.useState(!1),f=b.useMemo(()=>/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i,[]).test(n);b.useEffect(()=>{const k=s.pathname,w=["/","/analyze","/news-analysis","/results"],v=["/login","/signup","/pricing","/checkout"];if(!w.includes(k)||v.includes(k)){r(!1);return}const S=sessionStorage.getItem("dailyBriefDismissed")==="true",_=localStorage.getItem("dailyBriefSubscribed")==="true";if(S||_){r(!1);return}const E=setTimeout(async()=>{try{const{data:$}=await F.auth.getUser(),T=$?.user;if(!!T?.user_metadata?.dailyBriefSubscribed){r(!1);return}if(T?.email){const{data:q}=await F.from("subscriptions").select("id").eq("email",T.email).limit(1),N=!(q&&q.length>0);r(N),N&&i(sessionStorage.getItem("dailyBriefMinimized")==="true")}else r(!0),i(sessionStorage.getItem("dailyBriefMinimized")==="true")}catch{r(!0),i(sessionStorage.getItem("dailyBriefMinimized")==="true")}},3e3);return()=>clearTimeout(E)},[s.pathname]);async function y(k){if(k.preventDefault(),x(!0),u(null),!f){u("Please enter a valid email.");return}c(!0);try{const{error:w}=await F.from("subscriptions").insert({email:n,source:"popup",created_at:new Date().toISOString()});if(w)throw w;await F.auth.updateUser({data:{dailyBriefSubscribed:!0}}),localStorage.setItem("dailyBriefSubscribed","true"),p("Youre subscribed. Welcome to NexVeris Daily."),r(!1),o("")}catch(w){u(w?.message||"Subscription failed. Please try again.")}finally{c(!1)}}return t?e.jsxs(e.Fragment,{children:[e.jsx(ye,{children:t&&!a&&e.jsx(B.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},exit:{opacity:0,y:40},transition:{duration:.3},className:"fixed bottom-4 right-4 w-[92vw] max-w-sm md:max-w-md md:w-auto z-[1000]",role:"dialog","aria-labelledby":"daily-briefing-title",children:e.jsx("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900/90 shadow-2xl backdrop-blur-lg",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"pr-8",children:[e.jsx("h3",{id:"daily-briefing-title",className:"text-lg font-bold text-slate-900 dark:text-white",children:"Stay Informed. Every Morning."}),e.jsx("p",{className:"mt-1 text-sm text-slate-600 dark:text-slate-300",children:"Concise AI-driven briefings on global news and markets with structured signals you can act on."}),e.jsx("span",{className:"mt-2 inline-block text-[10px] uppercase tracking-wide text-gray-500 dark:text-gray-400",children:"FREE DAILY INTELLIGENCE REPORT"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{"aria-label":"Minimize",className:"rounded-md px-2 py-1 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800",onClick:()=>{i(!0),sessionStorage.setItem("dailyBriefMinimized","true")},children:""}),e.jsx("button",{"aria-label":"Close",className:"rounded-md px-2 py-1 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800",onClick:()=>{sessionStorage.setItem("dailyBriefDismissed","true"),r(!1)},children:""})]})]}),e.jsxs("ul",{className:"mt-3 list-disc pl-5 space-y-1 text-slate-800 dark:text-slate-200 text-sm",children:[e.jsx("li",{children:"PESTLE overview"}),e.jsxs("li",{children:["Political motive detection ",e.jsx("span",{className:"ml-1 inline-flex items-center rounded-full bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 text-[10px] px-2 py-0.5",children:"Premium"})]}),e.jsxs("li",{children:["Market impact signals ",e.jsx("span",{className:"ml-1 inline-flex items-center rounded-full bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 text-[10px] px-2 py-0.5",children:"Premium"})]}),e.jsxs("li",{children:["Bias & framing analysis ",e.jsx("span",{className:"ml-1 inline-flex items-center rounded-full bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 text-[10px] px-2 py-0.5",children:"Premium"})]})]}),e.jsxs("form",{onSubmit:y,className:"mt-4","aria-label":"Daily briefing signup",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Vt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 dark:text-slate-500","aria-hidden":"true"}),e.jsx("input",{type:"email",value:n,onChange:k=>o(k.target.value),onBlur:()=>x(!0),placeholder:"Enter your email to subscribe","aria-label":"Email address","aria-invalid":h&&!f,required:!0,className:`w-full pl-9 pr-3 py-2 rounded-md border text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-slate-500 bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-gray-900 dark:focus:ring-slate-200 focus:border-gray-900 dark:focus:border-slate-200 ${h&&!f?"border-red-500":"border-gray-300 dark:border-slate-700"}`})]}),e.jsx("button",{type:"submit",disabled:l,className:"rounded-md bg-gray-900 dark:bg-indigo-600 text-white hover:bg-gray-800 dark:hover:bg-indigo-700 px-4 py-2 text-sm font-medium disabled:opacity-60 disabled:cursor-not-allowed",children:"Get Daily Briefing"})]}),d&&e.jsx("p",{className:"mt-2 text-xs text-red-600 dark:text-red-400",children:d}),e.jsx("p",{className:"mt-2 text-[11px] text-gray-500 dark:text-slate-400",children:"No spam. Unsubscribe anytime. Your email is never shared."})]})]})})})}),e.jsx(ye,{children:t&&a&&e.jsx(B.button,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},exit:{opacity:0,y:40},transition:{duration:.2},className:"fixed bottom-4 right-4 z-[1000] rounded-full bg-slate-900 text-white text-xs px-3 py-2 shadow-lg hover:bg-slate-800","aria-label":"Expand daily briefing",onClick:()=>{i(!1),sessionStorage.removeItem("dailyBriefMinimized")},children:"Daily Briefing"})}),e.jsx(ye,{children:m&&e.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed bottom-4 left-4 z-[1000]",children:e.jsx("div",{className:"rounded-md bg-slate-900 text-white px-4 py-2 text-sm shadow-lg",children:m})})})]}):null}function tu(){const[s,t]=b.useState(!1),[r,a]=b.useState(!1),[i,n]=b.useState(!0),[o,l]=b.useState(!1);b.useEffect(()=>{try{const d=localStorage.getItem("cookieConsent"),u=localStorage.getItem("cookieConsentSettings");if(!d){if(u){const m=JSON.parse(u);n(!!m.analytics),l(!!m.marketing)}t(!0)}}catch{t(!0)}},[]);const c=d=>{localStorage.setItem("cookieConsent",d||""),localStorage.setItem("cookieConsentSettings",JSON.stringify({analytics:i,marketing:o})),t(!1)};return s?e.jsx("div",{className:"fixed bottom-0 inset-x-0 z-[1100]",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-4",children:e.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 bg-white/95 dark:bg-slate-900/90 backdrop-blur-md shadow-2xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 p-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-1 w-8 h-8 rounded-lg bg-blue-600/10 text-blue-600 dark:text-blue-300 flex items-center justify-center",children:e.jsx(gr,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Cookie consent"}),e.jsxs("p",{className:"text-xs text-slate-600 dark:text-slate-300",children:["We use cookies to improve performance and remember preferences. Read our",e.jsx("a",{href:"/privacy",className:"ml-1 text-indigo-600 dark:text-indigo-300 underline",children:"Privacy Policy"}),"."]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>a(d=>!d),className:"inline-flex items-center gap-2 px-3 py-2 text-xs font-medium rounded-md border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-800","aria-expanded":r,children:[e.jsx(zn,{className:"w-4 h-4"})," Cookie Settings"]}),e.jsx("button",{onClick:()=>{n(!1),l(!1),c("rejected")},className:"px-3 py-2 text-xs font-semibold rounded-md border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-800",children:"Reject All"}),e.jsx("button",{onClick:()=>{n(!0),l(!0),c("accepted")},className:"px-3 py-2 text-xs font-bold rounded-md bg-blue-600 text-white hover:bg-blue-700",children:"Accept All"})]})]}),r&&e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"grid sm:grid-cols-2 gap-3 rounded-lg border border-slate-200 dark:border-slate-800 p-3 bg-slate-50 dark:bg-slate-900/40",children:[e.jsxs("label",{className:"flex items-start gap-3 text-sm",children:[e.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"mt-1"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-200",children:"Essential cookies (required)"})]}),e.jsxs("label",{className:"flex items-start gap-3 text-sm",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:d=>n(d.target.checked),className:"mt-1"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-200",children:"Analytics cookies"})]}),e.jsxs("label",{className:"flex items-start gap-3 text-sm",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:d=>l(d.target.checked),className:"mt-1"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-200",children:"Marketing cookies"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c("accepted"),className:"px-3 py-2 text-xs font-bold rounded-md bg-blue-600 text-white hover:bg-blue-700",children:"Save Preferences"}),e.jsx("button",{onClick:()=>a(!1),className:"px-3 py-2 text-xs font-medium rounded-md border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-800",children:"Close"})]})]})})]})})}):null}function su(){return e.jsxs("div",{className:"min-h-screen bg-white text-slate-900 dark:bg-gray-950 dark:text-slate-100 selection:bg-neonCyan selection:text-gray-900 transition-colors",children:[e.jsx(Zd,{}),e.jsx(eu,{}),e.jsx(tu,{}),e.jsx("main",{className:"pt-4 min-h-[calc(100vh-4rem)]",children:e.jsx(So,{})})]})}function ru(){try{if(typeof crypto<"u"&&typeof crypto.randomUUID=="function")return crypto.randomUUID()}catch{}return`${Date.now()}-${Math.random().toString(16).slice(2)}`}const au=["https://www.bloomberg.com/","https://www.wsj.com/","https://www.reuters.com/","https://www.cnbc.com/","https://www.ft.com/","https://www.economist.com/"],Cs={A:{text:"See what you missed",ariaLabel:"See what hidden elements you missed"},B:{text:"Reveal the guidance",ariaLabel:"Reveal how you were guided"},C:{text:"Find what's hidden",ariaLabel:"Find what this article hides"},D:{text:"Uncover the pressure",ariaLabel:"Uncover the hidden pressure"},E:{text:"See the consequence",ariaLabel:"See the market consequence before it hits"}},iu=()=>{if(typeof window>"u")return"A";const t=new URLSearchParams(window.location.search).get("cta");if(t&&Cs[t])return t;const r=Object.keys(Cs);return r[Math.floor(Math.random()*r.length)]};function nu(){const[s,t]=b.useState(""),[r,a]=b.useState(!1),[i,n]=b.useState(""),[o,l]=b.useState(null),[c,d]=b.useState(!1),[u,m]=b.useState(!1),[p,h]=b.useState(!1),[x,g]=b.useState(!1),[f]=b.useState(iu()),[y,k]=b.useState(!1),[w,v]=b.useState(!1),S=De(),_=zr(),E="https://news-backend-production-ba81.up.railway.app",{tier:$,scansUsed:T,scansLimit:P}=ct(),q=typeof P=="number"?P:5,N=$==="free"?(T||0)>=q:typeof P=="number"?(T||0)>=P:!1,R=$==="free"?Math.max(0,q-(T||0)):typeof P=="number"?Math.max(0,P-(T||0)):null,V=R!==null?$==="free"?`Only ${R} free analyses remaining`:`${R}/${P} analyses remaining`:"";b.useEffect(()=>{const C=()=>{g(window.scrollY>100)};return window.addEventListener("scroll",C),()=>window.removeEventListener("scroll",C)},[]),b.useEffect(()=>{if(!s){n("");return}const C=setTimeout(()=>{try{new URL(s),n("")}catch{n("Invalid URL format")}},500);return()=>clearTimeout(C)},[s]),b.useEffect(()=>{(async()=>{const{data:I}=await F.auth.getSession(),G=sessionStorage.getItem("hasSeenLoginPopup");I.session&&!G&&R!==null&&(m(!0),sessionStorage.setItem("hasSeenLoginPopup","true"))})()},[R]),b.useEffect(()=>{const C=I=>{I.clientY<=0&&!y&&R!==null&&R<3&&k(!0)};return document.addEventListener("mouseleave",C),()=>document.removeEventListener("mouseleave",C)},[y,R]),b.useEffect(()=>{if(!localStorage.getItem("nexveris_onboarding_seen")){const I=setTimeout(()=>{v(!0),localStorage.setItem("nexveris_onboarding_seen","true")},1e3);return()=>clearTimeout(I)}},[]);const W=()=>{v(!1)},K=b.useMemo(()=>s?au.filter(C=>C.toLowerCase().includes(s.toLowerCase())):[],[s]),be=async C=>{C?.preventDefault();try{if(n(""),!s.trim()){n("Please enter a valid article URL"),z.error("Please enter a URL");return}new URL(s.trim());const{data:I}=await F.auth.getSession();if(!I.session){z.info("Sign in to analyze",{description:"Create a free account to get started"}),S("/login");return}if(N){z.error("Analysis limit reached",{description:"Upgrade your plan to continue"}),S("/pricing");return}a(!0);const G=await fetch(`${E}/api/analyze/summary`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${I.session.access_token}`},body:JSON.stringify({analysisId:ru(),url:s.trim(),userId:I.session.user.id})});if(!G.ok){let he="Analysis unavailable";try{const dt=await G.json();he=dt?.message||dt?.error||he}catch{}throw new Error(he)}const Q=await G.json();sessionStorage.setItem("analysisResult",JSON.stringify({...Q.data,sourceType:"url",sourceText:s.trim(),timestamp:new Date().toISOString()})),S("/results",{state:{analysisData:Q}})}catch(I){z.error(I?.message||"Analysis failed"),n(I?.message||"Analysis failed")}finally{a(!1)}},Z=()=>{d(!c)},X=C=>{document.getElementById(C)?.scrollIntoView({behavior:"smooth",block:"start"})},ce=[{id:"hero",label:"Home"},{id:"explanation",label:"How it Works"},{id:"features",label:"Features"},{id:"testimonials",label:"Testimonials"},{id:"faq",label:"FAQ"}],[A,M]=b.useState("hero");return b.useEffect(()=>{const C=()=>{const I=ce.map(Q=>document.getElementById(Q.id)),G=window.scrollY+150;for(let Q=I.length-1;Q>=0;Q--){const he=I[Q];if(he&&he.offsetTop<=G){M(ce[Q].id);break}}};return window.addEventListener("scroll",C),()=>window.removeEventListener("scroll",C)},[]),b.useEffect(()=>{const C=_.state?.scrollTo;C&&requestAnimationFrame(()=>{document.getElementById(C)?.scrollIntoView({behavior:"smooth",block:"start"})})},[]),e.jsxs("div",{className:"min-h-screen bg-white text-slate-900 dark:bg-slate-900 dark:text-slate-100",children:[e.jsxs(ul,{children:[e.jsx("title",{children:"Reveal What News Articles Hide | NexVeris AI Analysis"}),e.jsx("meta",{name:"description",content:"You didn't misread the news  you were guided. NexVeris reveals hidden framing, incentive pressure, and market consequences before decisions are made."}),e.jsx("meta",{property:"og:title",content:"Reveal What News Articles Hide | NexVeris"}),e.jsx("meta",{property:"og:description",content:"Join 5,000+ decision-makers who see what articles avoid saying. Detect bias before it costs you."}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("link",{rel:"canonical",href:typeof window<"u"?window.location.href:"https://nexverisai.com/"})]}),e.jsx(ye,{children:w&&e.jsx("div",{className:"fixed inset-0 z-[60] bg-black/60 backdrop-blur-md flex items-center justify-center p-4",children:e.jsxs(B.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3,ease:"easeOut"},className:"bg-white dark:bg-slate-900 rounded-2xl max-w-xl w-full p-8 shadow-2xl relative border border-slate-200 dark:border-slate-800",children:[e.jsx("button",{onClick:W,className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors","aria-label":"Close onboarding",children:e.jsx(St,{className:"w-5 h-5"})}),e.jsx("p",{className:"text-xs uppercase tracking-widest text-blue-600 dark:text-blue-400 mb-2 font-bold",children:"Before you start"}),e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold mb-4 text-slate-900 dark:text-white",children:"NexVeris won't tell you what to believe."}),e.jsxs("p",{className:"text-slate-600 dark:text-slate-300 mb-6 leading-relaxed",children:["We only show you one thing:",e.jsx("br",{}),e.jsx("strong",{className:"text-slate-900 dark:text-white",children:"How this story was constructed, and who benefits most from your interpretation."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 dark:from-slate-800 dark:to-slate-800 rounded-xl p-5 mb-5 border border-blue-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx(Ue,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm text-slate-900 dark:text-white block mb-1",children:'Most readers only see the "surface narrative"'}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Missing perspectives, incentive structures, and market paths are typically invisible"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx(pe,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{children:e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Not seeing the full structure = passively accepting the preset framing"})})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-blue-200 dark:border-slate-600",children:e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 italic",children:" The difference isn't in your stanceit's whether you see the complete structure."})})]}),e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-4 mb-6",children:e.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200 leading-relaxed",children:[e.jsx("strong",{children:"If you only read the article,"}),e.jsx("br",{}),"you're actually following a pre-designed interpretation path."]})}),e.jsxs("button",{onClick:W,className:"w-full flex items-center justify-center gap-2 py-3.5 rounded-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold hover:from-blue-700 hover:to-purple-700 transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:["Start My First Analysis",e.jsx(Ht,{className:"w-4 h-4"})]}),e.jsxs("p",{className:"mt-4 text-center text-xs text-slate-500 dark:text-slate-400",children:["You have ",e.jsx("strong",{className:"text-blue-600 dark:text-blue-400",children:"3 free analyses"})," to see the difference."]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-6 pb-32",style:{paddingTop:"var(--header-offset)"},children:[e.jsxs("section",{id:"hero",className:"pt-12 pb-24 relative",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-16 items-center",children:[e.jsx("div",{className:"lg:col-span-5",children:e.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[R!==null&&R<3&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 text-xs font-bold mb-4 border border-red-200 dark:border-red-800",children:[e.jsx(fe,{className:"w-3.5 h-3.5"}),"Only ",R," free analyses left  Act now"]}),e.jsxs("h1",{className:"text-[46px] md:text-[56px] leading-[1.05] font-bold mb-6",children:["You didn't misread the news.",e.jsx("br",{}),e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"You were guided."})]}),e.jsx("p",{className:"text-lg text-slate-600 dark:text-slate-400 mb-10 max-w-md leading-relaxed",children:"Not by lies  but by what you noticed too late."}),e.jsxs("form",{onSubmit:be,className:"max-w-md mb-6 relative",children:[e.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-800 rounded-full p-2 border-2 border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-md hover:border-blue-400 dark:hover:border-blue-500 transition-all",children:[e.jsx(Fr,{className:"ml-3 w-5 h-5 text-slate-400","aria-hidden":"true"}),e.jsx("input",{type:"url",value:s,onChange:C=>{t(C.target.value),h(!0)},onBlur:()=>setTimeout(()=>h(!1),200),onFocus:()=>s&&h(!0),placeholder:"Paste article URL...",className:"flex-1 bg-transparent px-4 py-3 focus:outline-none text-slate-900 dark:text-slate-100 placeholder-slate-400","aria-label":"Article URL input","aria-invalid":!!i,"aria-describedby":i?"url-error":void 0,"aria-autocomplete":"list","aria-controls":"url-suggestions","aria-expanded":p&&K.length>0}),e.jsx("button",{type:"submit",disabled:r||N||!!i,className:"rounded-full px-6 py-2.5 font-semibold bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700 disabled:from-gray-400 disabled:to-gray-400 transition-all disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 hover:scale-105","aria-label":r?"Analyzing article":N?"Upgrade to continue":Cs[f].ariaLabel,"data-cta-variant":f,children:r?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"w-4 h-4 animate-spin","aria-hidden":"true"}),"Analyzing..."]}):N?"Upgrade":Cs[f].text})]}),e.jsx(ye,{children:p&&K.length>0&&e.jsx(B.div,{id:"url-suggestions",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2,delay:.1},className:"absolute top-full mt-2 left-0 right-0 bg-white dark:bg-slate-800 rounded-lg shadow-lg border border-slate-200 dark:border-slate-700 overflow-hidden",role:"listbox","aria-label":"URL suggestions",children:K.map((C,I)=>e.jsx("button",{type:"button",onClick:()=>{t(C),h(!1)},onMouseDown:G=>G.preventDefault(),className:"w-full text-left px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-700 transition text-sm focus:bg-slate-100 dark:focus:bg-slate-600 focus:outline-none",role:"option","aria-selected":!1,tabIndex:0,children:C},I))})}),i&&e.jsxs("p",{id:"url-error",className:"mt-2 text-sm text-red-600 dark:text-red-400 flex items-center gap-1",role:"alert",children:[e.jsx(fe,{className:"w-3 h-3","aria-hidden":"true"}),i]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs",children:[e.jsx("span",{className:"font-semibold text-red-600 dark:text-red-400",children:V}),e.jsxs("button",{type:"button",onClick:Z,className:"text-slate-600 dark:text-slate-400 underline hover:text-blue-600 dark:hover:text-blue-400 transition inline-flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded","aria-expanded":c,"aria-controls":"preview-section",children:[e.jsx(Ge,{className:"w-3 h-3","aria-hidden":"true"}),c?"Hide example":"See what you can't see"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",role:"list","aria-label":"Analysis workflow",children:[e.jsxs("span",{className:"flex items-center gap-1",role:"listitem",children:[e.jsx(Kt,{className:"w-3 h-3","aria-hidden":"true"}),"Detect hidden framing"]}),e.jsx(Ht,{className:"w-3 h-3","aria-hidden":"true"}),e.jsx("span",{role:"listitem",children:"Infer pressure points"}),e.jsx(Ht,{className:"w-3 h-3","aria-hidden":"true"}),e.jsx("span",{role:"listitem",children:"Project consequences"})]})]})}),e.jsx("div",{className:"lg:col-span-7 flex justify-end",children:e.jsx(B.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},className:"w-full max-w-[650px]",role:"img","aria-label":"Visual representation of bias detection pipeline",children:e.jsxs("div",{className:"relative h-[500px]",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/10 via-purple-500/10 to-transparent rounded-3xl blur-3xl","aria-hidden":"true"}),e.jsxs(B.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.8,delay:.9},className:"absolute top-[360px] left-0 right-0 h-[120px] bg-gradient-to-br from-emerald-50 to-emerald-100 dark:from-emerald-950/40 dark:to-emerald-900/40 rounded-2xl shadow-2xl border-2 border-emerald-300 dark:border-emerald-700 backdrop-blur-sm translate-y-[6px]",children:[e.jsx("div",{className:"absolute top-3 left-6",children:e.jsx("span",{className:"text-[10px] uppercase tracking-widest font-semibold text-emerald-600 dark:text-emerald-400",children:"Projected Market Consequence"})}),e.jsxs("div",{className:"absolute top-8 left-6 flex items-center gap-2 text-emerald-700 dark:text-emerald-400",children:[e.jsx(Te,{className:"w-5 h-5","aria-hidden":"true"}),e.jsx("span",{className:"text-sm font-bold",children:"Consequence"})]}),e.jsx("div",{className:"absolute bottom-4 left-6 text-[10px] text-emerald-600/80 dark:text-emerald-400/80 font-medium",children:"What happens when perception shifts "})]}),e.jsxs(B.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.7},className:"absolute top-[240px] left-0 right-0 h-[120px] bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-950/40 dark:to-orange-900/40 rounded-2xl shadow-xl border border-orange-200 dark:border-orange-800 backdrop-blur-sm translate-y-[4px]",children:[e.jsx("div",{className:"absolute top-3 left-6",children:e.jsx("span",{className:"text-[10px] uppercase tracking-widest font-semibold text-orange-600 dark:text-orange-400",children:"Inferred Incentive Pressure"})}),e.jsxs("div",{className:"absolute top-8 left-6 flex items-center gap-2 text-orange-700 dark:text-orange-400",children:[e.jsx(we,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{className:"text-xs font-medium",children:"Pressure"})]})]}),e.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.5},className:"absolute top-[120px] left-0 right-0 h-[120px] bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950/40 dark:to-purple-900/40 rounded-2xl shadow-lg border border-purple-200 dark:border-purple-800 backdrop-blur-sm translate-y-[2px]",children:[e.jsx("div",{className:"absolute top-3 left-6",children:e.jsx("span",{className:"text-[10px] uppercase tracking-widest font-semibold text-purple-600 dark:text-purple-400",children:"Detected Framing Bias"})}),e.jsxs("div",{className:"absolute top-8 left-6 flex items-center gap-2 text-purple-700 dark:text-purple-400",children:[e.jsx(Ue,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{className:"text-xs font-medium",children:"Bias"})]})]}),e.jsxs(B.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.8,delay:.3},className:"absolute top-0 left-0 right-0 h-[120px] bg-slate-50 dark:bg-slate-800/90 rounded-2xl shadow-md border border-slate-300 dark:border-slate-700 backdrop-blur-sm",children:[e.jsx("div",{className:"absolute top-3 left-6",children:e.jsx("span",{className:"text-[10px] uppercase tracking-widest font-semibold text-slate-500 dark:text-slate-400",children:"Input Narrative"})}),e.jsxs("div",{className:"absolute top-8 left-6 flex items-center gap-2 text-slate-600 dark:text-slate-400",children:[e.jsx(Kt,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{className:"text-xs font-medium",children:"Headline"})]}),e.jsxs("div",{className:"absolute top-14 left-6 right-6",children:[e.jsx("div",{className:"h-2 w-3/4 bg-slate-300 dark:bg-slate-600 rounded-full"}),e.jsx("div",{className:"h-2 w-1/2 bg-slate-200 dark:bg-slate-700 rounded-full mt-2"})]})]})]})})})]}),e.jsx(B.button,{onClick:()=>X("explanation"),className:"absolute bottom-0 left-1/2 -translate-x-1/2 cursor-pointer text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded-full p-2",initial:{y:0},animate:{y:[0,10,0]},transition:{repeat:1/0,duration:1.5,ease:"easeInOut"},"aria-label":"Scroll to next section",tabIndex:0,children:e.jsx(bi,{className:"w-8 h-8","aria-hidden":"true"})})]}),e.jsx(ye,{children:u&&e.jsx(B.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>m(!1),role:"dialog","aria-modal":"true","aria-labelledby":"popup-title",children:e.jsxs(B.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-white dark:bg-slate-800 rounded-2xl p-8 max-w-md w-full shadow-2xl relative",onClick:C=>C.stopPropagation(),children:[e.jsx("button",{onClick:()=>m(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-full p-1","aria-label":"Close popup",children:e.jsx(St,{className:"w-6 h-6"})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 mb-4",children:e.jsx(Vn,{className:"w-8 h-8 text-white","aria-hidden":"true"})}),e.jsx("h2",{id:"popup-title",className:"text-2xl font-bold mb-2",children:"Welcome to NexVeris!"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:"You're ready to see what articles hide."})]}),e.jsx("div",{className:"bg-slate-50 dark:bg-slate-700 rounded-xl p-6 mb-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400 mb-2",children:R}),e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:$==="free"?"Free analyses remaining":"Analyses remaining"})]})}),e.jsx("button",{onClick:()=>m(!1),className:"w-full py-3 rounded-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold hover:from-blue-700 hover:to-purple-700 transition focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Start Detecting Bias"})]})})}),e.jsxs("section",{id:"explanation",className:"mb-32 max-w-6xl mx-auto scroll-mt-20",children:[e.jsxs(B.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6},className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:"This is what invisible guidance looks like."}),e.jsx("p",{className:"text-lg text-slate-600 dark:text-slate-300 max-w-2xl mx-auto",children:"Every article operates on layers you can't see. Most readers follow the path laid out for them. NexVeris shows you where you're being led  before you arrive."})]}),e.jsx(B.div,{initial:{opacity:0,scale:.95},whileInView:{opacity:1,scale:1},viewport:{once:!0},transition:{duration:.6,delay:.2},className:"rounded-2xl shadow-2xl border border-slate-200 dark:border-slate-700 overflow-hidden",children:r?e.jsx("div",{className:"w-full h-[600px] bg-slate-100 dark:bg-slate-800 animate-pulse",role:"status","aria-label":"Loading image",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}):e.jsx("img",{src:"https://zgiwqbpalykrztvvekcg.supabase.co/storage/v1/object/public/Nex/nex01.png",alt:"NexVeris Layer Analysis - How invisible structures guide perception",className:"w-full h-auto",loading:"lazy"})}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-6 mt-12",children:[e.jsx(xs,{number:"01",title:"Surface",desc:"What appears neutral"}),e.jsx(xs,{number:"02",title:"Bias",desc:"What's emphasized"}),e.jsx(xs,{number:"03",title:"Pressure",desc:"Who benefits"}),e.jsx(xs,{number:"04",title:"Consequence",desc:"What moves next"})]})]}),e.jsx(ye,{children:c&&e.jsx(B.section,{id:"preview-section",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-32 max-w-3xl mx-auto scroll-mt-20",children:e.jsxs("div",{className:"rounded-2xl border-2 border-red-200 dark:border-red-800 bg-white dark:bg-slate-900 shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 dark:border-slate-700 bg-red-50 dark:bg-red-900/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(fe,{className:"w-5 h-5 text-red-600 dark:text-red-400","aria-hidden":"true"}),e.jsxs("div",{className:"text-sm font-bold text-red-800 dark:text-red-300",children:["This article appeared neutral.",e.jsx("span",{className:"block text-red-600 dark:text-red-400 mt-1",children:"It wasn't."})]})]}),e.jsx("div",{className:"text-xs text-red-600 dark:text-red-400",children:"Example: Partial Surface Analysis Only"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsx(qa,{label:"Credibility Score",value:"58 / 100",color:"text-orange-600"}),e.jsx(qa,{label:"Manipulation Risk",value:"Elevated",color:"text-red-600"})]}),e.jsxs("div",{className:"rounded-xl bg-slate-50 dark:bg-slate-800 p-5 border border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 mb-2",children:"Detected Bias"}),e.jsxs("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 mb-4",children:["This article emphasizes downside risk while omitting stabilizing data,",e.jsx("span",{className:"text-red-600 dark:text-red-400 font-semibold",children:" nudging"})," readers toward caution without stating it."]}),e.jsx("div",{className:"text-xs font-semibold text-slate-500 mb-2",children:"What's Being Hidden"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Counterparty perspectives, historical context, and mitigating factors that would challenge the framing."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 mb-3",children:"Potentially Impacted (Before Market Reacts)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["NVDA","AAPL","TSLA"].map(C=>e.jsx("span",{className:"px-3 py-1.5 rounded-full text-xs font-semibold bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 border border-emerald-200 dark:border-emerald-800",children:C},C))})]}),e.jsxs("div",{className:"pt-4 border-t-2 border-red-200 dark:border-red-800",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-slate-500 dark:text-slate-400 mb-3",children:[e.jsx(pe,{className:"w-4 h-4"}),e.jsx("p",{className:"text-xs italic",children:"This is only a partial surface read. Full incentive mapping and consequence projection are locked."})]}),e.jsx("button",{onClick:()=>S("/analyze"),className:"w-full py-3 rounded-lg bg-gradient-to-r from-red-600 to-orange-600 text-white font-semibold hover:from-red-700 hover:to-orange-700 transition focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 hover:scale-105",children:"Reveal What This Article Avoids Saying"}),e.jsx("p",{className:"mt-3 text-[10px] text-center text-slate-500 italic",children:"Most users realize the bias only after the decision is made."})]})]})]})})}),e.jsxs("section",{id:"testimonials",className:"mb-32 max-w-5xl mx-auto scroll-mt-20",children:[e.jsxs("h2",{className:"text-3xl md:text-4xl font-bold text-center mb-6",children:["Used by investors testing narrative risk before acting",e.jsx("br",{})]}),e.jsx("p",{className:"text-center text-lg text-slate-600 dark:text-slate-300 max-w-3xl mx-auto mb-12",children:"Real decision-makers who see what articles hide  before perception shapes markets."}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsx(or,{quote:`It didnt tell me what to buy.
It showed me what I was missing.`,author:"John D.",role:"Investment Manager",rating:5}),e.jsx(or,{quote:`I was skeptical at first.
Now I check major headlines here before reacting.`,author:"Sarah L.",role:"Risk Analyst",rating:4}),e.jsx(or,{quote:`Sometimes it confirms my view.
Sometimes it tells me to wait.
Both matter.`,author:"Mike R.",role:"Portfolio Manager",rating:5})]})]}),e.jsxs("section",{id:"features",className:"mb-32 max-w-5xl mx-auto scroll-mt-20",children:[e.jsxs("h2",{className:"text-3xl md:text-4xl font-bold text-center mb-6",children:["If you can't see these layers,",e.jsx("br",{}),e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"you're following the path laid out for you."})]}),e.jsx("p",{className:"text-center text-lg text-slate-600 dark:text-slate-300 max-w-3xl mx-auto mb-12",children:"Headlines shape markets through what they emphasize, omit, and imply. These invisible structures guide decisions before you realize it."}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsx(fs,{title:"What you're being nudged to feel",desc:"Emotional framing and selective emphasis push readers toward fear, urgency, or overconfidence  without stating it directly.",icon:"",hoverDelay:0}),e.jsx(fs,{title:"Who quietly benefits",desc:"Narratives align with economic or political incentives that are never mentioned  but shape every word.",icon:"",hoverDelay:50}),e.jsx(fs,{title:"What's being hidden",desc:"Credibility gaps emerge from weak sourcing, statistical cherry-picking, and omitted context that would challenge the story.",icon:"",hoverDelay:100}),e.jsx(fs,{title:"How perception moves markets",desc:"Impact pathways show how narratives influence sectors and sentiment patterns  before price action makes it obvious.",icon:"",hoverDelay:150})]}),e.jsxs(B.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6},className:"mt-12 text-center bg-blue-50 dark:bg-blue-900/20 rounded-2xl p-8 border-2 border-blue-200 dark:border-blue-800",children:[e.jsx("h3",{className:"text-2xl font-bold mb-3",children:"See the full structure for just $9/month"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-6",children:"Join thousands who've made better decisions after upgrading  limited time offer."}),e.jsx("button",{onClick:()=>S("/pricing"),className:"px-8 py-3 rounded-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold hover:from-blue-700 hover:to-purple-700 transition shadow-lg hover:shadow-xl hover:scale-105",children:"View Plans (Limited Discount)"})]})]}),e.jsxs("section",{className:"mb-32 bg-slate-50 dark:bg-slate-800/40 rounded-3xl px-6 py-16",children:[e.jsxs("h2",{className:"text-3xl md:text-4xl font-bold text-center mb-4",children:["You don't need to trust us.",e.jsx("br",{}),e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"Just follow the structure  and see what to do next."})]}),e.jsx("p",{className:"text-center text-slate-600 dark:text-slate-300 mb-12",children:"No complex setup. No data science required. Just clarity before decisions are made."}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8 max-w-5xl mx-auto",children:[e.jsx(nr,{step:"01",title:"Input",desc:"Paste any news article URL or text. No filters. No preprocessing. Just the raw narrative."}),e.jsx(nr,{step:"02",title:"Detect",desc:"AI breaks down how the narrative is constructed  whats emphasized, whats missing, and where subtle pressure is applied."}),e.jsx(nr,{step:"03",title:"See the path",desc:"See how perception is being shaped  and what posture it implies: act, wait, or defend."})]}),e.jsxs("p",{className:"mt-10 text-center text-xs text-slate-500 dark:text-slate-400",children:[e.jsx("span",{className:"font-semibold",children:"Output:"})," Narrative intent  Incentive pressure  Market consequence  Decision posture"]})]}),e.jsx("section",{className:"max-w-4xl mx-auto mb-32",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900/40 rounded-2xl border border-slate-200 dark:border-slate-800 px-8 py-10 text-center shadow-sm",children:[e.jsxs("h3",{className:"text-2xl font-bold mb-4",children:["Built for people who make decisions",e.jsx("br",{}),e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"before the consequences are obvious"})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mb-6",children:[e.jsx("span",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full border border-slate-200 dark:border-slate-700 text-sm font-medium",children:" Investors & Analysts"}),e.jsx("span",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full border border-slate-200 dark:border-slate-700 text-sm font-medium",children:" Risk Managers"}),e.jsx("span",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full border border-slate-200 dark:border-slate-700 text-sm font-medium",children:" Strategic Researchers"})]}),e.jsxs("p",{className:"text-slate-600 dark:text-slate-300 max-w-2xl mx-auto",children:["NexVeris doesnt tell you what to think or predict what will happen. It shows how narratives shape pressure and incentives  so you can decide ",e.jsx("strong",{children:"when to act, when to wait, and when to defend"}),"."]})]})}),e.jsxs("section",{id:"faq",className:"max-w-4xl mx-auto mb-32 scroll-mt-20",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-10",children:"Common Questions"}),e.jsx("div",{className:"divide-y border-t border-b border-slate-200 dark:border-slate-700",role:"region","aria-label":"Frequently asked questions",children:ou.map((C,I)=>e.jsxs("div",{className:"py-6",children:[e.jsxs("button",{onClick:()=>l(o===I?null:I),className:"w-full flex justify-between items-center text-left group focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded-lg px-2 -mx-2","aria-expanded":o===I,"aria-controls":`faq-answer-${I}`,"aria-haspopup":"true",children:[e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition",children:C.q}),e.jsx(Rs,{className:`w-5 h-5 text-slate-400 transition-transform ${o===I?"rotate-180":""}`,"aria-hidden":"true"})]}),e.jsx(ye,{children:o===I&&e.jsx(B.div,{id:`faq-answer-${I}`,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:e.jsx("p",{className:"mt-4 text-slate-600 dark:text-slate-300 leading-relaxed",children:C.a})})})]},I))})]}),e.jsxs("section",{className:"text-center bg-gradient-to-br from-blue-600 to-purple-600 text-white py-20 rounded-3xl shadow-2xl",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6",children:"See what this article isn't telling you."}),e.jsx("p",{className:"text-lg md:text-xl mb-10 max-w-2xl mx-auto text-white/90",children:"Most narratives guide perception through what they emphasize, omit, and imply. Miss this and you're following someone else's path  join 5,000+ who see the structure."}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:N?e.jsx("button",{onClick:()=>S("/pricing"),className:"px-10 py-4 rounded-full bg-white text-blue-700 font-bold text-lg hover:bg-gray-100 shadow-lg transition-all hover:scale-105 focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-blue-600",children:"Upgrade Now (Limited Offer)"}):e.jsx("button",{onClick:()=>S("/analyze"),className:"px-10 py-4 rounded-full bg-white text-blue-700 font-bold text-lg hover:bg-gray-100 shadow-lg transition-all hover:scale-105 focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-blue-600",children:"Reveal What's Being Hidden"})}),e.jsx("p",{className:"mt-6 text-sm text-white/70 italic",children:"Most users realize the bias only after the decision is made."}),V&&e.jsxs("div",{className:"mt-4 text-sm font-semibold text-white/90",children:[" ",V]})]}),e.jsx(ye,{children:y&&e.jsx(B.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>k(!1),role:"dialog","aria-modal":"true","aria-labelledby":"exit-popup-title",children:e.jsxs(B.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-white dark:bg-slate-800 rounded-2xl p-8 max-w-md w-full shadow-2xl relative border-2 border-red-500 dark:border-red-600",onClick:C=>C.stopPropagation(),children:[e.jsx("button",{onClick:()=>k(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-full p-1","aria-label":"Close popup",children:e.jsx(St,{className:"w-6 h-6"})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-red-500 to-orange-500 mb-4",children:e.jsx(fe,{className:"w-8 h-8 text-white","aria-hidden":"true"})}),e.jsx("h2",{id:"exit-popup-title",className:"text-2xl font-bold mb-2",children:"Wait  you're still being guided"}),e.jsxs("p",{className:"text-slate-600 dark:text-slate-300",children:["Only ",R," free analyses left. After that, you're back to reading without seeing the structure."]})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-xl p-4 mb-6 border border-red-200 dark:border-red-800",children:[e.jsx("div",{className:"text-sm font-semibold text-red-800 dark:text-red-300 mb-2",children:" Don't miss what articles avoid saying"}),e.jsx("div",{className:"text-xs text-red-600 dark:text-red-400",children:"Upgrade now: Unlimited bias detection + 20% off Pro plans"})]}),e.jsx("button",{onClick:()=>S("/pricing"),className:"w-full py-3 rounded-full bg-gradient-to-r from-red-600 to-orange-600 text-white font-semibold hover:from-red-700 hover:to-orange-700 transition focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:"See the Full Structure (20% Off)"}),e.jsx("button",{onClick:()=>k(!1),className:"w-full mt-3 text-sm text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 transition italic",children:"No thanks, I'll keep being guided"})]})})}),e.jsxs("section",{className:"sr-only","aria-hidden":"true",children:[e.jsx("h2",{children:"AI-powered News Bias Detection Platform"}),e.jsx("p",{children:"NexVeris reveals hidden framing, incentive pressure, and market consequences in news articles. Join 5,000+ investors who detect bias before decisions are made."})]})]})]})}function qa({label:s,value:t,color:r="text-slate-900 dark:text-slate-100"}){return e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:s}),e.jsx("span",{className:`text-lg font-bold ${r}`,children:t})]})}function xs({number:s,title:t,desc:r}){return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 font-bold mb-3",children:s}),e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100 mb-1",children:t}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:r})]})}function fs({title:s,desc:t,icon:r,hoverDelay:a=0}){return e.jsxs("div",{className:"p-6 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 shadow-md hover:shadow-xl hover:border-orange-300 dark:hover:border-orange-700 transition-all focus-within:ring-2 focus-within:ring-blue-500",style:{transitionDelay:`${a}ms`},tabIndex:0,children:[e.jsx("div",{className:"text-3xl mb-4","aria-hidden":"true",children:r}),e.jsx("h3",{className:"text-xl font-semibold mb-3 text-slate-900 dark:text-white",children:s}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 leading-relaxed",children:t})]})}function nr({step:s,title:t,desc:r}){return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -top-6 -left-6 w-16 h-16 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center text-white font-bold text-xl shadow-lg",children:s}),e.jsxs("div",{className:"pt-8 pl-6",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-3 text-slate-900 dark:text-white",children:t}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 leading-relaxed",children:r})]})]})}function or({quote:s,author:t,role:r,avatar:a,rating:i}){return e.jsxs(B.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6},className:"p-6 rounded-2xl border-2 border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 shadow-md hover:shadow-xl hover:border-blue-300 dark:hover:border-blue-700 transition-all",children:[e.jsx("div",{className:"flex items-center gap-1 mb-3",children:Array.from({length:i}).map((n,o)=>e.jsx(yi,{className:"w-4 h-4 fill-yellow-400 text-yellow-400","aria-hidden":"true"},o))}),e.jsxs("p",{className:"text-sm italic text-slate-600 dark:text-slate-300 mb-4",children:['"',s,'"']}),e.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("span",{className:"text-3xl",children:a}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-white",children:t}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:r})]})]})]})}const ou=[{q:"How does NexVeris detect bias I can't see?",a:"NexVeris analyzes structural patterns in how articles frame, emphasize, and omit information  detecting pressure points and incentive signals that shape perception without explicit statements."},{q:"Do you store or reuse my articles?",a:"No. Analysis is generated on demand and is not stored, reused for training, or redistributed. Your queries remain private."},{q:"Who is NexVeris built for?",a:"Investors, analysts, researchers, risk managers, and decision-makers who need to see how articles guide perception before making critical decisions."},{q:"How does it help with investments?",a:"By revealing hidden framing, incentive pressure, and market consequences in news, NexVeris helps you position earlier, avoid traps, and make decisions based on structure rather than surface narrative."},{q:"What makes NexVeris different from news aggregators?",a:"News aggregators summarize what happened. NexVeris analyzes how the narrative guides you  revealing the invisible structure before you follow the path laid out for you."},{q:"Why the urgency messaging?",a:"Because most users realize the bias only after the decision is made. We want you to see the structure before perception shapes action."}];function lu(){const s=ne(x=>x.setUser),[t,r]=b.useState(""),[a,i]=b.useState(""),[n,o]=b.useState(!1),[l,c]=b.useState(null),d=async(x,g)=>{try{const{data:f,error:y}=await F.from("users").select("plan, billing_cycle, scans_used_this_month, scans_limit").eq("id",x).single(),k=["free","starter","pro","business"];if(y||!f){s({id:x,email:g,plan:"free",billingCycle:null,scansUsed:0,scansLimit:10});return}s({id:x,email:g,plan:k.includes(f.plan)?f.plan:"free",billingCycle:f.billing_cycle||null,scansUsed:f.scans_used_this_month??0,scansLimit:f.scans_limit??10})}catch{s({id:x,email:g,plan:"free",billingCycle:null,scansUsed:0,scansLimit:10})}},u=async()=>{if(!t||!a){c("Please enter email and password");return}try{o(!0),c(null);const{data:x,error:g}=await F.auth.signInWithPassword({email:t,password:a});if(g)throw g;if(!x.user)throw new Error("Login failed");await d(x.user.id,x.user.email||"")}catch(x){c(x.message||"Failed to sign in")}finally{o(!1)}},m=async()=>{c(null),await F.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}})},p=async()=>{c(null),await F.auth.signInWithOAuth({provider:"github",options:{redirectTo:`${window.location.origin}/auth/callback`}})},h=x=>{x.key==="Enter"&&!n&&u()};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-950",children:e.jsxs("div",{className:"w-full max-w-sm rounded-xl bg-white dark:bg-slate-900/80 p-8 shadow-lg border border-slate-200 dark:border-slate-800",children:[e.jsx("h1",{className:"text-2xl font-bold text-center mb-6",children:"Welcome Back"}),l&&e.jsx("div",{className:"mb-4 rounded border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-600 dark:border-red-800 dark:bg-red-900/20 dark:text-red-400",children:l}),e.jsx("input",{type:"email",placeholder:"you@example.com",className:"mb-3 w-full rounded border border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-3 py-2 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500",value:t,onChange:x=>r(x.target.value),onKeyDown:h,disabled:n}),e.jsx("input",{type:"password",placeholder:"",className:"mb-4 w-full rounded border border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-3 py-2 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500",value:a,onChange:x=>i(x.target.value),onKeyDown:h,disabled:n}),e.jsx("button",{onClick:u,disabled:n,className:"w-full rounded bg-indigo-600 py-2 font-semibold text-white hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Signing in...":"Sign In"}),e.jsx("div",{className:"my-4 text-center text-sm text-gray-400",children:"or continue with"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:m,disabled:n,className:"flex-1 rounded border border-gray-300 dark:border-slate-700 py-2 hover:bg-gray-100 dark:hover:bg-slate-800",children:"Google"}),e.jsx("button",{onClick:p,disabled:n,className:"flex-1 rounded border border-gray-300 dark:border-slate-700 py-2 hover:bg-gray-100 dark:hover:bg-slate-800",children:"GitHub"})]}),e.jsx("div",{className:"mt-4 flex justify-between text-sm",children:e.jsx(ve,{to:"/forgot-password",className:"text-indigo-600 dark:text-indigo-400 hover:underline",children:"Forgot password?"})}),e.jsxs("p",{className:"mt-4 text-center text-sm text-slate-600 dark:text-slate-400",children:["Dont have an account?"," ",e.jsx(ve,{to:"/signup",className:"text-indigo-600 dark:text-indigo-400 hover:underline",children:"Sign up"})]})]})})}function cu(){const s=De(),{signUp:t,signInWithOAuth:r,loading:a,error:i,clearError:n,isAuthenticated:o}=ne(),[l,c]=b.useState({email:"",password:"",confirmPassword:"",termsAccepted:!1}),[d,u]=b.useState(!1),[m,p]=b.useState(!1),[h,x]=b.useState({}),[g,f]=b.useState({score:0,requirements:{minLength:!1,hasUppercase:!1,hasLowercase:!1,hasNumber:!1,hasSpecialChar:!1}});b.useEffect(()=>{o&&s("/")},[o,s]),b.useEffect(()=>{i&&(console.error(" Signup auth error:",i),z.error(i.message||"Signup failed"),n())},[i,n]),b.useEffect(()=>{y(l.password)},[l.password]);const y=T=>{const P={minLength:T.length>=8,hasUppercase:/[A-Z]/.test(T),hasLowercase:/[a-z]/.test(T),hasNumber:/\d/.test(T),hasSpecialChar:/[!@#$%^&*(),.?":{}|<>]/.test(T)},q=Object.values(P).filter(Boolean).length;f({score:q,requirements:P})},k=()=>g.score<=2?"text-red-600":g.score<=3?"text-yellow-600":"text-green-600",w=()=>g.score<=2?"Weak":g.score<=3?"Fair":g.score===4?"Good":"Strong",v=()=>{const T={};return l.email?/\S+@\S+\.\S+/.test(l.email)||(T.email="Email is invalid"):T.email="Email is required",l.password?g.score<3&&(T.password="Password is too weak"):T.password="Password is required",l.password!==l.confirmPassword&&(T.confirmPassword="Passwords do not match"),l.termsAccepted||(T.terms="You must accept the terms and conditions"),x(T),Object.keys(T).length===0},S=async T=>{if(T.preventDefault(),!a&&v())try{console.log(" Signup submit:",l.email),await t(l.email,l.password),console.log(" Supabase signUp() resolved"),z.success("Account created successfully! Please check your email to verify your account."),s("/login")}catch(P){console.error(" Signup failed:",P),z.error("Unable to create account")}},_=async()=>{try{await r("google")}catch(T){console.error("Google signup error:",T)}},E=async()=>{try{await r("github")}catch(T){console.error("GitHub signup error:",T)}},$=T=>{const{name:P,value:q,type:N,checked:R}=T.target;c(V=>({...V,[P]:N==="checkbox"?R:q})),h[P]&&x(V=>({...V,[P]:void 0}))};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-950 dark:to-gray-900 flex items-center justify-center px-4 py-12",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900/70 rounded-2xl shadow-xl p-8 border border-slate-200 dark:border-slate-800 backdrop-blur-lg",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Create your account"}),e.jsx("p",{className:"text-gray-600 dark:text-slate-300",children:"Get started with your free account today"})]}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Vt,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{name:"email",type:"email",required:!0,value:l.email,onChange:$,className:"w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"you@example.com"})]}),h.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:h.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{name:"password",type:d?"text":"password",required:!0,value:l.password,onChange:$,className:"w-full pl-10 pr-12 py-3 rounded-lg border border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:""}),e.jsx("button",{type:"button",onClick:()=>u(!d),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d?e.jsx(Gt,{className:"h-5 w-5"}):e.jsx(Ue,{className:"h-5 w-5"})})]}),h.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:h.password}),l.password&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-slate-400",children:"Password strength:"}),e.jsx("span",{className:`text-sm font-medium ${k()}`,children:w()})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${g.score<=2?"bg-red-500":g.score<=3?"bg-yellow-500":"bg-green-500"}`,style:{width:`${g.score/5*100}%`}})}),e.jsxs("div",{className:"space-y-1 mt-3",children:[e.jsx(Dt,{met:g.requirements.minLength,text:"At least 8 characters"}),e.jsx(Dt,{met:g.requirements.hasUppercase,text:"One uppercase letter"}),e.jsx(Dt,{met:g.requirements.hasLowercase,text:"One lowercase letter"}),e.jsx(Dt,{met:g.requirements.hasNumber,text:"One number"}),e.jsx(Dt,{met:g.requirements.hasSpecialChar,text:"One special character"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{name:"confirmPassword",type:m?"text":"password",required:!0,value:l.confirmPassword,onChange:$,className:"w-full pl-10 pr-12 py-3 rounded-lg border border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:""}),e.jsx("button",{type:"button",onClick:()=>p(!m),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:m?e.jsx(Gt,{className:"h-5 w-5"}):e.jsx(Ue,{className:"h-5 w-5"})})]}),h.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:h.confirmPassword})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("input",{name:"termsAccepted",type:"checkbox",checked:l.termsAccepted,onChange:$,className:"mt-1 h-4 w-4 rounded border-gray-300 dark:border-slate-700 text-blue-600 focus:ring-blue-500"}),e.jsxs("label",{className:"ml-2 text-sm text-gray-600 dark:text-slate-300",children:["I agree to the"," ",e.jsx(ve,{to:"/terms",className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Terms and Conditions"})," ","and"," ",e.jsx(ve,{to:"/privacy",className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Privacy Policy"})]})]}),h.terms&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:h.terms}),e.jsx("button",{type:"submit",disabled:a,className:"w-full py-3 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700 focus:ring-4 focus:ring-blue-500/50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:a?e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Creating account..."]}):"Create account"})]}),e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-slate-700"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-4 bg-white dark:bg-slate-900/70 text-gray-500 dark:text-slate-400",children:"Or continue with"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{type:"button",onClick:_,disabled:a,className:"flex items-center justify-center gap-2 py-3 px-4 rounded-lg border border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-gray-50 dark:hover:bg-slate-700 text-gray-700 dark:text-slate-300 font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Google"]}),e.jsxs("button",{type:"button",onClick:E,disabled:a,className:"flex items-center justify-center gap-2 py-3 px-4 rounded-lg border border-gray-300 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-gray-50 dark:hover:bg-slate-700 text-gray-700 dark:text-slate-300 font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Kn,{className:"w-5 h-5"}),"GitHub"]})]}),e.jsxs("p",{className:"mt-6 text-center text-sm text-gray-600 dark:text-slate-400",children:["Already have an account?"," ",e.jsx(ve,{to:"/login",className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Sign in"})]})]})})})}function Dt({met:s,text:t}){return e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[s?e.jsx(ks,{className:"h-4 w-4 text-green-500"}):e.jsx(St,{className:"h-4 w-4 text-gray-400 dark:text-slate-600"}),e.jsx("span",{className:s?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-slate-500",children:t})]})}const Ha="http://localhost:8081",du=[{id:"starter",name:"Starter",monthly:{price:"$9"},yearly:{price:"$90",save:"Save $18"},scansPerMonth:40,tagline:"See the frame. Not the full picture.",riskLevel:"Awareness Only",description:`Designed for readers who want to stop being passively informed.

Starter helps you recognize framing, bias, and narrative intent  so you know when to pause, question, and look deeper.`,intensity:2,topValueBullets:["Identify framing and narrative bias","Understand why stories are told this way","Surface-level insight for awareness  not decision-making"],buttonText:"Start Seeing the Frame",warning:"Not designed for predicting outcomes, consequences, or impact. Best for occasional reading, not decisions.",icon:Ue,features:["40 Analyses / Month","Situation summary and credibility indicators","Full PESTLE context analysis","Narrative motives and intent (why the story is framed this way)","Power dynamics and stakeholder impact (Pro only)","Market impact and future scenarios (Pro only)","Standard Support"]},{id:"pro",name:"Pro Analyst",monthly:{price:"$29"},yearly:{price:"$290",save:"Save $58"},scansPerMonth:200,tagline:"When getting it wrong actually costs you.",riskLevel:"Decision-Grade",description:`Built for people who can't afford shallow understanding.

Pro goes beyond narrative awareness and answers the real question: What happens next  and who benefits from it?`,intensity:3,topValueBullets:["Complete intelligence: motives  consequences  decisions","Market impact and downstream effects emphasized","Designed for decision-making, not just reading"],buttonText:"Upgrade to Decision-Grade Intelligence",popular:!0,badge:"Most users upgrade after their first few analyses",icon:Ne,features:["200 Analyses / Month","Everything in Starter, plus:","Power dynamics and stakeholder impact analysis","Market impact, scenario modeling and chain reactions","Second-order effects and feedback loop detection","Priority support"]},{id:"business",name:"Business",monthly:{price:"$79"},yearly:{price:"$790",save:"Save $158"},scansPerMonth:800,tagline:"When decisions compound at scale.",riskLevel:"Enterprise-Grade",description:`Built for professionals who rely on deep intelligence every day. 

Designed for sustained, high-volume analysis  when every insight compounds into strategic advantage.`,intensity:5,topValueBullets:["Everything in Pro plus high-volume capacity","Priority processing and extended history","Built for professional-grade operations"],buttonText:"Scale Your Intelligence Operation",icon:it,features:["800 Analyses / Month","Everything in Pro, plus:","Priority processing during peak hours","CSV and PDF data export","Extended analysis history retention","Early access to new analysis models","Dedicated priority support"]}],uu=[{id:"extra_7",label:"50 Analyses",price:"$7",perScan:"$0.14/scan"},{id:"extra_200",label:"200 Analyses",price:"$20",perScan:"$0.10/scan"}];function hu({cycle:s,onSelectPlan:t}){return e.jsx("div",{className:"max-w-6xl mx-auto mb-20",children:e.jsx("div",{className:"grid lg:grid-cols-3 gap-8",children:du.map((r,a)=>{const i=r.popular,n=s==="monthly"?r.monthly:r.yearly,o=r.icon;return e.jsxs("div",{className:`relative bg-white dark:bg-slate-900 rounded-2xl border-2 transition-all duration-300 ${i?"border-indigo-500 shadow-2xl scale-[1.05] dark:shadow-indigo-500/20":"border-gray-200 dark:border-slate-800 hover:border-indigo-300 dark:hover:border-indigo-700 hover:shadow-xl"}`,children:[i&&e.jsxs("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white text-xs font-bold px-4 py-1.5 rounded-full shadow-lg flex items-center gap-1.5",children:[e.jsx(Kt,{className:"w-3 h-3"}),"Most Popular"]}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:`w-6 h-6 ${i?"text-indigo-600 dark:text-indigo-400":"text-slate-600 dark:text-slate-400"}`}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r.name})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-semibold ${i?"bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-400":"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400"}`,children:r.riskLevel})]}),e.jsx("p",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:r.tagline})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:`text-5xl font-bold ${i?"text-indigo-600 dark:text-indigo-400":"text-gray-900 dark:text-white"}`,children:n.price}),e.jsxs("span",{className:"text-gray-500 dark:text-gray-400 text-lg",children:["/",s==="monthly"?"mo":"yr"]})]}),s==="yearly"&&e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 font-semibold mt-1",children:n.save}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:[r.scansPerMonth," analyses/month"]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 whitespace-pre-line mb-6 leading-relaxed",children:r.description}),e.jsx("div",{className:"mb-6 space-y-2",children:r.topValueBullets.map((l,c)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(ks,{className:`w-4 h-4 flex-shrink-0 mt-0.5 ${i?"text-indigo-500":"text-green-600"}`}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:l})]},c))}),r.warning&&e.jsx("div",{className:"mb-6 p-3 rounded-lg bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(fe,{className:"w-4 h-4 text-orange-600 dark:text-orange-400 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-xs text-orange-800 dark:text-orange-300 font-medium leading-relaxed",children:r.warning})]})}),e.jsxs("details",{className:"mb-6",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-semibold text-indigo-600 dark:text-indigo-400 hover:underline mb-4 select-none",children:"See all features"}),e.jsx("ul",{className:"space-y-2 mt-4",children:r.features.map((l,c)=>{const d=l.includes("(Pro only)"),u=l.includes(":")||l.includes("Everything"),m=l.replace(" (Pro only)","");return e.jsxs("li",{className:`flex items-start gap-2 text-sm ${d?"text-gray-400 dark:text-gray-600":u?"text-gray-900 dark:text-white font-medium":"text-gray-700 dark:text-gray-300"}`,children:[d?e.jsx(pe,{className:"w-4 h-4 text-indigo-400 dark:text-indigo-600 flex-shrink-0 mt-0.5"}):e.jsx(ks,{className:"w-4 h-4 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:[m,d&&e.jsx("span",{className:"text-indigo-600 dark:text-indigo-400 font-medium ml-1",children:"(Pro)"})]})]},c)})})]}),e.jsx("button",{onClick:()=>t(r.id),className:`w-full py-4 px-6 rounded-xl font-bold text-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 ${i?"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white shadow-lg hover:shadow-xl focus:ring-indigo-500":"bg-gray-900 dark:bg-white text-white dark:text-gray-900 hover:bg-gray-800 dark:hover:bg-gray-100 shadow-md hover:shadow-lg focus:ring-gray-500"}`,children:r.buttonText}),r.badge&&e.jsx("p",{className:"mt-4 text-xs text-center text-gray-500 dark:text-gray-400 italic",children:r.badge})]})]},r.id)})})})}function mu(){const s=a=>a.startsWith("5.")||a.startsWith("6.")||a.startsWith("7"),t=(a,i)=>a==="starter"&&s(i)?e.jsx(pe,{className:"w-6 h-6 text-gray-300 dark:text-gray-600 mx-auto"}):e.jsx(ks,{className:"w-6 h-6 text-green-600 dark:text-green-400 mx-auto"}),r=[{category:"Core Analysis",items:[{name:"1. Situation Brief",free:!0,icon:nt,desc:"Executive summary with key points"},{name:"2. Source & Bias Check",free:!0,icon:Ne,desc:"Credibility and manipulation scores"},{name:"3. Big Picture Forces",free:!0,icon:Je,desc:"PESTLE analysis (Political, Economic, Social, Tech, Legal, Environmental)"}]},{category:"Premium Intelligence",items:[{name:"4. Hidden Motives",free:!1,icon:Gn,desc:"Detect narrative drivers and hidden agendas"},{name:"5. Power Dynamics",free:!1,icon:we,desc:"Who has influence and who matters"},{name:"6. Market Impact",free:!1,icon:Te,desc:"Stock tickers with evidence-based analysis"}]},{category:"Advanced Models",items:[{name:"7a. Future Scenarios",free:!1,icon:wi,desc:"Historical parallels and scenario modeling"},{name:"7b. Signal Quality Score",free:!1,icon:ot,desc:"Chaos and stability metrics"},{name:"7c. Chain Reaction Analysis",free:!1,icon:vi,desc:"Feedback loops and causal chains"}]}];return e.jsxs("div",{className:"max-w-5xl mx-auto mb-20",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"What's Included in Each Plan?"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400 mb-2",children:"All plans include core intelligence. Higher tiers unlock deeper motives, impact analysis, and future scenarios."}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 italic",children:"Starter shows you the bias. Pro shows you what happens because of it."})]}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-xl border border-gray-200 dark:border-slate-800 overflow-hidden",children:r.map((a,i)=>e.jsxs("div",{className:i>0?"border-t border-gray-200 dark:border-slate-800":"",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-slate-800 dark:to-slate-850 px-6 py-4",children:e.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white",children:a.category})}),e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-slate-800",children:a.items.map((n,o)=>{const l=n.icon;return e.jsxs("div",{className:"flex items-center justify-between px-6 py-5 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx(l,{className:"w-6 h-6 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:n.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:n.desc})]})]}),e.jsxs("div",{className:"flex items-center gap-8 ml-4",children:[e.jsx("div",{className:"w-16 flex justify-center",children:t("starter",n.name)}),e.jsx("div",{className:"w-16 flex justify-center",children:t("pro",n.name)}),e.jsx("div",{className:"w-16 flex justify-center",children:t("business",n.name)})]})]},o)})})]},i))})]})}function xu({onSelectPack:s}){return e.jsxs("div",{className:"max-w-4xl mx-auto mb-20",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"Pay-As-You-Go Packs"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:"No commitment. Purchase only when you need extra analyses."})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:uu.map(t=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border-2 border-gray-200 dark:border-slate-800 p-6 hover:border-blue-400 dark:hover:border-blue-600 hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:t.label}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.perScan})]}),e.jsx("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:t.price})]}),e.jsx("button",{onClick:()=>s(t.id),className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Purchase Pack"})]},t.id))})]})}function fu(){const[s,t]=b.useState("monthly"),[r,a]=b.useState(!1);b.useEffect(()=>{window.scrollTo(0,0)},[]);const i=async o=>{a(!0);try{const{data:{user:l},error:c}=await F.auth.getUser();if(c||!l){window.location.href="/login?redirect=/pricing";return}const d={userId:l.id,email:l.email,tier:o,billingCycle:s},u=await fetch(`${Ha}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!u.ok)throw new Error("Backend failed to create checkout session");const m=await u.json();if(!m?.url)throw new Error("Checkout session created but no URL returned");window.location.href=m.url}catch(l){console.error("Checkout error:",l),alert("Checkout is not configured. Please try again later.")}finally{a(!1)}},n=async o=>{a(!0);try{const{data:{user:l}}=await F.auth.getUser();if(!l){window.location.href="/login?redirect=/pricing";return}const c={userId:l.id,email:l.email,pack:o},u=await(await fetch(`${Ha}/api/stripe/buy-extra-scans`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).json();if(!u?.url)throw new Error("No checkout URL");window.location.href=u.url}catch(l){console.error(l),alert("Checkout is not configured. Please try again later.")}finally{a(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white dark:from-slate-950 dark:to-slate-900 py-20 px-4",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h1",{className:"text-5xl font-bold text-gray-900 dark:text-white mb-4",children:"Choose how seriously you take information"}),e.jsxs("p",{className:"text-xl text-gray-600 dark:text-gray-400 max-w-3xl mx-auto mb-2",children:["Most people read news. Some understand it."," ",e.jsx("span",{className:"text-gray-900 dark:text-white font-semibold",children:"A few use it to avoid costly mistakes."})]}),e.jsxs("div",{className:"mt-6 inline-flex items-center gap-3 px-6 py-3 rounded-full bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800",children:[e.jsx(fe,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),e.jsx("span",{className:"text-sm font-medium text-orange-800 dark:text-orange-300",children:"Your risk tolerance determines which plan fits"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mt-8",children:[e.jsx("button",{onClick:()=>t("monthly"),className:`px-6 py-2 rounded-lg font-semibold transition-all ${s==="monthly"?"bg-indigo-600 text-white shadow-lg":"bg-gray-200 dark:bg-slate-800 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-slate-700"}`,children:"Monthly"}),e.jsxs("button",{onClick:()=>t("yearly"),className:`px-6 py-2 rounded-lg font-semibold transition-all relative ${s==="yearly"?"bg-indigo-600 text-white shadow-lg":"bg-gray-200 dark:bg-slate-800 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-slate-700"}`,children:["Yearly",e.jsx("span",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-0.5 rounded-full font-bold",children:"Save 20%"})]})]})]}),e.jsx(hu,{cycle:s,onSelectPlan:i}),e.jsx("div",{className:"max-w-4xl mx-auto mb-20",children:e.jsxs("div",{className:"text-center bg-gradient-to-br from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-900 rounded-2xl p-8 border border-slate-200 dark:border-slate-700 shadow-lg",children:[e.jsx("p",{className:"text-base text-slate-600 dark:text-slate-400 mb-2",children:"Starter helps you notice signals."}),e.jsx("p",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"Pro helps you avoid consequences."}),e.jsxs("div",{className:"mt-8 grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ue,{className:"w-5 h-5 text-slate-500"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-white",children:"Starter"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"For awareness and curiosity  when understanding bias matters, but consequences don't."})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 border border-indigo-200 dark:border-indigo-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-white",children:"Pro Analyst"})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:"For decision-making  when getting it wrong actually costs you money, reputation, or opportunity."})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(it,{className:"w-5 h-5 text-slate-500"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-white",children:"Business"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"For professional operations  when every insight compounds into strategic advantage."})]})]})]})}),e.jsx(mu,{}),e.jsx(xu,{onSelectPack:n}),e.jsxs("div",{className:"text-center text-gray-600 dark:text-gray-400 max-w-2xl mx-auto",children:[e.jsx("p",{className:"mb-2",children:"Need help choosing? Contact us at support@nexverisai.com"}),e.jsx("p",{className:"text-sm",children:"All plans include 7-day money-back guarantee. Cancel anytime."})]})]})}function gu({value:s,onChange:t,placeholder:r="Paste article URL to analyze...",onSubmit:a,isLoading:i=!1,disabled:n=!1,isValid:o=!1}){return e.jsxs("div",{className:"relative flex items-center bg-white/90 dark:bg-slate-900/70 backdrop-blur rounded-full p-2 shadow-[0_10px_40px_-10px_rgba(15,23,42,0.25)] ring-1 ring-slate-900/5 dark:ring-slate-300/10",children:[e.jsx("div",{className:"pl-4 text-slate-400 dark:text-slate-400",children:e.jsx(Fr,{className:"w-5 h-5"})}),e.jsx("input",{type:"text",value:s,onChange:l=>t(l.target.value),placeholder:r,className:"flex-1 bg-transparent text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500 px-4 py-3 focus:outline-none text-lg",disabled:n||i}),o&&e.jsx("div",{className:"pr-3 text-emerald-500",children:e.jsx(ze,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",onClick:a,disabled:n||i,className:`rounded-full px-8 py-3 font-bold transition-all flex items-center gap-2 shadow-lg shadow-blue-600/25 ${n||i?"bg-slate-300 text-slate-600 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500 dark:bg-blue-600 dark:hover:bg-blue-500 text-white"}`,children:i?e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"w-4 h-4 animate-spin"})," Analyzing..."]}):e.jsxs(e.Fragment,{children:["Analyze ",e.jsx(Ht,{className:"w-4 h-4"})]})})]})}const Wa="https://news-backend-production-ba81.up.railway.app",lr=({quote:s,author:t,role:r,avatar:a,rating:i})=>e.jsxs("div",{className:"p-6 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 shadow-md hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"flex gap-1 mb-3",children:[...Array(i)].map((n,o)=>e.jsx(yi,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"},o))}),e.jsxs("p",{className:"text-sm italic text-slate-600 dark:text-slate-300 mb-4 leading-relaxed",children:['"',s,'"']}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:a}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-white",children:t}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:r})]})]})]}),za=()=>{const s=De(),t=ne(O=>O.user),[r,a]=b.useState("url"),[i,n]=b.useState(""),[o,l]=b.useState(""),[c,d]=b.useState(null),[u,m]=b.useState(!1),[p,h]=b.useState(""),[x,g]=b.useState(!1),[f,y]=b.useState(!1),[k,w]=b.useState(null),[v,S]=b.useState(null),[_,E]=b.useState(!1),[$,T]=b.useState(0),[P,q]=b.useState(!1),N=1,R=b.useRef(null),V=b.useRef(null),W=1e4,K=[".pdf",".docx",".txt",".doc"],be=10*1024*1024;b.useEffect(()=>{if(Z(),!F)return;const{data:O}=F.auth.onAuthStateChange((J,re)=>{if(re?.user){S(re.user.id),E(!0);const It=`${re.user.id}:${new Date().toISOString().slice(0,10)}`,os=localStorage.getItem(`dailyScanCount:${It}`);T(os&&parseInt(os,10)||0)}else S(null),E(!1),T(0)});return()=>{O.subscription.unsubscribe()}},[]);const Z=async()=>{if(!F){h("System configuration error: Auth unavailable.");return}try{const{data:{session:O}}=await F.auth.getSession();if(O?.user){S(O.user.id),E(!0);const J=`${O.user.id}:${new Date().toISOString().slice(0,10)}`,re=localStorage.getItem(`dailyScanCount:${J}`);T(re&&parseInt(re,10)||0)}else E(!1),T(0)}catch(O){console.error("Auth check error:",O)}},X=(t?.plan||"free").toLowerCase()==="free",ce=_&&X&&$>=N,A=O=>{const J=`${O}:${new Date().toISOString().slice(0,10)}`,re=Math.min(N,(parseInt(localStorage.getItem(`dailyScanCount:${J}`)||"0",10)||0)+1);localStorage.setItem(`dailyScanCount:${J}`,String(re)),T(re)};b.useEffect(()=>{const O=J=>{J.clientY<=0&&!P&&_&&X&&$<N&&q(!0)};return document.addEventListener("mouseleave",O),()=>document.removeEventListener("mouseleave",O)},[P,$,_,X]);const M=O=>{try{return new URL(O),!0}catch{return!1}},C=O=>{const J="."+O.name.split(".").pop()?.toLowerCase();return K.includes(J)?O.size>be?{valid:!1,error:"File size exceeds 10MB limit."}:{valid:!0}:{valid:!1,error:"Unsupported format. PDF, DOC, DOCX, or TXT only."}},I=O=>{const J=O.target.files?.[0];G(J)},G=O=>{if(O){const J=C(O);if(!J.valid){h(J.error||"Validation failed"),z.error(J.error);return}d(O),h(""),z.success("File attached successfully"),y(!0),setTimeout(()=>y(!1),800)}},Q=b.useCallback(O=>{O.preventDefault(),g(!0)},[]),he=b.useCallback(O=>{O.preventDefault(),g(!1)},[]),dt=b.useCallback(O=>{O.preventDefault(),g(!1);const J=Array.from(O.dataTransfer.files);J.length>0&&G(J[0])},[]),Ln=O=>{const J=O.target.value;if(n(J),!J.trim()){w(null);return}w(M(J))},sa=async()=>{try{if(h(""),!F){h("System configuration error: Supabase not initialized"),z.error("System configuration error");return}const{data:{session:O},error:J}=await F.auth.getSession();if(J||!O||!O.access_token){h("Please sign in to run analysis"),z.error("Please sign in to run analysis"),s("/login");return}if(X&&$>=N){h("Daily limit reached for free accounts (1 per day)."),z.error("Daily limit reached (1/day). Upgrade for more.");return}if(!O.user?.id){h("Unable to retrieve user information, please sign in again"),z.error("Unable to retrieve user information, please sign in again"),s("/login");return}let re={userId:O.user.id};if(r==="url"){if(!i.trim()||!M(i)){h("Please enter a valid URL");return}re.url=i.trim()}else if(r==="file"){if(!c){h("Please upload a file");return}try{const oe=await c.text();re.text=`Document: ${c.name}

${oe}`}catch{re.text=`Analyze this document: ${c.name}`}}else if(r==="text"){if(!o.trim()){h("Please enter content to analyze");return}re.text=o.trim()}m(!0);try{await fetch(`${Wa}/api/auth/register`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${O.access_token}`},body:JSON.stringify({supabaseId:O.user.id,email:O.user.email})})}catch(oe){console.log(" User registration/sync failed (might already exist):",oe)}let It=0;try{const{data:oe}=await F.from("users").select("scans_used_this_month").eq("id",O.user.id).single();It=oe?.scans_used_this_month||0}catch(oe){console.warn(" Could not fetch scan count, defaulting to 0:",oe),It=0}const os=`${Wa}/api/analyze`,ut=await fetch(os,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${O.access_token}`},body:JSON.stringify({...re,analysesUsed:It})});if(!ut.ok){let oe="Analysis service unavailable.";try{const Hs=await ut.json();oe=Hs?.error||Hs?.message||oe}catch{console.error("Failed to parse error response")}throw ut.status===401?oe="Backend unable to authenticate user. Please contact administrator.":ut.status===402?oe="Credit limit reached. Please upgrade plan.":ut.status===429&&(oe="Rate limit exceeded. Try again shortly."),new Error(oe)}const Un=(await ut.json()).data;try{const oe={...Un,sourceType:r,sourceText:re.text||re.url||"",timestamp:new Date().toISOString(),userId:O.user.id,sessionId:`analysis_${Date.now()}`,version:"2.0",originalRequest:{type:r,value:re.text||re.url||re.file?.name}};sessionStorage.setItem("analysisResult",JSON.stringify(oe))}catch(oe){console.error(" Failed to persist to session storage:",oe)}X&&O.user?.id&&A(O.user.id),z.success("Intelligence Protocol Complete"),s("/results")}catch(O){console.error("Analyze error:",O);const J=O.message||"Analysis service temporarily unavailable";h(J),z.error(J)}finally{m(!1)}};return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-gray-950 text-slate-900 dark:text-slate-100 font-inter",children:[P&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl max-w-md w-full p-8 relative animate-in zoom-in-95 duration-300",children:[e.jsx("button",{onClick:()=>q(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors",children:e.jsx(St,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-center",children:[e.jsx(fe,{className:"w-16 h-16 text-orange-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-3",children:"Don't Miss Your Advantage!"}),e.jsxs("p",{className:"text-slate-600 dark:text-slate-300 mb-4 leading-relaxed",children:["You have ",e.jsx("strong",{children:"1 free analysis remaining"}),". Most users who leave without analyzing miss hidden signals that cost them ",e.jsx("strong",{children:"$10,000+"})," in bad decisions."]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6",children:"Upgrade now and avoid market risks  limited time 20% discount."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>{q(!1),window.scrollTo({top:0,behavior:"smooth"})},className:"w-full px-6 py-3 bg-gradient-to-r from-indigo-600 to-violet-600 text-white rounded-lg font-semibold hover:shadow-lg transition-all",children:"Use My Free Analysis Now"}),e.jsx("button",{onClick:()=>s("/pricing"),className:"w-full px-6 py-3 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors",children:"Upgrade Immediately"}),e.jsx("button",{onClick:()=>q(!1),className:"w-full px-6 py-3 text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white text-sm transition-colors",children:"I'll risk it"})]})]})]})}),e.jsx("nav",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-8 mb-8",children:e.jsxs("button",{onClick:()=>s("/"),className:"group flex items-center gap-2 text-sm font-semibold text-slate-500 dark:text-slate-300 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors",children:[e.jsx("div",{className:"p-1 rounded-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 group-hover:border-indigo-200 dark:group-hover:border-indigo-500 shadow-sm",children:e.jsx(At,{className:"w-4 h-4"})}),"Return to Dashboard"]})}),e.jsx("section",{className:"bg-gradient-to-b from-white to-slate-50 dark:from-slate-900 dark:to-slate-950",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pb-20",children:[e.jsx("section",{className:"relative bg-gradient-to-b from-slate-50 via-white to-slate-100 dark:from-slate-900 dark:via-slate-900 dark:to-slate-800 overflow-hidden rounded-3xl mb-12",children:e.jsxs("div",{className:"text-center max-w-3xl mx-auto relative z-10 py-10",children:[e.jsxs("h1",{className:"text-5xl sm:text-6xl lg:text-7xl font-extrabold tracking-tight text-slate-900 dark:text-white mb-6 leading-tight",children:["News is manipulating your decisions  ",e.jsx("br",{className:"hidden md:block"}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-red-600 to-orange-600",children:"miss this, lose 20% advantage."})]}),e.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-300 leading-relaxed",children:"Narrative framing silently shapes beliefs, decisions, and market behavior  often before facts catch up. Uncover hidden manipulation before it costs you."})]})}),e.jsx("div",{className:"my-24 relative",children:e.jsx("div",{className:"absolute inset-x-0 top-1/2 h-px bg-gradient-to-r from-transparent via-slate-300/40 dark:via-slate-700/40 to-transparent"})}),e.jsxs("div",{className:"mb-6 bg-amber-50 dark:bg-amber-900/20 border-2 border-amber-200 dark:border-amber-700 rounded-xl p-5 flex gap-3 shadow-md",children:[e.jsx(fe,{className:"text-amber-600 dark:text-amber-400 w-6 h-6 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-800 dark:text-amber-200",children:[e.jsx("strong",{className:"font-bold",children:"Headlines are optimized to influence  not inform."}),e.jsx("br",{}),"Unchecked narratives distort judgment over time. Most readers follow the path laid out for them without realizing it. Missing analysis could mean missing warnings that cost $10,000+."]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900/70 rounded-xl shadow-xl border border-slate-200 dark:border-slate-800 overflow-hidden relative backdrop-blur-lg",children:[e.jsx("div",{className:"bg-slate-50/50 dark:bg-slate-900/50 border-b border-slate-200 dark:border-slate-800 p-2",children:e.jsx("div",{className:"flex p-1 bg-slate-200/50 dark:bg-slate-800/50 rounded-xl",children:[{id:"url",label:"News URL",icon:Fr},{id:"file",label:"Document Upload",icon:Jn},{id:"text",label:"Raw Text",icon:Yn}].map(O=>e.jsxs("button",{onClick:()=>a(O.id),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-lg text-sm font-bold transition-all duration-200 ${r===O.id?"bg-white dark:bg-slate-900 text-indigo-600 dark:text-indigo-300 shadow-md":"text-slate-500 dark:text-slate-300 hover:bg-slate-200/50 dark:hover:bg-slate-800/50"}`,children:[e.jsx(O.icon,{size:16}),O.label]},O.id))})}),e.jsxs("div",{className:"p-8 md:p-12",children:[r==="url"&&e.jsxs("div",{className:"animate-in fade-in duration-300",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-3",children:"Target Source"}),e.jsx(gu,{value:i,onChange:O=>Ln({target:{value:O}}),placeholder:"Paste article URL  reveal hidden manipulation, e.g., https://cnn.com/article",onSubmit:sa,isLoading:u,disabled:!_||ce,isValid:!!k}),e.jsxs("p",{className:"mt-3 text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1",children:[e.jsx(pe,{size:12})," Supports paywalled sites & standard news outlets."]}),_&&X&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("p",{className:"text-xs font-semibold text-slate-600 dark:text-slate-300 mb-1",children:["Daily limit: ",$,"/",N]}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 font-medium",children:"Free shows surface only  upgrade to reveal full risks and avoid losses."})]})]}),r==="file"&&e.jsxs("div",{className:"animate-in fade-in duration-300",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-3",children:"Upload Intelligence Asset"}),e.jsxs("div",{className:`border-3 border-dashed rounded-2xl p-12 text-center transition-all cursor-pointer ${x?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":c?"border-emerald-500 bg-emerald-50/30":"border-slate-200 dark:border-slate-700 hover:border-indigo-400"}`,onDragOver:Q,onDragLeave:he,onDrop:dt,onClick:()=>R.current?.click(),children:[e.jsx("input",{ref:R,type:"file",className:"hidden",accept:".pdf,.docx,.txt",onChange:I}),f?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(qe,{className:"w-12 h-12 text-indigo-600 animate-spin mb-4"}),e.jsx("p",{className:"text-indigo-900 font-semibold",children:"Scanning document structure..."})]}):c?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 text-emerald-600 rounded-2xl flex items-center justify-center mb-4",children:e.jsx(Le,{size:32})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-1",children:c.name}),e.jsx("p",{className:"text-sm text-emerald-600 mb-4",children:"Ready for analysis"}),e.jsx("button",{onClick:O=>{O.stopPropagation(),d(null)},className:"text-xs text-slate-400 hover:text-red-500 hover:underline",children:"Remove file"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(Xn,{size:32})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-2",children:"Drop document here, or click to browse"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Supports PDF, DOCX, and TXT (Max 10MB)"})]})]}),_&&X&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"text-xs font-semibold text-slate-600 dark:text-slate-300 mb-1",children:["Daily limit: ",$,"/",N]}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Free tier shows surface signals only. ",e.jsx("strong",{children:"Consequences remain hidden."})]})]})]}),r==="text"&&e.jsxs("div",{className:"animate-in fade-in duration-300",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-3",children:"Raw Intelligence Data"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{ref:V,className:"block w-full p-4 bg-slate-50 dark:bg-slate-900 border-2 border-slate-200 dark:border-slate-700 rounded-xl text-slate-900 dark:text-slate-100 placeholder-slate-400 focus:outline-none focus:border-indigo-500 transition-all font-mono text-sm min-h-[200px] resize-y",placeholder:"Paste article text, press releases, or earnings call transcripts here...",value:o,onChange:O=>l(O.target.value),maxLength:W}),e.jsxs("div",{className:"absolute bottom-3 right-3 text-xs text-slate-400 bg-slate-50 dark:bg-slate-900 px-2 py-1 rounded border border-slate-200 dark:border-slate-700 font-mono",children:[o.length,"/",W]})]}),_&&X&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"text-xs font-semibold text-slate-600 dark:text-slate-300 mb-1",children:["Daily limit: ",$,"/",N]}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Free tier shows surface signals only. ",e.jsx("strong",{children:"Consequences remain hidden."})]})]})]}),p&&e.jsxs("div",{className:"mt-6 p-4 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700 rounded-xl flex items-start gap-3",children:[e.jsx(qr,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("div",{className:"text-sm text-red-700 dark:text-red-300 font-medium",children:p})]}),!_&&e.jsxs("div",{className:"mt-6 p-4 bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-700 rounded-xl flex items-start gap-3",children:[e.jsx(pe,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-amber-800 dark:text-amber-300",children:"Authentication Required"}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:"You must be logged in to run the analysis protocol."})]})]}),_&&X&&e.jsx("div",{className:"mt-6 p-4 bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-700 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Te,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-indigo-800 dark:text-indigo-300 mb-1",children:"Pro Analysis Reveals More"}),e.jsx("p",{className:"text-xs text-indigo-700 dark:text-indigo-300 leading-relaxed",children:"For just $9/month, get incentive chains, power dynamics, and downstream impact analysis  free tier can't access these critical insights."})]})]})}),e.jsx("div",{className:"mt-6 bg-slate-900 dark:bg-slate-800 text-slate-100 rounded-xl p-5 text-sm border border-slate-700",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ne,{className:"w-5 h-5 text-indigo-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("strong",{className:"font-bold text-white",children:"Why this matters:"}),e.jsx("p",{className:"mt-1 text-slate-300 leading-relaxed",children:"One misjudgment can cost you $10,000+  NexVeris helps you avoid that risk in advance."})]})]})}),e.jsxs("div",{className:"mt-8",children:[e.jsx("button",{onClick:sa,disabled:u||!_||ce,className:`w-full py-4 px-6 rounded-xl font-bold text-lg shadow-lg flex items-center justify-center gap-3 transition-all transform active:scale-[0.99] ${u||!_||ce?"bg-slate-100 text-slate-400 cursor-not-allowed shadow-none":"bg-gradient-to-r from-indigo-600 to-violet-600 text-white hover:shadow-indigo-500/30 hover:-translate-y-0.5"}`,children:u?e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"animate-spin"}),"Running Intelligence Protocol..."]}):ce?e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"w-5 h-5"}),"Upgrade to Avoid Risks"]}):X?e.jsx(e.Fragment,{children:"Avoid Risks  Analyze Now"}):e.jsx(e.Fragment,{children:"Reveal Hidden Narrative Risks"})}),e.jsx("p",{className:"text-center text-xs text-slate-400 dark:text-slate-500 mt-4",children:"By analyzing, you agree to our Terms of Service. Data is encrypted in transit."})]})]})]})]})}),e.jsx("section",{className:"py-16 bg-white dark:bg-slate-900",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-center text-slate-900 dark:text-white mb-4",children:"Join 5,000+ users who avoided hidden manipulation"}),e.jsx("p",{className:"text-center text-slate-600 dark:text-slate-400 mb-12",children:"Real outcomes from professionals using NexVeris daily"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[e.jsx(lr,{quote:"NexVeris helped me avoid a $10k loss  upgraded and now use it daily!",author:"John D.",role:"Investor",avatar:"",rating:5}),e.jsx(lr,{quote:"From free trial to paid in one day  the insights are too valuable to miss.",author:"Sarah L.",role:"Market Analyst",avatar:"",rating:5}),e.jsx(lr,{quote:"Limited-time opportunity pushed me to act  now I'm ahead of the market.",author:"Mike R.",role:"Risk Manager",avatar:"",rating:5})]})]})})]})},pu=s=>{const t=s?.score;return t==null?"Signal strength cannot be assessed from available information.":t>=8?"High-signal development. Treat as actionable and time-sensitive.":t>=6?"Meaningful signal. Direction is forming, but not fully confirmed.":t>=4?"Low-to-moderate signal. Monitor, but avoid over-committing.":"Weak signal. Treat this as noise until corroborated."},bu=(s,t)=>s==null||t==null?"Credibility cannot be assessed due to insufficient data.":s>=80&&t<30?"Fact-led reporting with minimal narrative pressure.":s>=60?"Broadly factual, but framing signals are present. Use with caution.":"High framing risk. Do not treat this as objective reporting.",yu=s=>{if(!s)return"Macro drivers (external forces like politics or economy) cannot be assessed from available information.";const t=Object.entries(s).map(([o,l])=>({key:o,score:Number(l?.score??0)})).filter(o=>Number.isFinite(o.score)).sort((o,l)=>l.score-o.score);if(!t.length)return"No dominant macro pressure (external influences) detected.";const r=t[0],a=t[1],i={political:"political/regulatory (government rules)",economic:"economic (money and markets)",social:"social (people and culture)",technological:"technology (innovation)",legal:"legal (laws)",environmental:"environmental (nature and sustainability)"},n=i[r.key]??r.key;if(a&&a.score>=40){const o=i[a.key]??a.key;return`Primary driver: ${n}. Secondary spillover: ${o}. These are key external forces affecting the story.`}return`Primary driver: ${n}. This is the main external force at play.`},wu=s=>{const t=s?.incentiveStack;if(!t)return"Narrative intent cannot be determined from available information.";const r=Object.entries(t).map(([l,c])=>{const d=typeof c=="number"?c:typeof c?.score=="number"?c.score:Number(c??0);return{key:l,score:Number(d)}}).filter(l=>Number.isFinite(l.score)).sort((l,c)=>c.score-l.score),a=r[0],i=r[1];if(!a||a.score<40)return"No clear narrative intent signal detected.";const n={economic:"economic positioning",politicalSignaling:"political signaling",socialPositioning:"social positioning",ideologicalControl:"belief shaping"},o=n[a.key]??a.key;if(i&&i.score>=40){const l=n[i.key]??i.key;return`Primary intent: ${o}. Secondary: ${l}.`}return`Primary intent: ${o}.`},vu=s=>s?"Power is concentrated. Focus on high-influence actors and their constraints.":"Stakeholder power cannot be assessed from available information.",ju=s=>{if(!s)return"Market read-through cannot be assessed from available information.";const t=String(s).toLowerCase();return t.includes("bull")?"Market read-through skews positive. Watch beneficiaries and positioning.":t.includes("bear")?"Market read-through skews negative. Prioritize risk controls and downside paths.":t.includes("neutral")?"Market read-through is mixed. Timing matters more than direction.":"Market read-through is unclear. Validate with price action and confirmed tickers."},Va=(...s)=>{const t=s.filter(Boolean).length,r=["Forward trajectory cannot be assessed from available information.","Partial forward signal only. Treat as scenario-building, not a forecast.","Direction is forming, but uncertainty remains. Monitor next catalysts.","Base case: gradual progression with feedback risk. Track updates and second-order effects."];return r[t]||r[0]},Be={Capital:{color:"#10B981",icon:to,label:"Capital Power"},Platform:{color:"#3B82F6",icon:Je,label:"Platform Power"},State:{color:"#EF4444",icon:eo,label:"State Power"},Media:{color:"#F59E0B",icon:Zn,label:"Media Power"}},ku=(s,t)=>{const r=s.toLowerCase();return r.includes("google")||r.includes("alphabet")?"":r.includes("meta")||r.includes("facebook")?"":r.includes("amazon")?"":r.includes("apple")?"":r.includes("microsoft")?"":r.includes("tesla")?"":r.includes("nvidia")?"":r.includes("berkshire")?"":r.includes("twitter")||r.includes("x corp")?"":r.includes("cnn")||r.includes("news")?"":r.includes("times")||r.includes("post")?"":r.includes("bloomberg")?"":r.includes("reuters")?"":r.includes("federal")||r.includes("government")?"":r.includes("congress")||r.includes("senate")?"":r.includes("treasury")?"":r.includes("fed")||r.includes("reserve")?"":t==="Capital"?"":t==="Platform"?"":t==="State"?"":t==="Media"?"":""},Nu=({actors:s,className:t=""})=>{const[r,a]=b.useState(null),[i,n]=b.useState(null),o=h=>{switch(h){case"State":return["Executive Authority","Diplomatic Pressure","Legal Leverage"];case"Platform":return["Platform Reach","Moderation Leverage","Algorithmic Prioritization"];case"Capital":return["Capital Allocation","Investment Signalling","Credit Access"];case"Media":return["Agenda Setting","Editorial Framing","Network Amplification"];default:return[]}},l=h=>{switch(h){case"State":return"Global (State-level)";case"Platform":return"Global (Platform-level)";case"Capital":return"Markets (Capital-level)";case"Media":return"Media Ecosystem";default:return"General"}},c=h=>{switch(h){case"State":return["Executive statements","Diplomatic escalation"];case"Platform":return["Algorithmic boosts","Content moderation"];case"Capital":return["Funding allocation","Policy lobbying"];case"Media":return["Narrative promotion","Investigative framing"];default:return[]}},d=h=>{switch(h){case"Supportive":return"text-emerald-700 dark:text-emerald-300";case"Confrontational":return"text-rose-700 dark:text-rose-300";case"Defensive":return"text-amber-700 dark:text-amber-300";default:return"text-slate-700 dark:text-slate-300"}};if(!s||s.length===0)return e.jsxs("div",{className:"bg-slate-100 dark:bg-slate-900/40 rounded-xl p-10 text-center border border-slate-200 dark:border-slate-800",children:[e.jsx(Qn,{className:"w-12 h-12 text-slate-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"No Amplification Detected"}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 max-w-md mx-auto leading-relaxed",children:["Our analysis did not identify any dominant actors actively amplifying or shaping this narrative beyond baseline information flow.",e.jsx("br",{}),e.jsx("br",{}),"This typically indicates a low coordination environment, organic discourse, or early-stage narrative formation."]})]});const m=[...s].sort((h,x)=>h.isInferred&&!x.isInferred?1:!h.isInferred&&x.isInferred?-1:x.incentiveAlignment+x.distributionPower-(h.incentiveAlignment+h.distributionPower)).slice(0,6),p=h=>s.filter(x=>x.category===h.category&&x.name!==h.name).slice(0,4);return e.jsxs("div",{className:`${t}`,children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:m.map((h,x)=>{const g=Be[h.category]||Be.Capital,f=p(h),y=i===h.name,k=r?.name===h.name,w=(h.incentiveAlignment+h.distributionPower)/2;h.isInferred;const v=h.isInferred?.6:1;return e.jsx(B.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:x*.1},className:"relative",children:e.jsxs(B.div,{className:`relative bg-white dark:bg-slate-900/80 rounded-2xl p-6 border-2 transition-all cursor-pointer ${k||y?"border-blue-500 shadow-2xl shadow-blue-500/20":h.isInferred?"border-slate-200 dark:border-slate-700 border-dashed hover:border-slate-300 dark:hover:border-slate-600":"border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600"}`,onClick:()=>a(k?null:h),onMouseEnter:()=>n(h.name),onMouseLeave:()=>n(null),whileHover:{scale:1.02},children:[e.jsxs("div",{className:"relative w-full aspect-square mb-4",children:[e.jsxs("svg",{viewBox:"0 0 200 200",className:"w-full h-full",children:[e.jsx("circle",{cx:"100",cy:"100",r:"85",fill:"rgba(148,163,184,0.15)",stroke:"rgba(148,163,184,0.35)",strokeWidth:"1",className:"dark:fill-[rgba(30,41,59,0.6)] dark:stroke-[rgba(71,85,105,0.3)]"}),e.jsx("circle",{cx:"100",cy:"100",r:"85",fill:"none",stroke:g.color,strokeWidth:"20",strokeDasharray:`${w/100*534} 534`,strokeDashoffset:"0",transform:"rotate(-90 100 100)",opacity:v}),h.isInferred&&e.jsx("circle",{cx:"100",cy:"100",r:"85",fill:"none",stroke:"rgba(255,255,255,0.3)",strokeWidth:"1",strokeDasharray:"4 4"}),e.jsx("circle",{cx:"100",cy:"100",r:"60",fill:"rgba(148,163,184,0.25)",stroke:g.color,strokeWidth:"2",opacity:"0.6",className:"dark:fill-[rgba(30,41,59,0.8)]"}),e.jsx("text",{x:"100",y:"110",fontSize:"48",textAnchor:"middle",dominantBaseline:"middle",children:ku(h.name,h.category)}),f.map((S,_)=>(_/Math.max(f.length,4)*2*Math.PI,e.jsx("g",{},S.name)))]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx(B.div,{className:"text-center",initial:{opacity:0},animate:{opacity:y||k?1:0},children:e.jsxs("div",{className:"bg-white/85 dark:bg-slate-950/90 rounded-lg px-3 py-1 backdrop-blur-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:Math.round(w)}),e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Power"})]})})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white text-sm line-clamp-2 flex-1",children:h.name}),h.isInferred&&e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-bold bg-slate-100 text-slate-600 border border-slate-300 dark:bg-slate-800 dark:text-slate-400 dark:border-slate-600",children:"AI INFERRED"})]}),e.jsxs("div",{className:"text-[11px] text-slate-600 dark:text-slate-400",children:["Primary Influence: ",h.influenceScope||l(h.category)]}),e.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1",children:(h.channels&&h.channels.length>0?h.channels:o(h.category)).slice(0,3).map((S,_)=>e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-semibold bg-slate-100 text-slate-700 border border-slate-200 dark:bg-slate-800 dark:text-slate-200 dark:border-slate-700",children:S},_))}),h.stance&&e.jsxs("div",{className:`text-[11px] mt-1 font-semibold ${d(h.stance)}`,children:["Narrative Stance: ",h.stance]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded p-2 dark:bg-slate-800/50 dark:border-slate-700",children:[e.jsx("div",{className:"text-slate-500 dark:text-slate-400 mb-1",children:"Incentive"}),e.jsxs("div",{className:"font-semibold text-slate-900 dark:text-white",children:[h.incentiveAlignment,"%"]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded p-2 dark:bg-slate-800/50 dark:border-slate-700",children:[e.jsx("div",{className:"text-slate-500 dark:text-slate-400 mb-1",children:"Distribution"}),e.jsxs("div",{className:"font-semibold text-slate-900 dark:text-white",children:[h.distributionPower,"%"]})]})]}),e.jsxs("div",{className:"text-[11px] text-slate-600 dark:text-slate-400",children:["Evidence Basis: ",h.evidenceBasis||(h.isInferred?"Inferred":h.source||"Explicit")]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("div",{className:"text-[11px] text-slate-600 dark:text-slate-400 font-semibold",children:"Likely Actions:"}),e.jsx("ul",{className:"mt-0.5 space-y-0.5",children:(h.actionVector&&h.actionVector.length>0?h.actionVector:c(h.category)).slice(0,3).map((S,_)=>e.jsxs("li",{className:"text-[11px] text-slate-700 dark:text-slate-300",children:[" ",S]},_))})]})]})]})},h.name)})}),e.jsx(ye,{children:r&&e.jsx(B.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-6 overflow-hidden",children:e.jsxs("div",{className:"bg-white dark:bg-gradient-to-br dark:from-slate-900 dark:to-slate-800 rounded-xl p-6 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-1",children:r.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold",style:{backgroundColor:`${Be[r.category].color}20`,color:Be[r.category].color},children:Be[r.category].label}),r.isInferred&&e.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold bg-slate-100 text-slate-600 border border-slate-300 dark:bg-slate-700 dark:text-slate-300 dark:border-slate-600",children:"Synthesized by AI"})]})]}),e.jsx("button",{onClick:()=>a(null),className:"text-slate-500 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white transition-colors",children:""})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-4 dark:bg-slate-800/50 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Te,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),e.jsx("h4",{className:"text-sm font-semibold text-slate-900 dark:text-slate-300",children:"Incentive Alignment"})]}),e.jsxs("div",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-1",children:[r.incentiveAlignment,"%"]}),e.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full transition-all",style:{width:`${r.incentiveAlignment}%`,backgroundColor:Be[r.category].color}})})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-4 dark:bg-slate-800/50 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(so,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"}),e.jsx("h4",{className:"text-sm font-semibold text-slate-900 dark:text-slate-300",children:"Distribution Power"})]}),e.jsxs("div",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-1",children:[r.distributionPower,"%"]}),e.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full transition-all",style:{width:`${r.distributionPower}%`,backgroundColor:Be[r.category].color}})})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-4 dark:bg-slate-800/50 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"}),e.jsx("h4",{className:"text-sm font-semibold text-slate-900 dark:text-slate-300",children:"Total Influence"})]}),e.jsxs("div",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-1",children:[Math.round((r.incentiveAlignment+r.distributionPower)/2),"%"]}),e.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full transition-all",style:{width:`${(r.incentiveAlignment+r.distributionPower)/2}%`,backgroundColor:Be[r.category].color}})})]})]}),r.evidence&&r.evidence.length>0&&e.jsx("div",{className:"mt-4 p-4 bg-white border border-slate-200 rounded-lg dark:bg-slate-950/50 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Le,{className:"w-4 h-4 text-slate-500 dark:text-slate-400 mt-1"}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-slate-900 dark:text-slate-300 mb-2",children:"Evidence for Inclusion"}),e.jsx("ul",{className:"list-disc list-inside text-xs text-slate-600 dark:text-slate-400 space-y-1",children:r.evidence.map((h,x)=>e.jsx("li",{children:h},x))})]})]})})]})})}),e.jsxs("div",{className:"mt-6 flex flex-wrap justify-between items-center bg-white dark:bg-slate-900/50 rounded-xl p-4 border border-slate-200 dark:border-slate-800",children:[e.jsx("div",{className:"flex gap-4",children:Object.entries(Be).map(([h,x])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:x.color}}),e.jsx("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:x.label})]},h))}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 sm:mt-0",children:[e.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-slate-600 dark:text-slate-500 uppercase font-bold tracking-wider",children:[e.jsx("span",{className:"w-2 h-2 border border-slate-400 dark:border-slate-500 rounded-full"})," Explicit"]}),e.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-slate-600 dark:text-slate-500 uppercase font-bold tracking-wider",children:[e.jsx("span",{className:"w-2 h-2 border border-slate-400 dark:border-slate-500 border-dashed rounded-full"})," AI Inferred"]})]})]})]})},Mt={"Linguistic Neutrality":"Linguistic","Sourcing Depth":"Sourcing","Logic Consistency":"Logic","Editorial Distance":"Editorial","Attribution Quality":"Attribution"},As=({credibilityData:s,className:t=""})=>{const r=s||{manipulationScore:0,credibilityScore:0,biasIndicators:[],factors:[]},a=b.useMemo(()=>[{subject:Mt["Linguistic Neutrality"],fullName:"Linguistic Neutrality",A:100-r.manipulationScore*.8,fullMark:100},{subject:Mt["Sourcing Depth"],fullName:"Sourcing Depth",A:r.credibilityScore,fullMark:100},{subject:Mt["Logic Consistency"],fullName:"Logic Consistency",A:Math.max(30,100-r.biasIndicators.length*10),fullMark:100},{subject:Mt["Editorial Distance"],fullName:"Editorial Distance",A:100-r.manipulationScore,fullMark:100},{subject:Mt["Attribution Quality"],fullName:"Attribution Quality",A:r.factors.find(n=>n.name.includes("Source"))?.score||50,fullMark:100}],[r]);return e.jsxs("div",{className:`w-full bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6 ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-600/10 rounded-lg text-indigo-600",children:e.jsx(ro,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-black uppercase tracking-tighter text-slate-900 dark:text-white",children:"Language & Bias Analysis"}),e.jsx("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-widest",children:"How wording influences perception"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-xl font-black ${r.manipulationScore>50?"text-red-500":"text-emerald-500"}`,children:[r.manipulationScore,"%"]}),e.jsx("div",{className:"text-[10px] text-slate-400 font-bold uppercase",children:"Distortion Index"})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 items-start",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-[380px] w-full flex items-center justify-center bg-slate-50 dark:bg-slate-950 rounded-xl border border-slate-200 dark:border-slate-800",children:e.jsxs(Ti,{width:400,height:380,cx:200,cy:190,outerRadius:100,data:a,margin:{top:50,right:50,bottom:50,left:50},children:[e.jsx(Ci,{stroke:"#94a3b8",strokeOpacity:.2}),e.jsx(Ai,{dataKey:"subject",tick:{fill:"#64748b",fontSize:11,fontWeight:600}}),e.jsx(_s,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.95)",border:"1px solid #334155",borderRadius:"8px",fontSize:"12px"},formatter:(i,n,o)=>{const l=o.payload.fullName;return[`${i.toFixed(0)}%`,l]}}),e.jsx(br,{name:"Article Fingerprint",dataKey:"A",stroke:"#4f46e5",fill:"#4f46e5",fillOpacity:.4})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-[10px]",children:a.map((i,n)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500"}),e.jsxs("span",{className:"text-slate-600 dark:text-slate-400",children:[e.jsx("strong",{className:"text-slate-900 dark:text-white",children:i.subject})," = ",i.fullName]})]},n))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-950 p-4 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsxs("h4",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[e.jsx(Ue,{className:"w-3 h-3"})," Visual Distortion Markers"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Emotional Framing"}),e.jsx("div",{className:"w-24 h-1.5 bg-slate-200 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-indigo-500",style:{width:`${r.manipulationScore}%`}})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Confirmation Bias"}),e.jsx("div",{className:"w-24 h-1.5 bg-slate-200 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500",style:{width:`${Math.min(100,r.biasIndicators.length*20)}%`}})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Factual Density"}),e.jsx("div",{className:"w-24 h-1.5 bg-slate-200 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${r.credibilityScore}%`}})})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 p-3 rounded-lg border border-slate-200 dark:border-slate-800 text-center",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Verdict"}),e.jsx("div",{className:`text-xs font-black uppercase mt-1 ${r.manipulationScore>40?"text-orange-500":"text-emerald-500"}`,children:r.manipulationScore>40?"Tactical Push":"Objective Report"})]}),e.jsxs("div",{className:"flex-1 p-3 rounded-lg border border-slate-200 dark:border-slate-800 text-center",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Signals"}),e.jsxs("div",{className:"text-xs font-black text-slate-900 dark:text-white uppercase mt-1",children:[r.biasIndicators.length," Markers"]})]})]})]})]})]})},_u=Object.freeze(Object.defineProperty({__proto__:null,ManipulationScoreGauge:As,default:As},Symbol.toStringTag,{value:"Module"}));function qt({feature:s,children:t,canAccessOverride:r,isTrialAnalysis:a=!1}){const{canAccess:i,loading:n,getUpgradeMessage:o,getUpgradeCTA:l}=ct();return n?e.jsx("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40 p-6 text-sm text-slate-400",children:"Loading access"}):(r?r(s):i(s))?e.jsx(e.Fragment,{children:t}):a&&(s==="market_impact_teaser"||s==="sentiment_teaser")?e.jsx(e.Fragment,{children:t}):e.jsxs("div",{className:"relative rounded-xl border border-dashed border-slate-300 dark:border-slate-700 overflow-hidden",children:[e.jsx("div",{className:"blur-sm opacity-50 pointer-events-none",children:e.jsx("div",{className:"p-2",children:t})}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-slate-50/80 dark:bg-slate-900/70 p-8 text-center",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(pe,{className:"h-6 w-6 text-slate-500 dark:text-slate-400"})}),e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:o(s)}),e.jsx("button",{className:"inline-flex items-center justify-center rounded-md bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700 transition",onClick:()=>{window.location.href="/pricing"},"aria-label":"Upgrade to unlock this feature",children:l(s)})]})]})}function Su({strategyIntent:s}){if(!s)return e.jsx("div",{className:"p-6 text-sm text-slate-500",children:"Narrative intent data not available."});const t=s?.dominantDriver,r=s?.incentiveStack,a=s?.behavioralPattern,i=s?.powerAmplification?.actors||[],n=a?.framingTechniques?.length>0,o=a?.omissions?.length>0,l=a?.emotionalTriggers?.length>0;return e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-xl border border-blue-200 dark:border-slate-700 bg-gradient-to-br from-blue-50 to-slate-50 dark:bg-gradient-to-br dark:from-slate-800 dark:to-slate-900 p-6 shadow-md dark:shadow-black/40",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-5 dark:opacity-20",children:e.jsx(ot,{className:"w-20 h-20 text-blue-600 dark:text-blue-400"})}),e.jsx("p",{className:"mb-2 text-[11px] font-semibold uppercase tracking-wider text-blue-600 dark:text-blue-300",children:"Primary Narrative Driver"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("h3",{className:"text-2xl font-bold tracking-tight text-slate-900 dark:text-white",children:t?.type||"Undetermined"}),e.jsxs("span",{className:"rounded-md border border-blue-200 bg-blue-50 px-2.5 py-0.5 text-xs font-semibold text-blue-700 dark:border-blue-700 dark:bg-blue-900/40 dark:text-blue-200",children:["Confidence: ",t?.confidence??0,"%"]})]}),e.jsx("p",{className:"mt-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4 text-sm leading-relaxed text-slate-700 dark:text-slate-200",children:t?.explanation||"No explanation available."})]}),e.jsxs("details",{className:"rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900",children:[e.jsx("summary",{className:"cursor-pointer list-none select-none px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-1 w-1 rounded-full bg-blue-600"}),e.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-wider text-blue-700 dark:text-blue-400",children:"Why This Story Is Told This Way"}),e.jsx("span",{className:"text-xs text-slate-400",children:"(Advanced)"})]}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Click to expand"})]})}),e.jsx(qt,{feature:"hidden_motive_full",children:e.jsxs("div",{className:"px-6 pb-6 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-4 text-[11px] font-semibold uppercase tracking-wider text-slate-600 dark:text-slate-400",children:"Who Benefits From This Narrative"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[["Financial Interests",r?.economic],["Reputation & Positioning",r?.socialPositioning],["Political Influence",r?.politicalSignaling],["Ideological Messaging",r?.ideologicalControl]].map(([c,d])=>e.jsxs("div",{className:"rounded-lg border bg-white p-4 dark:bg-slate-900",children:[e.jsxs("div",{className:"mb-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-700 dark:text-slate-300",children:c}),e.jsxs("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:[d??0,"%"]})]}),e.jsx("div",{className:"h-1.5 rounded-full bg-slate-200 dark:bg-slate-800",children:e.jsx("div",{className:"h-full rounded-full bg-blue-500",style:{width:`${d??0}%`}})})]},c))})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/30 p-6",children:[e.jsxs("h4",{className:"mb-6 flex items-center gap-2 text-[11px] font-semibold uppercase tracking-wider text-blue-700 dark:text-blue-400",children:[e.jsx("span",{className:"h-1 w-1 rounded-full bg-blue-700 dark:bg-blue-400"}),"How the Story Is Framed"]}),!n&&!o&&!l?e.jsx("p",{className:"text-sm italic text-slate-500 dark:text-slate-400",children:"No notable behavioral framing patterns detected."}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"text-[11px] font-semibold uppercase tracking-wide text-blue-700 dark:text-blue-400",children:"Key Emphasis"}),e.jsx("ul",{className:"space-y-2 pl-4 text-sm leading-relaxed text-slate-700 dark:text-slate-300",children:a.framingTechniques.map((c,d)=>e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-500",children:""}),e.jsx("span",{children:c})]},d))})]}),o&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"text-[11px] font-semibold uppercase tracking-wide text-rose-700 dark:text-rose-400",children:"Missing Context"}),e.jsx("ul",{className:"space-y-2 pl-4 text-sm leading-relaxed text-slate-700 dark:text-slate-300",children:a.omissions.map((c,d)=>e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-rose-600 dark:text-rose-500",children:""}),e.jsx("span",{children:c})]},d))})]}),l&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"text-[11px] font-semibold uppercase tracking-wide text-amber-700 dark:text-amber-400",children:"Emotional Language"}),e.jsx("ul",{className:"space-y-2 pl-4 text-sm leading-relaxed text-slate-700 dark:text-slate-300",children:a.emotionalTriggers.map((c,d)=>e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-amber-600 dark:text-amber-500",children:""}),e.jsx("span",{children:c})]},d))})]})]})]}),s?.credibility&&e.jsx(As,{credibilityData:s.credibility}),e.jsx(Nu,{actors:i})]})})]})]})}const Eu=s=>{const t=String(s??"neutral").trim().toLowerCase();return["positive","supportive","pro"].includes(t)?"positive":["negative","opposition","opposed","anti"].includes(t)?"negative":["mixed","ambivalent","unclear"].includes(t)?"mixed":"neutral"},me={positive:{label:"Supportive",color:"#10B981",lightColor:"#D1FAE5",icon:ki,description:"Pushes for / supports the outcome"},negative:{label:"Opposition",color:"#EF4444",lightColor:"#FEE2E2",icon:ji,description:"Pushes against / opposes the outcome"},neutral:{label:"Neutral",color:"#6B7280",lightColor:"#F3F4F6",icon:ao,description:"Neither for nor against"},mixed:{label:"Mixed",color:"#F59E0B",lightColor:"#FEF3C7",icon:Te,description:"Variable stance / mixed signals"}},Ka="#6366F1",$r={manage_closely:{label:"Key Players",shortLabel:"Manage Closely",color:"#8B5CF6",bg:"bg-purple-50",icon:it,description:"High power  high interest  Can & will move outcomes. Engage closely."},keep_satisfied:{label:"Context Setters",shortLabel:"Keep Satisfied",color:"#3B82F6",bg:"bg-blue-50",icon:Ne,description:"High power  low interest  Can act but may not. Keep satisfied."},keep_informed:{label:"Active Observers",shortLabel:"Keep Informed",color:"#10B981",bg:"bg-emerald-50",icon:Ue,description:"Low power  high interest  Care deeply but limited influence. Inform & mobilize."},monitor:{label:"Crowd",shortLabel:"Monitor",color:"#6B7280",bg:"bg-gray-50",icon:Ns,description:"Low power  low interest  Limited impact. Monitor for changes."}},Ga=s=>{if(!s||s.length===0)return 0;const t=[...s].sort((a,i)=>a-i),r=Math.floor(t.length/2);return t.length%2===0?(t[r-1]+t[r])/2:t[r]},Ja=(s,t,r)=>r===t?50:(s-t)/(r-t)*100,Tu=(s,t,r)=>{const a=(s+t)/2,i=s>70?1.3:1,n=t>70?1.2:1,o=r==="negative"?1.3:r==="positive"?.9:r==="mixed"?1.1:1;return Math.min(100,a*i*n*o)},gs=s=>s>75?"#EF4444":s>50?"#F59E0B":s>25?"#3B82F6":"#10B981",Cu=(s,t,r,a)=>{const i=s>=r,n=t>=a;let o,l,c,d;return i&&n?(o="manage_closely",l="Engage closely with frequent, direct updates",c="This actor is critical. They have both the power to influence outcomes and the motivation to act. Engage them directly and frequently. Understand their concerns, address them proactively, and ensure they feel heard.",d="critical"):i&&!n?(o="keep_satisfied",l="Meet their needs but don't over-communicate",c="This actor can influence outcomes but may not be actively engaged. Ensure their basic needs are met to prevent opposition, but avoid overwhelming them with information that doesn't concern their interests.",d="high"):!i&&n?(o="keep_informed",l="Inform regularly to mobilize support",c="This actor cares deeply but has limited direct influence. Keep them well-informedthey can influence others indirectly, build coalitions, or shift public opinion. Empower them with information.",d="medium"):(o="monitor",l="Monitor for shifts in power or interest",c="This actor currently has limited influence and engagement. Monitor for changesif their power or interest increases, upgrade your engagement strategy accordingly.",d="low"),{quadrant:o,label:$r[o].label,action:l,communication:c,priority:d}},ps={vibrant:["#8B5CF6","#EC4899","#3B82F6","#10B981","#F59E0B","#EF4444","#6366F1","#14B8A6","#F97316","#A855F7"],pastel:["#DDD6FE","#FBCFE8","#BFDBFE","#D1FAE5","#FEF3C7","#FEE2E2","#E0E7FF","#CCFBF1","#FFEDD5","#F3E8FF"]},Au=s=>{const t=s%ps.vibrant.length,r=s%ps.pastel.length;return{dark:ps.vibrant[t],light:ps.pastel[r]}};function Pu({partyImpactData:s,className:t=""}){const[r,a]=b.useState(null),[i,n]=b.useState(null),[o,l]=b.useState(null),[c,d]=b.useState("all"),u=b.useMemo(()=>{if(!s?.stakeholders||s.stakeholders.length===0)return[];const g=s.stakeholders,f=g.map(_=>_.power),y=g.map(_=>_.interest);Ga(f),Ga(y);const k=Math.min(...f),w=Math.max(...f),v=Math.min(...y),S=Math.max(...y);return g.map((_,E)=>{const $=Ja(_.power,k,w),T=Ja(_.interest,v,S),P=Eu(_.sentiment),q=me[P]??me.neutral,N=Cu($,T,50,50),R=Tu($,T,P),V=($+T)/2,W=V,K=Au(E);return{id:`${_.name}-${E}`,name:_.name,power:$,interest:T,sentiment:P,sentimentColor:q.color,originalPower:_.power,originalInterest:_.interest,risk:R,role:_.role,color:K.dark,strategy:N,isWinner:s.majorWinners?.includes(_.name),isLoser:s.majorLosers?.includes(_.name),avgScore:V,dominance:W,uniqueColor:K.dark,uniqueLightColor:K.light}})},[s]),m=b.useMemo(()=>{const g={manage_closely:[],keep_satisfied:[],keep_informed:[],monitor:[]};return u.forEach(f=>{g[f.strategy.quadrant].push(f)}),g},[u]),p=b.useMemo(()=>{const g={positive:0,negative:0,neutral:0,mixed:0};return u.forEach(f=>{g[f.sentiment]++}),g},[u]),h=b.useMemo(()=>c==="all"?u:u.filter(g=>g.sentiment===c),[u,c]);b.useEffect(()=>{u.length>0&&!r&&a(u[0])},[u,r]);const x=({active:g,payload:f})=>{if(!g||!f?.[0])return null;const y=f[0].payload,k=me[y.sentiment]??me.neutral,w=k.icon;return e.jsxs("div",{className:"bg-white dark:bg-slate-900 border-2 rounded-lg shadow-2xl p-4 max-w-xs",style:{borderColor:y.uniqueColor},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:y.uniqueColor}}),e.jsx("h4",{className:"font-bold text-gray-900 dark:text-slate-100 text-sm",children:y.name})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-slate-400 mb-2",children:y.role}),e.jsxs("div",{className:"space-y-1.5 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-slate-400",children:"Power:"}),e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-slate-100",children:[y.power.toFixed(0),"/100"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-slate-400",children:"Interest:"}),e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-slate-100",children:[y.interest.toFixed(0),"/100"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500 dark:text-slate-400",children:"Sentiment:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"w-3 h-3",style:{color:y.sentimentColor}}),e.jsx("span",{className:"font-semibold",style:{color:y.sentimentColor},children:k.label})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-slate-400",children:"Risk:"}),e.jsxs("span",{className:"font-semibold",style:{color:gs(y.risk)},children:[y.risk.toFixed(0),"/100"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-slate-700",children:[e.jsx("p",{className:"text-[10px] text-gray-500 dark:text-slate-400 font-semibold uppercase tracking-wide mb-1",children:"Strategic Quadrant"}),e.jsx("p",{className:"text-xs font-bold",style:{color:y.color},children:y.strategy.label})]})]})};return!s||u.length===0?e.jsxs("div",{className:`bg-gray-50 dark:bg-slate-900/60 rounded-xl border border-gray-200 dark:border-slate-800 p-12 text-center ${t}`,children:[e.jsx(tt,{className:"w-12 h-12 text-gray-400 dark:text-slate-500 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600 dark:text-slate-400",children:"No stakeholder data available"})]}):e.jsxs("div",{className:`bg-white dark:bg-slate-900/60 rounded-xl border border-gray-200 dark:border-slate-800 shadow-xl overflow-hidden ${t}`,children:[e.jsx("div",{className:"p-6 bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-white/20 backdrop-blur-sm rounded-xl",children:e.jsx(we,{className:"w-7 h-7"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:"Faction Friction"}),e.jsx("p",{className:"text-sm text-blue-100 mt-0.5",children:"Who has the power  who cares  who's pushing for what"})]})]})}),e.jsx("div",{className:"p-6 bg-gray-50 dark:bg-slate-900/60 border-b border-gray-200 dark:border-slate-800",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-slate-400 uppercase",children:"Filter by Sentiment:"}),e.jsxs("button",{onClick:()=>d("all"),className:`px-3 py-1.5 rounded-full text-xs font-semibold transition-all ${c==="all"?"bg-gray-800 text-white shadow-md":"bg-white dark:bg-slate-900/60 text-gray-600 dark:text-slate-300 border border-gray-300 dark:border-slate-700"}`,style:{backgroundColor:c==="all"?Ka:void 0,color:c==="all"?"white":Ka},children:["All (",u.length,")"]}),Object.keys(me).map(g=>{const f=me[g],y=p[g],k=f.icon;return e.jsxs("button",{onClick:()=>d(g),className:`px-3 py-1.5 rounded-full text-xs font-semibold transition-all flex items-center gap-1.5 ${c===g?"shadow-md text-white":"bg-white dark:bg-slate-900/60 border border-gray-300 dark:border-slate-700"}`,style:{backgroundColor:c===g?f.color:void 0,color:c===g?"white":f.color},children:[e.jsx(k,{className:"w-3 h-3"}),f.label," (",y,")"]},g)})]})}),e.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-slate-900/60 border-b border-gray-200 dark:border-slate-800",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-400 dark:text-slate-400 uppercase tracking-wider mb-4",children:"Strategic Quadrants (Median-Based)"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.keys(m).map(g=>{const f=$r[g],y=m[g].length,k=f.icon;return e.jsxs(B.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},whileHover:{scale:1.02,y:-2},onMouseEnter:()=>l(g),onMouseLeave:()=>l(null),className:`${f.bg} dark:bg-slate-900/60 border-2 ${o===g?"border-gray-400 dark:border-slate-600":"border-transparent"} p-4 rounded-lg transition-all cursor-pointer`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-white dark:bg-slate-800 rounded-lg shadow-sm",children:e.jsx(k,{className:"w-5 h-5",style:{color:f.color}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-slate-200",children:f.label}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-slate-400 font-medium",children:[y," stakeholder",y!==1?"s":""]})]})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-slate-300 leading-relaxed",children:f.description})]},g)})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row min-h-[600px]",children:[e.jsx("div",{className:"lg:w-2/3 p-5 border-r border-gray-100 dark:border-slate-800",children:e.jsx("div",{className:"flex items-start",children:e.jsx("div",{className:"flex-1 min-h-[520px]",style:{height:"520px"},children:e.jsx(yr,{width:"100%",height:"100%",children:e.jsxs(Oo,{margin:{top:8,right:8,bottom:8,left:8},children:[e.jsx(Pi,{strokeDasharray:"3 3",opacity:.2,stroke:"#334155"}),e.jsx(aa,{x:50,stroke:"#9CA3AF",strokeWidth:2,strokeDasharray:"5 5"}),e.jsx(aa,{y:50,stroke:"#9CA3AF",strokeWidth:2,strokeDasharray:"5 5"}),e.jsx(Oi,{type:"number",dataKey:"interest",name:"Interest Intensity",domain:[0,100],label:{value:"Interest Intensity (How much they care) ",position:"insideBottomRight",offset:-5,style:{fontSize:11,fontWeight:600,fill:"#4B5563"}},tick:{fontSize:11,fill:"#6B7280"}}),e.jsx(Ri,{type:"number",dataKey:"power",name:"Power Level",domain:[0,100],label:{value:" Power Level (Ability to influence)",angle:-90,position:"insideLeft",style:{fontSize:11,fontWeight:600,fill:"#4B5563"}},tick:{fontSize:11,fill:"#6B7280"}}),e.jsx(_s,{content:e.jsx(x,{}),cursor:{strokeDasharray:"3 3"}}),e.jsx(Ro,{data:h,fill:"#8B5CF6",onClick:g=>a(g),onMouseEnter:g=>n(g.name),onMouseLeave:()=>n(null),children:h.map((g,f)=>{const y=i===g.name,k=8+g.dominance/100*22,w=!!o&&g.strategy.quadrant===o,v=k*(y?3:w?1.6:1);return e.jsx(Ii,{fill:g.uniqueLightColor,stroke:g.uniqueColor,strokeWidth:y?4:w?3:2,opacity:o?g.strategy.quadrant===o?1:.3:y?1:.85,r:v,style:{cursor:"pointer",filter:y?`drop-shadow(0 0 20px ${g.uniqueColor}) drop-shadow(0 0 40px ${g.uniqueColor})`:w?`drop-shadow(0 0 12px ${g.uniqueColor})`:"none",transition:"all 0.3s ease"}},`cell-${f}`)})})]})})})})}),e.jsx("div",{className:"lg:w-1/3 p-5 max-h-[600px] overflow-y-auto",children:e.jsx(ye,{mode:"wait",children:r?e.jsxs(B.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"flex-1",children:[e.jsxs("div",{className:"mb-4 p-4 rounded-lg border-2 shadow-sm",style:{backgroundColor:typeof document<"u"&&document.documentElement.classList.contains("dark")?"rgba(51, 65, 85, 0.85)":r.uniqueLightColor,borderColor:r.uniqueColor},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900 dark:text-slate-100",children:r.name}),e.jsx("button",{onClick:()=>a(null),className:"text-gray-400 dark:text-slate-300 hover:text-gray-600 dark:hover:text-slate-200 transition-colors text-sm font-medium",children:"Close"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-slate-300",children:r.role}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[r.isWinner&&e.jsx("span",{className:"px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 text-xs font-bold rounded",children:"MAJOR WINNER"}),r.isLoser&&e.jsx("span",{className:"px-2 py-1 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 text-xs font-bold rounded",children:"MAJOR LOSER"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900/60 rounded-lg p-4 border border-slate-200 dark:border-slate-800 shadow-sm",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 dark:text-slate-200 mb-3 flex items-center gap-2",children:[e.jsx(nt,{className:"w-4 h-4 text-purple-600"}),"Power Metrics"]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-slate-400",children:"Power Level"}),e.jsxs("span",{className:"font-bold text-purple-600",children:[r.power.toFixed(0),"/100"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-600 transition-all duration-700",style:{width:`${r.power}%`}})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mt-1",children:"Ability to influence outcomes"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900/60 rounded-lg p-4 border border-slate-200 dark:border-slate-800 shadow-sm space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-slate-400",children:"Interest Intensity"}),e.jsxs("span",{className:"font-bold text-emerald-600",children:[r.interest.toFixed(0),"/100"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full transition-all duration-700",style:{width:`${r.interest}%`,backgroundColor:"#10b981"}})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mt-1",children:"How much they care / are affected"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-slate-400",children:"Sentiment Position"}),e.jsxs("div",{className:"flex items-center gap-1",children:[(()=>{const g=r.sentiment??"neutral",y=(me[g]??me.neutral).icon;return e.jsx(y,{className:"w-3 h-3",style:{color:r.sentimentColor}})})(),e.jsx("span",{className:"font-bold px-2 py-0.5 rounded text-xs",style:{backgroundColor:(me[r.sentiment]??me.neutral).lightColor,color:r.sentimentColor},children:(me[r.sentiment]??me.neutral).label})]})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full transition-all duration-700",style:{width:"100%",backgroundColor:r.sentimentColor}})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mt-1",children:(me[r.sentiment]??me.neutral).description})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-slate-400",children:"Risk Level"}),e.jsx("span",{className:"font-bold px-2 py-0.5 rounded text-xs text-white",style:{backgroundColor:gs(r.risk)},children:r.risk.toFixed(0)})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full transition-all duration-700",style:{width:`${r.risk}%`,backgroundColor:gs(r.risk)}})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mt-1",children:"Combined risk based on power, interest & sentiment"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900/60 rounded-lg p-4 border border-slate-200 dark:border-slate-800 shadow-sm",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 dark:text-slate-200 mb-3 flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4 text-blue-600"}),"Strategic Recommendation"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-slate-400 font-medium",children:"Quadrant:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-slate-200 font-bold",children:r.strategy.label})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-slate-400 font-medium",children:"Action:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-slate-200",children:r.strategy.action})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-slate-400 font-medium",children:"Communication:"}),e.jsx("p",{className:"mt-1 text-gray-700 dark:text-slate-300 leading-relaxed",children:r.strategy.communication})]})]})]})]})]},"detail-view"):e.jsxs(B.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex-1",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-400 dark:text-slate-400 uppercase tracking-wider mb-4",children:c==="all"?`All Stakeholders (${u.length})`:`${me[c].label} Stakeholders (${h.length})`}),e.jsx("div",{className:"space-y-4",children:Object.keys(m).map(g=>{const f=$r[g],y=m[g];if(y.length===0)return null;const k=f.icon;return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(k,{className:"w-4 h-4",style:{color:f.color}}),e.jsxs("h5",{className:"font-semibold text-gray-900 dark:text-slate-200 text-sm",children:[f.label," (",y.length,")"]})]}),e.jsx("div",{className:"space-y-2",children:y.map(w=>{const v=me[w.sentiment].icon,S=i===w.name;return e.jsx(B.button,{whileHover:{scale:1.02,x:4},onClick:()=>a(w),onMouseEnter:()=>n(w.name),onMouseLeave:()=>n(null),className:`w-full text-left rounded-lg p-3 transition-all group border-2 ${S?"shadow-xl border-gray-900 scale-105":"border-transparent shadow-sm hover:shadow-md"}`,style:{backgroundColor:w.uniqueLightColor,borderColor:w.uniqueColor},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-semibold text-sm transition-colors ${S?"text-gray-900 dark:text-white":"text-gray-800 dark:text-white"}`,style:{color:S?w.uniqueColor:void 0},children:w.name}),w.isWinner&&e.jsx("span",{className:"px-1.5 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 text-[10px] font-bold rounded",children:"WIN"}),w.isLoser&&e.jsx("span",{className:"px-1.5 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 text-[10px] font-bold rounded",children:"LOSE"}),e.jsx(v,{className:"w-3 h-3",style:{color:w.sentimentColor}})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-slate-400 mt-0.5",children:w.role}),e.jsxs("p",{className:"text-[10px] text-gray-500 dark:text-slate-400 mt-1",children:["Dominance: ",w.dominance.toFixed(0),"/100"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:gs(w.risk)}}),e.jsx("span",{className:"text-xs text-gray-400 dark:text-slate-500",children:""})]})]})},w.id)})})]},g)})})]},"list-view")})})]}),e.jsx("div",{className:"p-6 bg-white dark:bg-slate-900/60 border-t border-gray-200 dark:border-slate-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-600 rounded-lg text-white shadow-sm flex-shrink-0",children:e.jsx(io,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Intelligence Recommendation"}),e.jsxs("p",{className:"text-sm text-gray-700 leading-relaxed",children:["Prioritize ",e.jsx("strong",{className:"text-purple-700",children:"Key Players"})," with high power & interest  they will move outcomes. Watch ",e.jsx("strong",{className:"text-blue-700",children:"Context Setters"}),"  powerful but disengaged (for now). Engage ",e.jsx("strong",{className:"text-emerald-700",children:"Active Observers"}),"  high interest means mobilization potential. Track ",e.jsx("strong",{children:"sentiment shifts"}),"  opposition increases risk, support creates opportunity."]})]})]})})]})}function Ou({partyImpact:s}){return!!s&&Array.isArray(s.stakeholders)&&s.stakeholders.length>0?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(we,{className:"w-5 h-5 text-purple-500"}),e.jsx("h4",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"PowerInterest Strategy Map"})]}),e.jsx(Pu,{partyImpactData:s})]})}):e.jsxs("div",{className:"p-8 text-center bg-slate-50 dark:bg-slate-950 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsx(we,{className:"w-12 h-12 text-slate-300 dark:text-slate-700 mx-auto mb-3"}),e.jsx("div",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"No stakeholder power data detected"}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"This article does not contain clear influence or leverage signals."})]})}function Ru({direct:s,indirect:t,speculative:r}){const a=s+t+r||1,i=n=>`${n/a*100}%`;return e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Impact Distribution"}),[["Direct",s,"bg-orange-500"],["Indirect",t,"bg-blue-500"],["Speculative",r,"bg-slate-400"]].map(([n,o,l])=>e.jsxs("div",{className:"text-xs",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:n}),e.jsx("span",{className:"font-semibold text-slate-800 dark:text-slate-200",children:o})]}),e.jsx("div",{className:"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded",children:e.jsx("div",{className:`h-2 rounded ${l}`,style:{width:i(o)}})})]},n))]})}function Iu({marketImpact:s}){const t=s?.tickers||{direct:[],indirect:[],speculative:[]},r=t.direct||[],a=t.indirect||[],i=t.speculative||[];return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl p-6 border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-slate-900 dark:text-white",children:[e.jsx(Te,{className:"w-5 h-5 text-green-500"}),"Market Impact"]}),e.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:s?.overallSentiment||"Neutral"})]}),e.jsx(Ru,{direct:r.length,indirect:a.length,speculative:i.length}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6",children:[["Direct",r],["Indirect",a],["Speculative",i]].map(([n,o])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold mb-2",children:[n," Targets"]}),o.length===0?e.jsx("p",{className:"text-xs text-slate-400 italic",children:"No equities found"}):o.map((l,c)=>e.jsxs("div",{className:"p-3 mb-2 border rounded-lg text-xs bg-slate-50 dark:bg-slate-800",children:[e.jsx("div",{className:"font-bold text-slate-900 dark:text-white",children:l.symbol||l.name||"Unknown"}),e.jsx("div",{className:"text-slate-600 dark:text-slate-400 mt-1",children:l.impactMechanism||l.reasoning||"Market impact"})]},c))]},n))})]})}const $u=s=>{const t=s?.toLowerCase();return t==="bullish"?{color:"text-emerald-600",bg:"bg-emerald-50",border:"border-emerald-200",icon:e.jsx(Jt,{className:"w-4 h-4"}),trendIcon:e.jsx(Te,{className:"w-5 h-5 text-emerald-600"})}:t==="bearish"?{color:"text-rose-600",bg:"bg-rose-50",border:"border-rose-200",icon:e.jsx(Ni,{className:"w-4 h-4"}),trendIcon:e.jsx(co,{className:"w-5 h-5 text-rose-600"})}:{color:"text-amber-600",bg:"bg-amber-50",border:"border-amber-200",icon:e.jsx(ot,{className:"w-4 h-4"}),trendIcon:e.jsx(fe,{className:"w-5 h-5 text-amber-600"})}},Ya=({title:s,children:t,defaultOpen:r=!1})=>{const[a,i]=b.useState(r);return e.jsxs("div",{className:"rounded-2xl bg-white dark:bg-slate-900 shadow-md overflow-hidden",children:[e.jsxs("button",{onClick:()=>i(!a),className:"w-full flex items-center justify-between p-6 text-left border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold flex items-center gap-2",children:s}),a?e.jsx(_i,{className:"w-5 h-5"}):e.jsx(Rs,{className:"w-5 h-5"})]}),e.jsx(ye,{children:a&&e.jsx(B.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx("div",{className:"p-6",children:t})})})]})},Xa=({ticker:s})=>{const[t,r]=b.useState(!1),a=$u(s.sentiment);return e.jsxs("div",{className:"rounded-xl border bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("button",{onClick:()=>r(!t),className:"w-full flex items-center justify-between p-4 text-left",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-slate-50 dark:bg-slate-800",children:a.trendIcon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-base uppercase",children:s.symbol||"N/A"}),e.jsx("div",{className:"text-sm text-slate-500 truncate max-w-[200px]",children:s.name})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:`px-3 py-1 rounded-md text-sm font-semibold ${a.bg} ${a.color}`,children:[a.icon," ",s.sentiment]}),e.jsxs("div",{className:"text-right hidden md:block",children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase",children:"Confidence"}),e.jsxs("div",{className:"text-sm font-mono font-bold",children:[s.confidence||70,"%"]})]}),t?e.jsx(_i,{className:"w-5 h-5"}):e.jsx(Rs,{className:"w-5 h-5"})]})]}),e.jsx(ye,{children:t&&e.jsx(B.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-slate-100 dark:border-slate-800 overflow-hidden",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-semibold text-indigo-600 mb-2 flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"}),"Why this company is affected"]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 leading-relaxed",children:s.impactMechanism||"This exposure is inferred from how the news affects the company's business position."})]}),s.evidence?.sourceSentence&&e.jsx("div",{className:"bg-slate-100/50 dark:bg-slate-800/50 p-4 rounded-lg italic border-l-4 border-indigo-200",children:e.jsxs("p",{className:"text-sm text-slate-600",children:['"',s.evidence.sourceSentence,'"']})}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h5",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Key Considerations"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-2 text-sm text-slate-600",children:[e.jsx("li",{children:"Monitor volume spikes for confirmation."}),e.jsx("li",{children:"Check related news for updates."}),e.jsx("li",{children:"Assess broader market sentiment."})]})]})]})})})]})},Lu=()=>e.jsxs("div",{className:"space-y-6 max-w-4xl mx-auto p-4 md:p-0",children:[e.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"rounded-2xl border-2 border-blue-400 dark:border-blue-600 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 overflow-hidden shadow-xl",children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-3",children:[e.jsx(Te,{className:"w-7 h-7 text-emerald-500"}),"Market Impact Preview"]}),e.jsx("span",{className:"text-xs px-4 py-2 rounded-full bg-blue-600 text-white font-bold uppercase tracking-wide",children:"Trial Preview"})]}),e.jsxs("div",{className:"bg-white/80 dark:bg-slate-800/80 rounded-xl p-6 mb-6 border border-blue-200 dark:border-blue-700",children:[e.jsx("p",{className:"text-base text-slate-700 dark:text-slate-300 mb-4 leading-relaxed",children:"This article could trigger significant market movements across multiple dimensions:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800",children:[e.jsx(Jt,{className:"w-5 h-5 text-emerald-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-emerald-900 dark:text-emerald-100 mb-1",children:"Capital Rotation"}),e.jsx("p",{className:"text-xs text-emerald-700 dark:text-emerald-300",children:"Potential sector shifts and fund flows"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800",children:[e.jsx(ot,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-blue-900 dark:text-blue-100 mb-1",children:"Sentiment Shifts"}),e.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:"Positioning changes across asset classes"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800",children:[e.jsx(we,{className:"w-5 h-5 text-purple-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-purple-900 dark:text-purple-100 mb-1",children:"Trading Opportunities"}),e.jsx("p",{className:"text-xs text-purple-700 dark:text-purple-300",children:"Contrarian setups and momentum plays"})]})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 rounded-lg p-4 border border-amber-200 dark:border-amber-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(fe,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-amber-900 dark:text-amber-100 mb-1",children:"Positioning Traps"}),e.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-300",children:"Common mistakes investors make when reacting to this type of news"})]})]})})]}),e.jsxs("div",{className:"text-center py-6 border-t border-blue-200 dark:border-blue-700",children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:"Unlock the complete analysis to see:"}),e.jsxs("ul",{className:"text-sm text-left max-w-md mx-auto space-y-2 mb-6",children:[e.jsxs("li",{className:"flex items-center gap-2 text-slate-700 dark:text-slate-300",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"Specific tickers and their projected impact"]}),e.jsxs("li",{className:"flex items-center gap-2 text-slate-700 dark:text-slate-300",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"Sector-level sentiment shifts with confidence scores"]}),e.jsxs("li",{className:"flex items-center gap-2 text-slate-700 dark:text-slate-300",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"Institutional flow patterns and smart money positioning"]}),e.jsxs("li",{className:"flex items-center gap-2 text-slate-700 dark:text-slate-300",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"Actionable trading setups with risk parameters"]})]}),e.jsxs("button",{onClick:()=>window.location.href="/pricing",className:"inline-flex items-center gap-2 px-8 py-3.5 rounded-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold text-base hover:from-blue-700 hover:to-purple-700 transition-all shadow-xl hover:shadow-2xl transform hover:-translate-y-0.5",children:["Unlock Full Market Intelligence",e.jsx(Jt,{className:"w-5 h-5"})]})]})]})}),e.jsxs("div",{className:"text-center text-xs text-slate-500 dark:text-slate-400 flex items-center justify-center gap-2",children:[e.jsx(Ge,{className:"w-4 h-4"}),"Market analysis for informational purposes only  not investment advice"]})]}),Uu=()=>e.jsx("div",{className:"max-w-2xl mx-auto p-8 text-center",children:e.jsxs("div",{className:"rounded-2xl border-2 border-dashed border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/50 p-12",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(pe,{className:"w-12 h-12 text-slate-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Market Impact Analysis Unavailable"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6",children:"This advanced feature is available in Pro and Business plans."}),e.jsxs("button",{onClick:()=>window.location.href="/pricing",className:"inline-flex items-center gap-2 px-6 py-3 rounded-full bg-blue-600 text-white font-semibold hover:bg-blue-700 transition",children:["View Pricing Plans",e.jsx(Jt,{className:"w-4 h-4"})]})]})});function Du({marketImpact:s,isTrialAnalysis:t=!1}){if(!s&&t)return console.log(" Showing trial market impact teaser"),e.jsx(Lu,{});if(!s)return console.log(" No market impact data - showing empty state"),e.jsx(Uu,{});const{tickers:r={},sectors:a=[],overallSentiment:i={},institutionalFlow:n={}}=s,o=[...r?.direct||[],...r?.indirect||[]].filter(u=>u?.sentiment==="Bullish"),l=[...r?.direct||[],...r?.indirect||[],...r?.speculative||[]].filter(u=>u?.sentiment==="Bearish"),c=(r?.indirect||[]).filter(u=>u?.impactMechanism?.toLowerCase().includes("supply")||u?.impactMechanism?.toLowerCase().includes("vendor")),d=r?.speculative||[];return e.jsxs("div",{className:"space-y-8 max-w-7xl mx-auto p-4 md:p-0",children:[e.jsxs("section",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-md p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx(Te,{className:"w-7 h-7 text-indigo-500"}),"Market Impact Overview"]}),e.jsx("span",{className:"text-xs px-4 py-2 rounded-full bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 font-semibold uppercase tracking-wide",children:"Pro Intelligence"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-6 rounded-2xl bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-700/50",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-indigo-500",children:"Actionability"}),e.jsxs("div",{className:"mt-3 text-lg font-bold text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[e.jsx(no,{className:"w-6 h-6 text-indigo-500"}),o.length>0?"Actionable (Await confirmation)":"Watch only"]}),e.jsx("p",{className:"text-sm text-slate-500 mt-3",children:"Use with price/volume confirmation. Not a direct signal."})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-rose-50 dark:bg-rose-900/20 border border-rose-200 dark:border-rose-700/50",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-rose-500",children:"Potential Risks"}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm font-medium text-rose-600",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(tt,{className:"w-4 h-4"})," No price follow-through"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(tt,{className:"w-4 h-4"})," Macro reversal"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(tt,{className:"w-4 h-4"})," Regulatory changes"]})]})]})]})]}),e.jsx(Ya,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5 text-indigo-500"}),"Company Impacts (Advanced Details)"]}),defaultOpen:!1,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-base font-semibold text-emerald-600 mb-4 flex items-center gap-2",children:[e.jsx(Jt,{className:"w-5 h-5"}),"Primary Targets (Beneficiaries)"]}),e.jsx("div",{className:"grid gap-4",children:o.length>0?o.map((u,m)=>e.jsx(Xa,{ticker:u},m)):e.jsx("div",{className:"p-8 text-sm text-slate-500 border-2 border-dashed rounded-xl text-center",children:"No clear beneficiaries identified."})}),c.length>0&&e.jsxs("div",{className:"mt-8 p-6 rounded-xl bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200",children:[e.jsxs("h5",{className:"text-sm font-semibold text-indigo-600 mb-3 flex items-center gap-2",children:[e.jsx(oo,{className:"w-5 h-5"}),"Ecosystem & Supply Chain"]}),e.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Supporting or dependent companies."}),e.jsx("div",{className:"grid gap-3",children:c.map((u,m)=>e.jsx("div",{className:"text-sm font-medium",children:u.symbol||u.name},m))})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-base font-semibold text-rose-600 mb-4 flex items-center gap-2",children:[e.jsx(Ni,{className:"w-5 h-5"}),"Competitive Pressure (Potential Losers)"]}),e.jsx("div",{className:"grid gap-4",children:l.length>0?l.map((u,m)=>e.jsx(Xa,{ticker:u},m)):e.jsx("div",{className:"p-8 text-sm text-slate-500 border-2 border-dashed rounded-xl text-center",children:"No obvious downside risks detected."})}),d.length>0&&e.jsxs("div",{className:"mt-8 p-6 rounded-xl bg-slate-100 dark:bg-slate-800/50 border border-slate-200",children:[e.jsxs("h5",{className:"text-sm font-semibold text-slate-600 mb-3 flex items-center gap-2",children:[e.jsx(Ns,{className:"w-5 h-5"}),"Industry Peers to Watch"]}),e.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Potential shifts in market share."}),e.jsx("div",{className:"grid gap-3",children:d.map((u,m)=>e.jsx("div",{className:"text-sm font-medium",children:u.symbol||u.name},m))})]})]})]})}),e.jsx(Ya,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Os,{className:"w-5 h-5 text-indigo-500"}),"Sector Implications  Who Benefits, Who Faces Pressure"]}),defaultOpen:!1,children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:a?.map((u,m)=>{const p=u.impact==="Bullish",h=p?"bg-emerald-50 border-emerald-200 text-emerald-600":"bg-rose-50 border-rose-200 text-rose-600";return e.jsxs("div",{className:`p-6 rounded-xl border ${h} shadow-sm`,children:[e.jsx("div",{className:"text-sm uppercase font-semibold text-slate-600 mb-1",children:u.name}),e.jsxs("div",{className:"text-xl font-bold",children:[p?"Tailwind":"Headwind",e.jsx("p",{className:"mt-2 text-sm text-slate-600 leading-relaxed",children:p?"This news flow improves demand visibility or pricing power for this sector.":"This development may compress margins, reduce demand, or shift capital away from this sector."})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Confidence"}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full ${p?"bg-emerald-500":"bg-rose-500"}`,style:{width:`${u.confidence}%`}})}),e.jsxs("div",{className:"text-xs text-right mt-1",children:[u.confidence,"%"]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-slate-200 text-xs text-slate-500",children:[e.jsx("strong",{children:"Investor takeaway:"})," ",p?"Monitor leading stocks in this sector for relative strength, volume expansion, or follow-through.":"Be alert to relative underperformance, valuation compression, or capital rotation away from this sector."]})]},m)})})}),e.jsx(Iu,{marketImpact:s}),e.jsxs("section",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ge,{className:"w-5 h-5 text-indigo-500"}),"Decision Support Tips"]}),e.jsxs("ul",{className:"space-y-4 text-sm text-slate-600",children:[e.jsxs("li",{className:"flex gap-3",children:[e.jsx(fe,{className:"w-5 h-5 text-amber-500 flex-shrink-0"}),e.jsx("span",{children:"Always cross-verify with real-time price data and volume trends before acting."})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx(we,{className:"w-5 h-5 text-indigo-500 flex-shrink-0"}),e.jsx("span",{children:"Consider portfolio diversification to mitigate sector-specific risks."})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx(lo,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),e.jsx("span",{children:"Monitor institutional flows for stronger confirmation signals."})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx(tt,{className:"w-5 h-5 text-rose-500 flex-shrink-0"}),e.jsx("span",{children:"Be aware of external factors like economic indicators or geopolitical events."})]})]})]}),e.jsxs("footer",{className:"flex justify-center pt-6 border-t text-xs text-slate-400 uppercase tracking-widest",children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),"Financial Decision Support  Not Investment Advice"]})]})}function Mu({icon:s,title:t,subtitle:r,verdictText:a,beginnerBullets:i=[],isActive:n=!1,isLast:o=!1,children:l}){return e.jsxs("section",{className:`relative rounded-2xl border bg-white dark:bg-slate-900 shadow-sm ${n?"border-blue-400/50":"border-slate-200 dark:border-slate-800"}`,children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[s&&e.jsx("div",{className:"mt-1 text-blue-600 dark:text-blue-400",children:e.jsx(s,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-white",children:t}),r&&e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:r})]})]}),a&&e.jsxs("div",{className:"mt-4 rounded-lg bg-slate-50 dark:bg-slate-800/50 p-4 text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("strong",{children:"Verdict:"})," ",a]}),i.length>0&&e.jsx("ul",{className:"mt-4 space-y-1 text-xs text-slate-500 dark:text-slate-400",children:i.map((c,d)=>e.jsxs("li",{children:[" ",c]},d))})]}),e.jsx("div",{className:"relative",children:l}),!o&&e.jsx("div",{className:"absolute left-1/2 -bottom-6 h-6 w-px bg-slate-300 dark:bg-slate-700"})]})}function cr({children:s,className:t=""}){return e.jsx("div",{className:t,children:s})}function ln({data:s,className:t=""}){const[r,a]=b.useState(!1);if(!s)return null;const i=[...s.historicalOutcomes||[]].sort((o,l)=>l.probability-o.probability),n=i[0];return e.jsxs("div",{className:`flex flex-col h-full ${t}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg",children:e.jsx(gi,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800 dark:text-slate-100 text-base",children:"Pattern Recurrence"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"AI-detected repetition"})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 rounded-xl p-4 border border-slate-100 dark:border-slate-800 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Closest Match"}),e.jsxs("span",{className:"text-xs font-bold px-2 py-1 rounded bg-indigo-100 text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-300",children:[s.similarityScore,"% Similarity"]})]}),e.jsx("div",{className:"text-lg font-bold text-slate-800 dark:text-slate-100 leading-tight mb-1",children:s.matchedEvent||"No historical match found"}),e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Pattern: ",e.jsx("span",{className:"text-slate-700 dark:text-slate-300 font-medium",children:s.timePattern})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[11px] font-bold uppercase tracking-wide text-slate-500 mb-2",children:"Based on history, what happens next?"}),n?e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-500/10 to-blue-500/10 rounded-xl blur-sm transition-opacity opacity-75 group-hover:opacity-100"}),e.jsxs("div",{className:"relative bg-white dark:bg-slate-900 border border-emerald-500/30 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-xs font-bold text-emerald-600 dark:text-emerald-400 flex items-center gap-1",children:[e.jsx(Te,{className:"w-3 h-3"})," Most Likely Outcome"]}),e.jsxs("span",{className:"text-xs font-bold text-slate-900 dark:text-white",children:[n.probability,"% Probability"]})]}),e.jsx("p",{className:"text-slate-800 dark:text-slate-200 font-medium leading-relaxed",children:n.outcome})]})]}):e.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg text-sm text-slate-500 text-center",children:"Insufficient data to predict outcome."}),e.jsxs("div",{className:"mt-3 rounded-lg border border-slate-200 dark:border-slate-800 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2 text-[11px] font-bold uppercase tracking-wide text-slate-400 bg-slate-50 dark:bg-slate-900/40",children:"Alternative Outcomes"}),e.jsx("div",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:i.map((o,l)=>e.jsxs("div",{className:"grid grid-cols-12 items-center gap-3 px-3 py-2 hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsx("span",{className:"col-span-8 text-xs text-slate-600 dark:text-slate-400",children:o.outcome}),e.jsxs("div",{className:"col-span-4 flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs font-mono text-slate-500",children:[o.probability,"%"]}),e.jsx("div",{className:"flex-1 h-2 bg-slate-200 dark:bg-slate-800 rounded",children:e.jsx("div",{className:"h-full rounded",style:{width:`${o.probability}%`,backgroundColor:o.probability>=60?"#059669":o.probability>=30?"#f59e0b":"#6b7280"}})})]})]},l))})]})]}),s.analystNote&&e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-100 dark:border-slate-800",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(fe,{className:"w-3 h-3 text-amber-500"})}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 leading-relaxed italic",children:['"',s.analystNote,'"']})]})})]})}function cn({data:s,className:t=""}){const[r,a]=b.useState("facts");if(!s)return null;const i=s.factCount+s.speculationCount,n=i>0?Math.round(s.factCount/i*100):0,o=s.segments||[],l=o.filter(u=>u.type==="fact"),c=o.filter(u=>u.type==="speculation"),d=o.length>0;return e.jsxs("div",{className:`flex flex-col h-full ${t}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.signalToNoise>60?"bg-emerald-100 dark:bg-emerald-900/30":"bg-rose-100 dark:bg-rose-900/30"}`,children:s.signalToNoise>60?e.jsx(gr,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-400"}):e.jsx(tt,{className:"w-5 h-5 text-rose-600 dark:text-rose-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800 dark:text-slate-100 text-base",children:"Evidence Confidence"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Fact vs Speculation Ratio"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-xs font-semibold mb-2",children:[e.jsxs("span",{className:"text-emerald-600 dark:text-emerald-400",children:[n,"% Facts"]}),e.jsxs("span",{className:"text-rose-500 dark:text-rose-400",children:[100-n,"% Speculation"]})]}),e.jsxs("div",{className:"h-3 w-full bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden flex",children:[e.jsx("div",{className:"h-full bg-emerald-500 transition-all duration-500",style:{width:`${n}%`}}),e.jsx("div",{className:"h-full bg-rose-500 transition-all duration-500",style:{width:`${100-n}%`}})]})]}),e.jsxs("div",{className:"flex gap-2 mb-3 border-b border-slate-200 dark:border-slate-800",children:[e.jsxs("button",{onClick:()=>a("facts"),className:`pb-2 px-1 text-xs font-bold uppercase tracking-wide transition-colors ${r==="facts"?"text-emerald-600 border-b-2 border-emerald-500":"text-slate-400 hover:text-slate-600"}`,children:["Verified Facts (",d?l.length:s.factCount,")"]}),e.jsxs("button",{onClick:()=>a("speculation"),className:`pb-2 px-1 text-xs font-bold uppercase tracking-wide transition-colors ${r==="speculation"?"text-rose-500 border-b-2 border-rose-500":"text-slate-400 hover:text-slate-600"}`,children:["Speculation (",d?c.length:s.speculationCount,")"]})]}),e.jsx("div",{className:"flex-1 overflow-auto max-h-[420px] md:max-h-[520px] pr-2 space-y-2",children:d?r==="facts"?l.length>0?l.map((u,m)=>e.jsxs("div",{className:"flex gap-3 text-sm p-2 rounded bg-emerald-50/50 dark:bg-emerald-900/10 border border-emerald-100 dark:border-emerald-900/20",children:[e.jsx(Le,{className:"w-4 h-4 text-emerald-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:u.text})]},m)):e.jsx("div",{className:"text-center text-slate-400 text-sm py-4",children:"No specific facts isolated."}):c.length>0?c.map((u,m)=>e.jsxs("div",{className:"flex gap-3 text-sm p-2 rounded bg-rose-50/50 dark:bg-rose-900/10 border border-rose-100 dark:border-rose-900/20",children:[e.jsx(Kt,{className:"w-4 h-4 text-rose-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300 italic",children:u.text})]},m)):e.jsx("div",{className:"text-center text-slate-400 text-sm py-4",children:"No speculation detected."}):e.jsx("div",{className:"space-y-4",children:r==="facts"?e.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/10 rounded-xl p-6 border-2 border-dashed border-emerald-200 dark:border-emerald-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-emerald-100 dark:bg-emerald-900/30 rounded-lg",children:e.jsx(Le,{className:"w-6 h-6 text-emerald-600 dark:text-emerald-400"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-bold text-emerald-900 dark:text-emerald-300",children:[s.factCount," Verified Facts"]}),e.jsxs("p",{className:"text-xs text-emerald-700 dark:text-emerald-400",children:[n,"% of content is fact-based"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-white dark:bg-slate-900 rounded-lg",children:[e.jsx(Ge,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("p",{className:"font-semibold mb-1",children:"High Factual Density"}),e.jsx("p",{className:"text-xs",children:"This article contains a strong foundation of verifiable statements and data points."})]})]}),s.signalToNoise>=70&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-white dark:bg-slate-900 rounded-lg",children:[e.jsx(gr,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Strong Signal Quality"}),e.jsxs("p",{className:"text-xs",children:["Signal-to-noise ratio of ",s.signalToNoise,"% indicates reliable information."]})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-xs text-blue-800 dark:text-blue-300 flex items-center gap-2",children:[e.jsx(Ge,{className:"w-3 h-3"}),"Individual fact extraction coming in next backend update"]})})]})]}):e.jsxs("div",{className:"bg-rose-50 dark:bg-rose-900/10 rounded-xl p-6 border-2 border-dashed border-rose-200 dark:border-rose-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-rose-100 dark:bg-rose-900/30 rounded-lg",children:e.jsx(Kt,{className:"w-6 h-6 text-rose-600 dark:text-rose-400"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-bold text-rose-900 dark:text-rose-300",children:[s.speculationCount," Speculative Elements"]}),e.jsxs("p",{className:"text-xs text-rose-700 dark:text-rose-400",children:[100-n,"% of content contains speculation"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-white dark:bg-slate-900 rounded-lg",children:[e.jsx(Ge,{className:"w-4 h-4 text-rose-600 dark:text-rose-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Contains Predictions & Opinions"}),e.jsx("p",{className:"text-xs",children:"Article includes forward-looking statements and interpretative analysis."})]})]}),100-n>40&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-white dark:bg-slate-900 rounded-lg",children:[e.jsx(tt,{className:"w-4 h-4 text-rose-600 dark:text-rose-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("p",{className:"font-semibold mb-1",children:"High Speculation Ratio"}),e.jsx("p",{className:"text-xs",children:"Exercise caution - significant portion is based on projections or assumptions."})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-xs text-blue-800 dark:text-blue-300 flex items-center gap-2",children:[e.jsx(Ge,{className:"w-3 h-3"}),"Individual speculation extraction coming in next backend update"]})})]})]})})})]})}function dn({data:s,className:t=""}){if(!s)return null;const r=a=>{if(!a||typeof a!="string")return"text-slate-500 bg-slate-100 dark:bg-slate-800 dark:text-slate-300";switch(a.toLowerCase()){case"extreme":return"text-purple-600 bg-purple-100 dark:bg-purple-900/30 dark:text-purple-300";case"critical":return"text-rose-600 bg-rose-100 dark:bg-rose-900/30 dark:text-rose-300";case"high":return"text-amber-600 bg-amber-100 dark:bg-amber-900/30 dark:text-amber-300";default:return"text-blue-600 bg-blue-100 dark:bg-blue-900/30 dark:text-blue-300"}};return e.jsxs("div",{className:`flex flex-col h-full ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg animate-pulse",children:e.jsx(uo,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800 dark:text-slate-100 text-base",children:"Outcome Propagation"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Causal Chain & Consequence Engine"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Loop Strength"}),e.jsxs("div",{className:"text-xl font-black text-purple-600 dark:text-purple-400",children:[s.resonanceScore,"%"]})]})]}),e.jsxs("div",{className:"mb-6 p-3 bg-slate-50 dark:bg-slate-900 rounded-xl border border-slate-100 dark:border-slate-800 flex items-center gap-3",children:[e.jsx(ho,{className:"w-5 h-5 text-slate-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] uppercase font-bold text-slate-400",children:"How Public Reaction Feeds Back"}),e.jsx("div",{className:"font-bold text-slate-700 dark:text-slate-200 leading-tight",children:s.loopDetected})]})]}),e.jsx("div",{className:"flex-1 relative space-y-0 pl-4 border-l-2 border-slate-200 dark:border-slate-800 ml-4 mb-4",children:s.causalChain.map((a,i)=>e.jsxs("div",{className:"relative pb-8 last:pb-0",children:[e.jsx("div",{className:`absolute -left-[21px] top-1 w-3 h-3 rounded-full border-2 border-white dark:border-slate-900 ${i===2?"bg-purple-500":"bg-slate-300 dark:bg-slate-600"}`}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-400",children:a.order}),e.jsxs("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded-full ${r(a.impact)}`,children:[a.probability,"% Likely"]})]}),e.jsx("div",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:a.event})]}),i!==s.causalChain.length-1&&e.jsx("div",{className:"mt-2 text-slate-300 dark:text-slate-700",children:e.jsx(bi,{className:"w-3 h-3"})})]},i))}),e.jsx("div",{className:"mt-auto",children:e.jsxs("div",{className:"relative overflow-hidden rounded-xl bg-slate-900 dark:bg-black p-4 text-white",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:e.jsx(Gt,{className:"w-24 h-24"})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-purple-400",children:[e.jsx(nt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Crucial Blindspot"})]}),e.jsxs("p",{className:"text-sm font-medium leading-relaxed opacity-90",children:['"',s.blindSpot,'"']})]})]})})]})}function Bu({chronos:s,entropy:t,ouroboros:r,verdictText:a}){return e.jsx(Mu,{children:e.jsx("div",{className:"p-6 h-full",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 min-h-[700px]",children:[e.jsx(cr,{children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl p-4 shadow-md border border-slate-200 dark:border-slate-800 relative overflow-visible",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-emerald-500 via-blue-500 to-blue-500"}),e.jsx("div",{className:"absolute -top-3 left-4",children:e.jsx("div",{className:"px-2 py-[2px] text-[10px] font-semibold uppercase tracking-wide bg-emerald-600 text-white rounded-b-md shadow-sm",children:"PAST"})}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:"Historical context  This section helps you understand prior patterns."}),s?e.jsx(ln,{data:s}):e.jsx("div",{className:"p-4 text-slate-500 dark:text-slate-400 text-center",children:"Chronos data not available."})]})}),e.jsx(cr,{children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl p-4 shadow-md border border-slate-200 dark:border-slate-800 relative overflow-visible",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-indigo-500 to-indigo-500"}),e.jsx("div",{className:"absolute -top-3 left-4",children:e.jsx("div",{className:"px-2 py-[2px] text-[10px] font-semibold uppercase tracking-wide bg-blue-600 text-white rounded-b-md shadow-sm",children:"PRESENT"})}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:"Signal noise / uncertainty  This section helps you understand information quality."}),t?e.jsx(cn,{data:t}):e.jsx("div",{className:"p-4 text-slate-500 dark:text-slate-400 text-center",children:"Entropy data not available."})]})}),e.jsx(cr,{children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl p-4 shadow-md border-2 border-purple-500/20 relative overflow-visible",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-500 via-rose-500 to-rose-500"}),e.jsx("div",{className:"absolute -top-3 left-4",children:e.jsx("div",{className:"px-2 py-[2px] text-[10px] font-semibold uppercase tracking-wide bg-rose-600 text-white rounded-b-md shadow-sm",children:"FUTURE"})}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:"Feedback loop projection  This section helps you understand potential causal chains."}),r?e.jsx(dn,{data:r}):e.jsx("div",{className:"p-4 text-slate-500 dark:text-slate-400 text-center",children:"Ouroboros data not available."})]})})]})})})}function Fu({onUpgrade:s}){return e.jsxs("div",{className:"mt-10 rounded-2xl border border-amber-300/40 bg-gradient-to-br from-amber-50 via-white to-white dark:from-amber-900/20 dark:via-slate-900 dark:to-slate-900 p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-3",children:"You are no longer seeing isolated news  you are seeing patterns."}),e.jsxs("p",{className:"text-sm leading-relaxed text-slate-700 dark:text-slate-300 mb-4",children:["Across your ",e.jsx("strong",{children:"three analyses"}),", one thing has appeared repeatedly:",e.jsx("br",{}),e.jsx("span",{className:"italic",children:"narratives are not neutral, and missing information is often more important than what is included."})]}),e.jsxs("p",{className:"text-sm leading-relaxed text-slate-700 dark:text-slate-300 mb-6",children:["Most readers never move beyond surface-level interpretation.",e.jsx("br",{}),"You already have."]}),e.jsx("div",{className:"my-5 border-t border-slate-200 dark:border-slate-700"}),e.jsxs("div",{className:"space-y-3 mb-6 text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("p",{children:"What comes next is a choice:"}),e.jsxs("p",{children:[e.jsx("strong",{children:"A."})," Return to traditional news reading,",e.jsx("br",{}),"accepting that critical structural signals may be missed again"]}),e.jsx("p",{className:"font-medium",children:"or"}),e.jsxs("p",{children:[e.jsx("strong",{children:"B."})," Continue with structured analysis,",e.jsx("br",{}),"examining narratives, incentives, and risk before forming conclusions"]})]}),e.jsxs("button",{onClick:s,className:"w-full flex items-center justify-center gap-2 rounded-full bg-amber-500 hover:bg-amber-600 text-white py-3 font-medium transition",children:["Upgrade to avoid blind spots",e.jsx(Ht,{className:"w-4 h-4"})]}),e.jsx("p",{className:"mt-3 text-center text-xs text-slate-500 dark:text-slate-400",children:"Analytical users typically upgrade at this point"})]})}function qu({partyImpact:s}){const[t,r]=b.useState(!1),a=()=>{r(!0),typeof window.trackPremiumView=="function"&&window.trackPremiumView("Winner/Loser Analysis")},i=s&&(s.majorWinners||s.majorLosers||s.stakeholders?.length>0),n=b.useMemo(()=>s?s.majorWinners&&s.majorWinners.length>0?s.majorWinners.slice(0,3).map(u=>({name:u,trend:"up"})):s.stakeholders?.filter(u=>u.sentiment==="positive"&&u.power>60)?.sort((u,m)=>m.power-u.power)?.slice(0,3)?.map(u=>({name:u.name,trend:"up"}))||[]:[],[s]),o=b.useMemo(()=>s?s.majorLosers&&s.majorLosers.length>0?s.majorLosers.slice(0,3).map(u=>({name:u,trend:"down"})):s.stakeholders?.filter(u=>u.sentiment==="negative"&&u.power>60)?.sort((u,m)=>m.power-u.power)?.slice(0,3)?.map(u=>({name:u.name,trend:"down"}))||[]:[],[s]);if(!i||n.length===0&&o.length===0)return null;const l=(d,u,m,p=0)=>{const h=d/u*2*Math.PI-Math.PI/2+p,x=50+m*Math.cos(h),g=50+m*Math.sin(h);return{x,y:g}},c=b.useMemo(()=>{const d=n.map((m,p)=>({...m,type:"winner",sizePx:64,...l(p,n.length,22,0)})),u=o.map((m,p)=>({...m,type:"loser",sizePx:40,...l(p,o.length,42,Math.PI)}));return[...d,...u]},[n,o]);return e.jsxs("div",{className:"relative bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-xl shadow-2xl overflow-hidden max-w-lg mx-auto border border-slate-700",style:{minHeight:"520px"},onMouseEnter:a,onMouseLeave:()=>r(!1),children:[e.jsx("div",{className:"absolute top-4 right-4 z-30",children:e.jsxs("div",{className:"bg-gradient-to-r from-amber-400 to-orange-500 text-white px-3 py-1 rounded-full text-xs font-bold flex items-center space-x-1 shadow-lg border border-white/20",children:[e.jsx(it,{className:"w-3 h-3"}),e.jsx("span",{children:"RELATIONSHIP MAP"})]})}),e.jsxs("div",{className:"absolute top-4 left-4 z-20 pointer-events-none",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-100 flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-amber-400"}),"Alliance Network"]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Proximity indicates relationship strength"})]}),e.jsx("div",{className:`absolute inset-0 bg-slate-900/60 backdrop-blur-md flex items-center justify-center transition-all duration-500 z-40 ${t?"opacity-0 pointer-events-none scale-110":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:"text-center p-8 rounded-2xl bg-slate-900/90 border border-slate-700 shadow-2xl max-w-xs mx-4",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-amber-400 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg shadow-amber-500/20",children:e.jsx(pe,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Unlock Network"}),e.jsx("p",{className:"text-slate-400 mb-6 text-sm",children:"Reveal the hidden alliances and conflicts surrounding the core entity."}),e.jsxs("button",{className:"w-full bg-gradient-to-r from-amber-500 to-orange-600 text-white px-4 py-2.5 rounded-lg font-bold text-sm hover:from-amber-400 hover:to-orange-500 transition-all duration-200 flex items-center justify-center space-x-2 shadow-lg",children:[e.jsx(nt,{className:"w-4 h-4"}),e.jsx("span",{children:"Reveal Connections"})]})]})}),e.jsxs("div",{className:`w-full h-full absolute inset-0 transition-all duration-700 ease-in-out ${t?"blur-none scale-100":"blur-sm scale-95"}`,children:[e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:[e.jsx("div",{className:"w-[44%] h-[44%] rounded-full border border-emerald-500/10 absolute animate-[spin_60s_linear_infinite]"}),e.jsx("div",{className:"w-[84%] h-[84%] rounded-full border border-dashed border-slate-600/30 absolute"}),e.jsx("div",{className:"w-[30%] h-[30%] bg-amber-500/10 blur-3xl absolute rounded-full"})]}),e.jsxs("svg",{className:"absolute inset-0 w-full h-full pointer-events-none z-0",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"gradWinner",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:"0.6"})," ",e.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:"0.1"})]}),e.jsxs("linearGradient",{id:"gradLoser",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#94a3b8",stopOpacity:"0.1"})," ",e.jsx("stop",{offset:"100%",stopColor:"#64748b",stopOpacity:"0.3"})]})]}),c.map((d,u)=>e.jsx("line",{x1:"50%",y1:"50%",x2:`${d.x}%`,y2:`${d.y}%`,stroke:d.type==="winner"?"url(#gradWinner)":"url(#gradLoser)",strokeWidth:d.type==="winner"?"3":"1",strokeDasharray:d.type==="loser"?"4 4":"0",className:"transition-all duration-1000"},`line-${u}`))]}),e.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-20 text-center",children:[e.jsxs("div",{className:"relative group cursor-default",children:[e.jsx("div",{className:"absolute inset-0 bg-amber-500 blur-2xl opacity-20 group-hover:opacity-40 transition-opacity duration-500"}),e.jsx("div",{className:"w-24 h-24 bg-gradient-to-b from-slate-800 to-black rounded-full border-4 border-amber-500 flex items-center justify-center shadow-2xl relative z-10",children:e.jsx(it,{className:"w-10 h-10 text-amber-500"})})]}),e.jsx("div",{className:"mt-3 bg-amber-500/10 border border-amber-500/20 text-amber-500 font-bold text-xs px-3 py-1 rounded-full inline-block backdrop-blur-sm",children:"CORE ENTITY"})]}),c.map((d,u)=>e.jsxs("div",{className:"absolute z-10 flex flex-col items-center group cursor-pointer",style:{top:`${d.y}%`,left:`${d.x}%`,transform:"translate(-50%, -50%)"},children:[e.jsxs("div",{className:`relative transition-all duration-300 group-hover:scale-110 shadow-lg rounded-full flex items-center justify-center border-2
                    ${d.type==="winner"?"bg-slate-800 border-emerald-500 shadow-emerald-500/20":"bg-slate-900 border-slate-600 shadow-black/40 grayscale opacity-80"}`,style:{width:`${d.sizePx}px`,height:`${d.sizePx}px`},children:[e.jsx(Is,{className:`${d.type==="winner"?"w-8 h-8 text-emerald-400":"w-5 h-5 text-slate-400"}`}),e.jsx("div",{className:`absolute -bottom-1 -right-1 rounded-full p-1 border-2 border-slate-900 
                        ${d.type==="winner"?"bg-emerald-500 text-white":"bg-slate-600 text-gray-300"}`,children:d.type==="winner"?e.jsx(ki,{className:"w-3 h-3"}):e.jsx(ji,{className:"w-3 h-3"})})]}),e.jsx("div",{className:`mt-2 text-xs font-semibold px-3 py-1 rounded-full border backdrop-blur-sm transition-colors duration-300 whitespace-nowrap
                    ${d.type==="winner"?"text-emerald-100 border-emerald-500/30 bg-emerald-950/60 shadow-lg":"text-slate-400 border-slate-600/30 bg-slate-900/60"}`,children:d.name})]},d.name))]}),e.jsxs("div",{className:`absolute bottom-4 left-0 right-0 flex justify-center gap-8 z-20 transition-opacity duration-500 ${t?"opacity-100":"opacity-0"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-black/40 border border-emerald-500/20 backdrop-blur-sm",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]"}),e.jsx("span",{className:"text-xs text-emerald-100 font-medium",children:"Close Relationship"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-black/40 border border-slate-600/20 backdrop-blur-sm",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-slate-500"}),e.jsx("span",{className:"text-xs text-slate-400 font-medium",children:"Distant Relationship"})]})]})]})}function Hu({variant:s="landing",className:t,onSuccess:r}){const[a,i]=b.useState(""),[n,o]=b.useState(!1),[l,c]=b.useState(null),[d,u]=b.useState(null),[m,p]=b.useState(!1),x=b.useMemo(()=>/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i,[]).test(a),[g,f]=b.useState(!1),y=b.useRef(null);b.useEffect(()=>{const w=new IntersectionObserver(v=>{v[0].isIntersecting&&f(!0)},{threshold:.2});return y.current&&w.observe(y.current),()=>w.disconnect()},[]);async function k(w){if(w.preventDefault(),p(!0),c(null),u(null),!x){c("Please enter a valid email address.");return}o(!0);const{error:v}=await F.from("subscriptions").insert({email:a,source:s,created_at:new Date().toISOString()});if(o(!1),v){c("Subscription failed. Please try again.");return}u("You are subscribed. Check your inbox tomorrow morning."),r?.(a),i("")}return e.jsx(B.section,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.4},className:`w-full bg-white shadow-sm border border-gray-200 rounded-lg ${t??""}`,children:e.jsx("div",{className:"p-6 md:p-8 max-w-7xl mx-auto bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-serif text-gray-900 dark:text-white",children:"Stay Informed. Every Morning."}),e.jsx("p",{className:"mt-2 text-sm md:text-base text-gray-700 dark:text-slate-300 font-sans",children:"Concise AI-driven briefings on global news and markets with structured signals you can act on."}),e.jsx("span",{className:"mt-4 inline-block text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400",children:"FREE DAILY INTELLIGENCE REPORT"}),e.jsxs("ul",{className:"mt-4 list-disc pl-5 space-y-2 text-gray-800 dark:text-slate-200",children:[e.jsx("li",{children:"PESTLE overview"}),e.jsxs("li",{children:["Political motive detection",e.jsxs(ve,{to:"/pricing",className:"ml-2 inline-flex items-center rounded-full bg-indigo-50 text-indigo-700 text-xs px-2 py-0.5 hover:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Premium feature  view pricing",title:"View pricing",children:[e.jsx(Ws,{className:"w-3.5 h-3.5 mr-1","aria-hidden":"true"}),"Premium"]})]}),e.jsxs("li",{children:["Market impact signals",e.jsxs(ve,{to:"/pricing",className:"ml-2 inline-flex items-center rounded-full bg-indigo-50 text-indigo-700 text-xs px-2 py-0.5 hover:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Premium feature  view pricing",title:"View pricing",children:[e.jsx(Ws,{className:"w-3.5 h-3.5 mr-1","aria-hidden":"true"}),"Premium"]})]}),e.jsxs("li",{children:["Bias & framing analysis",e.jsxs(ve,{to:"/pricing",className:"ml-2 inline-flex items-center rounded-full bg-indigo-50 text-indigo-700 text-xs px-2 py-0.5 hover:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Premium feature  view pricing",title:"View pricing",children:[e.jsx(Ws,{className:"w-3.5 h-3.5 mr-1","aria-hidden":"true"}),"Premium"]})]})]}),e.jsxs("form",{onSubmit:k,className:"mt-6","aria-label":"Daily intelligence signup",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Vt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 dark:text-slate-400","aria-hidden":"true"}),e.jsx("input",{type:"email",value:a,onChange:w=>i(w.target.value),onBlur:()=>p(!0),placeholder:"Enter your email to subscribe","aria-label":"Email address","aria-invalid":m&&!x,"aria-describedby":"email-help",required:!0,className:`w-full pl-10 pr-3 py-2 rounded-md border text-gray-900 dark:text-slate-100 placeholder-gray-400 dark:placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-gray-900 dark:bg-slate-800 ${m&&!x?"border-red-500":"border-gray-300 dark:border-slate-700"}`})]}),e.jsx("button",{type:"submit",disabled:n,className:"rounded-md bg-gray-900 text-white hover:bg-gray-800 px-4 py-2 font-medium disabled:opacity-60 disabled:cursor-not-allowed",children:"Get Daily Briefing"})]}),e.jsx("p",{id:"email-help",className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"No spam. Unsubscribe anytime. Your email is never shared."}),e.jsxs(ye,{children:[l&&e.jsx(B.p,{role:"alert","aria-live":"polite",initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:6},className:"mt-2 text-sm text-red-600",children:l}),d&&e.jsx(B.p,{role:"alert","aria-live":"polite",initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:6},className:"mt-2 text-sm text-green-700",children:d})]})]})]})})})}const Wu="modulepreload",zu=function(s){return"/"+s},Qa={},Vu=function(t,r,a){let i=Promise.resolve();if(r&&r.length>0){let c=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");i=c(r.map(d=>{if(d=zu(d),d in Qa)return;Qa[d]=!0;const u=d.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":Wu,u||(p.as="script"),p.crossOrigin="",p.href=d,l&&p.setAttribute("nonce",l),document.head.appendChild(p),u)return new Promise((h,x)=>{p.addEventListener("load",h),p.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function n(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&n(l.reason);return t().catch(n)})};ge.lazy(()=>Vu(()=>Promise.resolve().then(()=>_u),void 0));const wt=10,Ku=s=>{const t=[],r=l=>s.find(c=>l.some(d=>c.name.toLowerCase().includes(d)))?.score??0,a=r(["source","selection"]),i=r(["context","omission"]),n=r(["emotional","language"]),o=Math.max(r(["rhetorical","persuasive"]),r(["political","messaging","coding"]));return a>=60&&t.push("Sources cited may be limited to a narrow range of perspectives (derived from Source Selection)."),i>=60&&t.push("Key background or historical context may be underrepresented."),o>=65&&n>=50&&t.push("The overall structure suggests an attempt to influence opinion, not just present information."),t.length===0&&t.push("No strong structural bias patterns detected beyond linguistic framing."),t.slice(0,3)},Gu=(s,t)=>{const r=s.toLowerCase();let a=50,i=50,n=s;r.includes("emotional")||r.includes("language")?(a=30,i=20,n="Emotional Language"):r.includes("contextual")||r.includes("omission")?(a=70,i=25,n="Context Omission"):r.includes("political")||r.includes("coding")?(a=45,i=70,n="Political Framing"):r.includes("rhetorical")||r.includes("intensity")?(a=60,i=65,n="Rhetorical Pressure"):(r.includes("source")||r.includes("sourcing"))&&(a=25,i=50,n="Source Bias");const o=8,l=(Math.random()-.5)*o,c=(Math.random()-.5)*o,d=f=>Math.max(wt,Math.min(100-wt,f)),u=d(a+l),m=d(i+c),p=t>=80?14:t>=60?10:t>=40?7:5,h=t>=80?.5:t>=60?.4:t>=40?.3:.2,x=[Math.max(wt,u-p),Math.min(100-wt,u+p)],g=[Math.max(wt,m-p),Math.min(100-wt,m+p)];return{x:u,y:m,label:n,intensity:t,radius:p,opacity:h,xRange:x,yRange:g}},Ju=s=>{const t=s.find(r=>r.name.toLowerCase().includes("context"))?.score??0;return t>=60?{present:!0,level:"High",items:["Significant historical background omitted","Key stakeholder perspectives missing"]}:t>=40?{present:!0,level:"Moderate",items:["Limited contextual background","Partial data framing"]}:{present:!1,level:"Low",items:[]}},Yu=s=>s>=80?"#10b981":s>=60?"#3b82f6":s>=40?"#f59e0b":"#ef4444",dr=s=>s>=80?"Strong":s>=60?"Moderate":s>=40?"Weak":"Minimal",Xu=({credibilityScore:s,manipulationScore:t=0,factors:r=[],redFlags:a=[],analystNote:i=null,sourceInfo:n})=>{const[o,l]=b.useState(0),[c,d]=b.useState(null),u=f=>f>=85?"Mostly Reliable":f>=60?"Some Bias Detected":"Low Reliability",m=f=>f>=85?"This article is mostly factual, with no strong signs of manipulation.":f>=60?"Key facts are present, but wording or emphasis may push a particular viewpoint.":"This content relies heavily on framing or selective facts. Do not treat it as objective truth.",p=s>=85?"#16a34a":s>=60?"#eab308":"#dc2626";b.useEffect(()=>{let f=0;const y=performance.now(),k=600,w=v=>{const S=Math.min(v-y,k);l(Math.round(S/k*s)),S<k&&(f=requestAnimationFrame(w))};return f=requestAnimationFrame(w),()=>cancelAnimationFrame(f)},[s]);const h=b.useMemo(()=>r.map(f=>({...Gu(f.name,f.score),score:f.score,color:Yu(f.score),name:f.name})),[r]),x=b.useMemo(()=>Ju(r),[r]),g=b.useMemo(()=>Ku(r),[r]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B.div,{className:"p-6 rounded-2xl bg-white dark:bg-slate-900/70 border border-slate-200 dark:border-slate-800 shadow-sm",initial:{opacity:0,y:8},animate:{opacity:1,y:0},children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-cyan-500"}),"Credibility Assessment"]}),e.jsx("span",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wide",children:"Single verdict for decision making"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-28 h-28 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-black text-slate-900 dark:text-white",children:o}),e.jsx("div",{className:"text-xs font-bold text-slate-500 dark:text-slate-400",children:"/ 100"})]})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 rounded-full border-2 border-white dark:border-slate-900",style:{backgroundColor:p},"aria-hidden":"true"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-extrabold text-slate-900 dark:text-white",children:u(s)}),e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-300 mt-1 max-w-xl",children:m(s)}),e.jsx("div",{className:"mt-3 text-xs text-slate-500 dark:text-slate-400",children:"* This assessment evaluates narrative framing and credibility signals  it does not determine factual truth."})]})]}),i?.guidance?e.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40 max-w-xl",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-300 mb-1",children:"Analyst Note"}),e.jsx("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:i.guidance})]}):null]})]}),e.jsxs(B.div,{className:"p-6 rounded-2xl bg-white dark:bg-slate-900/70 border border-slate-200 dark:border-slate-800 shadow-sm",initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.05},children:[e.jsxs("h4",{className:"text-sm font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4 text-indigo-500"}),"Key Signals Detected"]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3",children:[e.jsx("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(fe,{className:"w-4 h-4 mt-0.5 text-amber-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Some information may be missing"}),e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-300 mt-1",children:x.present?"Important background or alternative views may not be fully shown.":"No obvious missing context detected."})]})]})}),e.jsx("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(fe,{className:"w-4 h-4 mt-0.5 text-amber-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Emotional / persuasive pressure"}),e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-300 mt-1",children:r.some(f=>f.name.toLowerCase().includes("emotional")&&f.score>=40)||r.some(f=>f.name.toLowerCase().includes("rhetorical")&&f.score>=40)?"Wording appears designed to influence how you feel, not just inform.":"Language appears mostly neutral."})]})]})}),e.jsx("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ne,{className:"w-4 h-4 mt-0.5 text-emerald-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Source quality check"}),e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300 mt-1",children:[n?.isReputable?"Publisher signals look reputable.":"Publisher reputation signal is unclear."," ",n?.hasAuthor?"Author identified.":"Author not clearly identified."," ",n?.hasCitations?"Citations present.":"Few or no citations detected."]})]})]})})]})]}),e.jsx(B.div,{className:"p-0 rounded-2xl overflow-hidden border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900/70 shadow-sm",initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs("details",{children:[e.jsxs("summary",{className:"cursor-pointer select-none px-6 py-4 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-colors",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Detailed Diagnostics"}),e.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:"Expand to view charts & evidence"})]}),e.jsxs("div",{className:"px-6 pb-6 pt-2 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-5 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white mb-3",children:"Perspective Structure"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex flex-col justify-between items-center w-6",children:[e.jsx("span",{className:"text-[11px] text-slate-700 dark:text-slate-300 font-medium whitespace-nowrap",style:{writingMode:"vertical-rl",transform:"rotate(180deg)"},children:"Narrative"}),e.jsx("span",{className:"text-[11px] text-slate-700 dark:text-slate-300 font-medium whitespace-nowrap",style:{writingMode:"vertical-rl",transform:"rotate(180deg)"},children:"Informational"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"relative w-full h-64 rounded-lg border-2 border-slate-900 dark:border-slate-100 bg-white dark:bg-slate-950/20",children:[e.jsxs("svg",{className:"absolute inset-0 w-full h-full",preserveAspectRatio:"none",children:[[0,25,50,75,100].map(f=>e.jsx("line",{x1:`${f}%`,y1:"0%",x2:`${f}%`,y2:"100%",stroke:"currentColor",strokeWidth:"1",className:"text-slate-300 dark:text-slate-700"},`v-${f}`)),[0,25,50,75,100].map(f=>e.jsx("line",{x1:"0%",y1:`${f}%`,x2:"100%",y2:`${f}%`,stroke:"currentColor",strokeWidth:"1",className:"text-slate-300 dark:text-slate-700"},`h-${f}`))]}),h.map((f,y)=>e.jsx(B.div,{className:"absolute rounded-full cursor-pointer border-2 transition-all",style:{left:`${f.x}%`,top:`${100-f.y}%`,width:`${f.radius*2}px`,height:`${f.radius*2}px`,backgroundColor:f.color,opacity:c?.label===f.label?f.opacity+.2:f.opacity,borderColor:c?.label===f.label?f.color:"transparent",transform:"translate(-50%, -50%)"},initial:{opacity:0,scale:0},animate:{opacity:c?.label===f.label?f.opacity+.2:f.opacity,scale:1},transition:{duration:.5,ease:"easeOut"},whileHover:{scale:1.2,opacity:f.opacity+.3,borderColor:f.color},onMouseEnter:()=>d({label:f.label,x:f.x,y:f.y,score:f.score,color:f.color,name:f.name,radius:f.radius,opacity:f.opacity,xRange:f.xRange,yRange:f.yRange}),onMouseLeave:()=>d(null),title:`${f.label} - ${dr(f.score)} influence`},`${f.label}-${y}`))]}),e.jsxs("div",{className:"flex justify-between px-1 mt-1",children:[e.jsx("span",{className:"text-[11px] text-slate-700 dark:text-slate-300 font-medium",children:"Implicit"}),e.jsx("span",{className:"text-[11px] text-slate-700 dark:text-slate-300 font-medium",children:"Explicit"})]})]})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900/40 p-4 text-xs space-y-2",children:[e.jsx("div",{className:"font-bold text-slate-900 dark:text-white",children:"Influence Region Details"}),c?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Factor"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-white",children:c.name})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Label"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-white",children:c.label})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Intensity"}),e.jsxs("span",{className:"font-semibold text-slate-900 dark:text-white",children:[c.score,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Influence Level"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-white",children:dr(c.score)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Framing Range"}),e.jsxs("span",{className:"font-semibold text-slate-900 dark:text-white text-right",children:[c.x<50?"Implicit":"Explicit"," tendency"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Pressure Type"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-white text-right",children:c.y>50?"Narrative":"Informational"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Region Indicator"}),e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 rounded-full",style:{backgroundColor:c.color,opacity:c.opacity+.3}}),e.jsx("span",{className:"text-slate-900 dark:text-white",children:dr(c.score)})]})]})]}):e.jsx("div",{className:"text-slate-600 dark:text-slate-300",children:"Hover an influence region to see details."})]})]}),e.jsxs("div",{className:"mt-3 text-xs text-slate-600 dark:text-slate-300",children:["This chart shows ",e.jsx("strong",{children:"estimated influence regions"}),", not exact positions. Each area represents the ",e.jsx("strong",{children:"likely framing range"})," inferred from detected signals."]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center justify-center gap-3 text-[11px] text-slate-500 dark:text-slate-400 select-none",children:[e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 rounded-full bg-emerald-500",style:{opacity:.5}}),"Strong (80100)"]}),e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-blue-500",style:{opacity:.4}}),"Moderate (6079)"]}),e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-amber-500",style:{opacity:.3}}),"Weak (4059)"]}),e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500",style:{opacity:.2}}),"Minimal (< 40)"]})]})]}),e.jsxs("div",{className:"p-5 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white mb-3",children:"Linguistic Bias Indicators"}),a.length?e.jsx("div",{className:"flex flex-wrap gap-2",children:a.slice(0,8).map((f,y)=>e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-amber-50 text-amber-800 border border-amber-200 dark:bg-amber-900/20 dark:text-amber-200 dark:border-amber-800",children:f},y))}):e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:"No strong linguistic bias indicators detected."}),e.jsx("div",{className:"mt-3 text-xs text-slate-600 dark:text-slate-300",children:"Terms detected in the text that may suggest editorial framing."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-5 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white mb-3",children:"Structural Bias Signals"}),g.length?e.jsx("ul",{className:"list-disc ml-5 text-sm text-slate-700 dark:text-slate-300 space-y-1",children:g.slice(0,5).map((f,y)=>e.jsx("li",{children:f},y))}):e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:"No strong structural bias patterns detected beyond linguistic framing."})]}),e.jsxs("div",{className:"p-5 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white mb-3",children:"Publisher Intent"}),e.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300 space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Primary goal:"})," ",s>=80?"Inform":s>=60?"Inform / Persuade":"Persuade"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Tone:"})," ",s>=80?"Neutral / Factual":s>=60?"Mixed":"Subjective / Persuasive"]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full border ${n?.isReputable?"bg-emerald-50 text-emerald-800 border-emerald-200 dark:bg-emerald-900/20 dark:text-emerald-200 dark:border-emerald-800":"bg-slate-100 text-slate-700 border-slate-200 dark:bg-slate-800 dark:text-slate-200 dark:border-slate-700"}`,children:n?.isReputable?"Reputable":"Unknown"}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full border ${n?.hasAuthor?"bg-cyan-50 text-cyan-800 border-cyan-200 dark:bg-cyan-900/20 dark:text-cyan-200 dark:border-cyan-800":"bg-slate-100 text-slate-700 border-slate-200 dark:bg-slate-800 dark:text-slate-200 dark:border-slate-700"}`,children:n?.hasAuthor?"Author identified":"No author"}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full border ${n?.hasCitations?"bg-indigo-50 text-indigo-800 border-indigo-200 dark:bg-indigo-900/20 dark:text-indigo-200 dark:border-indigo-800":"bg-slate-100 text-slate-700 border-slate-200 dark:bg-slate-800 dark:text-slate-200 dark:border-slate-700"}`,children:n?.hasCitations?"Citations present":"No citations"})]})]})]})]})]})})]})},Qu=({text:s,icon:t=qr})=>e.jsxs("div",{"aria-label":"Verdict",className:"px-4 py-3 bg-blue-50 dark:bg-blue-900/20 border-b border-blue-100 dark:border-blue-800 flex items-center gap-2 text-lg font-semibold text-slate-900 dark:text-slate-100",title:"This is the key takeaway based on data analysis. Hover for more context on what this section reveals.",children:[t&&e.jsx(t,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),s||"Insufficient information. Review sources and timeline."]}),Zu=({children:s,rootMargin:t="200px"})=>{const r=ge.useRef(null),[a,i]=ge.useState(!1);return ge.useEffect(()=>{if(!r.current)return;const n=new IntersectionObserver(o=>{o.forEach(l=>{l.isIntersecting&&(i(!0),r.current&&n.unobserve(r.current))})},{rootMargin:t});return n.observe(r.current),()=>{r.current&&n.unobserve(r.current)}},[t]),e.jsx("div",{ref:r,children:a?s:e.jsx("div",{className:"p-6 text-slate-400 dark:text-slate-500 text-sm",children:"Loading section"})})};ge.memo(s=>e.jsx(ln,{...s}));ge.memo(s=>e.jsx(cn,{...s}));ge.memo(s=>e.jsx(dn,{...s}));const Za={Political:{color:"#3b82f6",icon:Je,description:"Regulatory environment and government policy shifts"},Economic:{color:"#10b981",icon:Te,description:"Market dynamics and macroeconomic trends"},Social:{color:"#f59e0b",icon:Is,description:"Cultural shifts and demographic changes"},Technological:{color:"#8b5cf6",icon:nt,description:"Innovation and digital transformation impact"},Legal:{color:"#ec4899",icon:Ne,description:"Compliance requirements and legal framework"},Environmental:{color:"#14b8a6",icon:ot,description:"Sustainability and climate-related factors"}},eh=s=>{if(!s)return null;if(s.dominantDriver||s.incentiveStack)return s;const t={};if(s.dominant_driver||s.dominantDriver){const r=s.dominant_driver||s.dominantDriver;t.dominantDriver={type:r.type||r.driver_type||"Unknown",confidence:r.confidence||0,explanation:r.explanation||r.rationale||""}}if(s.incentive_stack||s.incentiveStack){const r=s.incentive_stack||s.incentiveStack;t.incentiveStack={economic:r.economic||r.capital_incentive||0,socialPositioning:r.socialPositioning||r.social_positioning||r.status_engineering||0,politicalSignaling:r.politicalSignaling||r.political_signaling||r.political_leverage||0,ideologicalControl:r.ideologicalControl||r.ideological_control||r.cognitive_dominance||0}}if(s.behavioral_pattern||s.behavioralPattern){const r=s.behavioral_pattern||s.behavioralPattern;t.behavioralPattern={framingTechniques:r.framingTechniques||r.framing_techniques||r.perception_framing||[],omissions:r.omissions||r.information_suppression||[],emotionalTriggers:r.emotionalTriggers||r.emotional_triggers||r.psychological_triggers||[]}}if(s.power_amplification||s.powerAmplification){const r=s.power_amplification||s.powerAmplification;t.powerAmplification={actors:(r.actors||[]).map(a=>({name:a.name||"",category:a.category||"Media",incentiveAlignment:a.incentiveAlignment||a.incentive_alignment||0,distributionPower:a.distributionPower||a.distribution_power||0,isInferred:a.isInferred??a.is_inferred??!1,evidence:a.evidence||[],source:a.source||(a.isInferred?"Inferred":"Explicit")}))}}if(s.strategic_consequence||s.strategicConsequence){const r=s.strategic_consequence||s.strategicConsequence;t.strategicConsequence={shortTermEffect:r.shortTermEffect||r.short_term_effect||r.short_term||"",mediumTermRisk:r.mediumTermRisk||r.medium_term_risk||r.medium_term||"",longTermDistortion:r.longTermDistortion||r.long_term_distortion||r.long_term||""}}return Object.keys(t).length>0?t:null},th=s=>{let t;s.mode==="auto-upgraded"&&s.full?t={...s.full,mode:"full",wasAutoUpgraded:!0}:s.data?t={...s.data,mode:s.mode||"lite"}:t={...s,mode:s.mode||"lite"},t.summary&&(t.summary.oneLineSummary&&!t.summary.executiveSummary&&(t.summary.executiveSummary=t.summary.oneLineSummary),t.summary.context&&!t.summary.relatedEntities&&(t.summary.relatedEntities=t.summary.context));const r=t?.hiddenMotives||t?.hidden_motives||t?.motive||null;if(r){const a=eh(r);a&&(t.hiddenMotives=a)}else console.warn(" No Hidden Motives data found in any expected location");return t.mode||(t.mode="full"),t},We=({icon:s,title:t,subtitle:r,isActive:a,isLast:i,children:n,verdictText:o,beginnerBullets:l,id:c})=>e.jsxs("div",{id:c,className:"relative flex gap-6 md:gap-10 scroll-mt-24",children:[e.jsxs("div",{className:"flex flex-col items-center w-6 cursor-pointer",role:"button",tabIndex:0,onClick:()=>{if(c){const d=document.getElementById(c);d&&d.scrollIntoView({behavior:"smooth",block:"start"})}},onKeyDown:d=>{if(d.key==="Enter"&&c){const u=document.getElementById(c);u&&u.scrollIntoView({behavior:"smooth",block:"start"})}},children:[e.jsx("div",{className:"w-[3px] h-[3px] rounded-full bg-blue-500"}),!i&&e.jsx("div",{className:"flex-grow my-2 rounded-full",style:{width:"2px",background:"linear-gradient(to bottom, rgba(59,130,246,0.5), rgba(59,130,246,0.15))"}})]}),e.jsxs("div",{className:"flex-grow pb-16",children:[e.jsxs("div",{className:"mb-4 pt-1",children:[e.jsx("h2",{className:`text-2xl font-extrabold transition-colors duration-500 ${a?"text-slate-900 dark:text-white":"text-slate-400 dark:text-slate-600"}`,children:t}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:r})]}),e.jsxs(B.div,{initial:{opacity:0,y:12},whileInView:{opacity:1,y:0},viewport:{once:!0,margin:"-50px 0px"},transition:{duration:.45},className:"bg-white dark:bg-slate-900/70 rounded-2xl shadow-xl border border-slate-100 dark:border-slate-800 overflow-hidden backdrop-blur-lg",children:[e.jsx(Qu,{text:o}),n]})]})]}),sh=({factor:s,impact:t,agency:r,actionable:a,vulnerability:i})=>{const n=t>=60,o=t>=40,l=r>=.6,c=r>=.4;return n&&l?{classification:" Attack Zone",primaryAdvice:`High controllability (${Math.round(r*100)}%). Invest resources proactively to exploit this ${a}-point opportunity. Build competitive advantage here.`,actionType:"attack",urgency:"high"}:n&&!c?{classification:" Defend Zone",primaryAdvice:`Low controllability (${Math.round(r*100)}%). High vulnerability (${i}). URGENT: Build hedges, diversify exposure, establish contingency plans.`,actionType:"defend",urgency:"critical"}:n&&c?{classification:" Strategic Priority",primaryAdvice:`Moderate controllability (${Math.round(r*100)}%). Balance offense (A=${a}) with defense (V=${i}). Invest in improving control while hedging downside.`,actionType:"strategic",urgency:"high"}:o&&l?{classification:" Tactical Opportunity",primaryAdvice:`High controllability (${Math.round(r*100)}%). Execute tactical initiatives with minimal risk. Quick wins available here.`,actionType:"attack",urgency:"medium"}:o&&!c?{classification:" Monitor & Hedge",primaryAdvice:`Limited control (${Math.round(r*100)}%). Monitor closely and maintain defensive positions. Vulnerability=${i} requires attention.`,actionType:"defend",urgency:"medium"}:!o&&l?{classification:" Routine Management",primaryAdvice:`Low impact (${t}), high control (${Math.round(r*100)}%). Standard operating procedures sufficient. Low priority.`,actionType:"monitor",urgency:"low"}:!o&&!c?{classification:" Low Priority",primaryAdvice:`Low impact (${t}) and limited control (${Math.round(r*100)}%). Monitor passively. Redirect resources to higher-priority factors.`,actionType:"monitor",urgency:"low"}:{classification:" Balanced Approach",primaryAdvice:`Moderate impact (${t}) and control (${Math.round(r*100)}%). Maintain balanced strategy: pursue opportunities (A=${a}) while managing risks (V=${i}).`,actionType:"strategic",urgency:"medium"}},rh=({pestle:s,canAccessDetails:t,onSelectFactor:r})=>{if(!s)return e.jsxs("div",{className:"p-8 text-center bg-slate-50 dark:bg-slate-900/30 rounded-xl border-2 border-dashed border-slate-300 dark:border-slate-700",children:[e.jsx(Je,{className:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"PESTLE data not available for this article."})]});const[a,i]=b.useState(null),[n,o]=b.useState(null),[l,c]=b.useState(new Set),d=b.useRef(null),u=b.useRef(null),[m,p]=b.useState(!1),[h,x]=b.useState(!1),g=v=>Math.max(0,Math.min(1,v)),f=(v,S=[],_)=>{const E=(S||[]).join(" ").toLowerCase(),$=["hedge","insurance","derivative","swap","futures","contract","diversif","offset"],T=["ban","sanction","export control","embargo","war","conflict","military","coup"],P=["alternative","substitut","multiple suppliers","reroute","shift supply","pivot","replace"],q=["single source","bottleneck","shortage","scarce","locked","dependency"],N=["lobby","policy dialogue","regulator engagement","standard setting","partnership","market leader"],R=["unilateral","mandatory","forced","no appeal","sudden"],V=["rapid","immediately","fast","short cycle","agile","reprice"],W=["delay","long cycle","slow","months","multi-year"],K=(I,G)=>{let Q=0;for(const he of I)E.includes(he)&&(Q+=1);for(const he of G)E.includes(he)&&(Q-=1);return Q},be=K($,T),Z=K(P,q),X=K(N,R),ce=K(V,W);let A=.5;v==="Political"&&(A=.35),v==="Legal"&&(A=.4),v==="Economic"&&(A=.55),v==="Technological"&&(A=.52),v==="Social"&&(A=.45),v==="Environmental"&&(A=.42);const M=.12*be+.1*Z+.08*X+.08*ce,C=(_||"").toLowerCase().includes("high")&&(E.includes("mandatory")||E.includes("regulation"))?-.06:0;return g(A+M+C)},y=v=>{const{cx:S,cy:_,payload:E}=v;if(S==null||_==null||!E)return null;const T=2.5+(typeof E.control=="number"?E.control:.5)*5.5,P=E.factor===n||E.factor===a;return e.jsx("circle",{cx:S,cy:_,r:P?T+1.2:T,fill:E.color||"#64748b",fillOpacity:P?.95:.7,stroke:"rgba(15, 23, 42, 0.35)",strokeWidth:P?1.4:.8})},k=Object.entries(Za).map(([v,S])=>{const _=v.toLowerCase(),E=s&&s[_]||{score:0,impact:"low",factors:[]},$=E.score??0,T=t?$:Math.round($*.65),P=t?f(v,E.factors||[],E.impact):.45,q=Math.round(T*P),N=Math.round(T*(1-P));return{factor:v,value:T,highlightValue:n===v?T:0,fullValue:$,impact:E.impact||"low",color:S.color,description:S.description,icon:ge.createElement(S.icon,{className:"w-5 h-5"}),factors:E.factors||[],control:P,controlPct:Math.round(P*100),actionable:q,vulnerability:N}}),w=v=>{const S=[],_=[],E=["opportunity","growth","increase","support","favorable","stability","benefit","improve","positive"],$=["risk","decline","decrease","sanction","uncertainty","cost","regulation","pressure","constraint","volatility","conflict","delay","negative"];return v.forEach(T=>{const P=(T||"").toLowerCase();E.some(q=>P.includes(q))?S.push(T):$.some(q=>P.includes(q))?_.push(T):(S.length<=_.length?S:_).push(T)}),{pros:S,cons:_}};return b.useEffect(()=>{const v=(E,$)=>{if(!E.current)return;const T=new IntersectionObserver(P=>{P.forEach(q=>{q.isIntersecting&&($(!0),E.current&&T.unobserve(E.current))})},{threshold:.2});return T.observe(E.current),()=>{E.current&&T.unobserve(E.current)}},S=v(d,p),_=v(u,x);return()=>{S&&S(),_&&_()}},[]),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700 dark:text-slate-100 flex items-center gap-2",children:[e.jsx(Os,{className:"w-4 h-4"})," How Strong Each Force Is"]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-slate-300",children:"Click a bar to expand"})]}),e.jsx("div",{ref:d,style:{minHeight:"360px",height:"360px"},className:"bg-white dark:bg-slate-900/70 rounded-lg p-3 border border-slate-200 dark:border-slate-700",children:e.jsx(yr,{width:"100%",height:"100%",children:e.jsxs(Io,{data:k,layout:"vertical",margin:{top:8,right:24,left:60,bottom:8},children:[e.jsx(Pi,{strokeDasharray:"3 3",stroke:"#e5e7eb",className:"dark:stroke-slate-700"}),e.jsx(Oi,{type:"number",domain:[0,100],tick:{fontSize:13}}),e.jsx(Ri,{type:"category",dataKey:"factor",tick:{fontSize:13},width:90}),e.jsx(_s,{contentStyle:{backgroundColor:"rgba(255,255,255,0.95)",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:v=>[`${v}/100`,"Impact Score"]}),e.jsx($o,{dataKey:"value",radius:[0,4,4,0],isAnimationActive:m,animationDuration:350,onClick:v=>{const S=v&&v.payload&&v.payload.factor||null;i(S),r(S)},cursor:"pointer",children:k.map((v,S)=>e.jsx(Ii,{fill:v.color,stroke:n===v.factor?v.color:void 0,strokeWidth:n===v.factor?2:0,fillOpacity:n===v.factor?.9:.7},`cell-${S}`))})]})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-slate-100",children:"Impact vs. Control Map"}),e.jsxs("div",{ref:u,style:{minHeight:"650px",minWidth:"650px",aspectRatio:"1 / 1",overflow:"visible"},className:"bg-white dark:bg-slate-900/70 rounded-lg p-6 border border-slate-200 dark:border-slate-700 mx-auto",children:[e.jsx(yr,{width:"100%",aspect:1,minWidth:650,minHeight:650,children:e.jsxs(Ti,{data:k,outerRadius:"52%",margin:{top:100,right:100,bottom:100,left:100},children:[e.jsx(Ci,{stroke:"#cbd5e1",className:"dark:stroke-slate-700"}),e.jsx(Ai,{dataKey:"factor",tick:{fontSize:12,fill:"currentColor"},tickLine:!1}),e.jsx(Lo,{domain:[0,100],tick:{fontSize:11}}),e.jsx(_s,{contentStyle:{backgroundColor:"rgba(255,255,255,0.95)",border:"1px solid #e5e7eb",borderRadius:"8px"},formatter:(v,S,_)=>{const E=_?.payload;return E?[`Impact ${E.value}/100  Agency ${E.controlPct}%  A=${E.actionable}  V=${E.vulnerability}`,E.factor]:[v,S]}}),e.jsx(br,{name:"Impact",dataKey:"value",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.28,isAnimationActive:h,animationDuration:500,dot:e.jsx(y,{})}),e.jsx(br,{name:"Highlight",dataKey:"highlightValue",stroke:"#f59e0b",fill:"#f59e0b",fillOpacity:n?.35:0,isAnimationActive:!1,dot:!1})]})}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-[11px] text-slate-600 dark:text-slate-200",children:[e.jsx("span",{children:"Dot size = How much control you have"}),e.jsx("span",{children:"Bigger dot  You can act"}),e.jsx("span",{children:"Smaller dot  You must defend"})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:k.map((v,S)=>{const _=sh({factor:v.factor,impact:v.value,agency:v.control,actionable:v.actionable,vulnerability:v.vulnerability}),{pros:E,cons:$}=w(v.factors||[]),T=l.has(v.factor),q={attack:{bg:"bg-emerald-100 dark:bg-emerald-900/30",border:"border-emerald-300 dark:border-emerald-700",text:"text-emerald-700 dark:text-emerald-300",icon:"",label:"ATTACK"},defend:{bg:"bg-red-100 dark:bg-red-900/30",border:"border-red-300 dark:border-red-700",text:"text-red-700 dark:text-red-300",icon:"",label:"DEFEND (Protect)"},strategic:{bg:"bg-amber-100 dark:bg-amber-900/30",border:"border-amber-300 dark:border-amber-700",text:"text-amber-700 dark:text-amber-300",icon:"",label:"STRATEGIC (Selective Action)"},monitor:{bg:"bg-slate-100 dark:bg-slate-900/30",border:"border-slate-300 dark:border-slate-700",text:"text-slate-600 dark:text-slate-400",icon:"",label:"MONITOR"}}[_.actionType];return e.jsxs(B.div,{onHoverStart:()=>o(v.factor),onHoverEnd:()=>o(null),className:`rounded-xl border-2 transition-all duration-200 ${a===v.factor?"bg-slate-50 dark:bg-slate-900/40 border-slate-300 dark:border-slate-600 shadow-lg":"bg-white dark:bg-slate-900/30 border-gray-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600"}`,children:[e.jsx("button",{onClick:()=>{i(v.factor),r(v.factor)},className:"w-full p-4 text-left",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-sm font-bold uppercase tracking-wide",style:{color:v.color},children:v.factor}),e.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider rounded-full border ${q.bg} ${q.border} ${q.text}`,children:[e.jsx("span",{children:q.icon}),e.jsx("span",{children:q.label})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl font-black text-slate-900 dark:text-white tabular-nums",children:v.value}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-2 bg-slate-200 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${v.value}%`,background:`linear-gradient(90deg, ${v.color}dd, ${v.color})`}})}),e.jsx("div",{className:"text-[10px] text-slate-500 dark:text-slate-500 mt-0.5",children:"Impact Score"})]})]})]}),e.jsx("button",{onClick:N=>{N.stopPropagation();const R=new Set(l);R.has(v.factor)?R.delete(v.factor):R.add(v.factor),c(R)},className:"p-1.5 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors","aria-label":T?"Collapse details":"Expand details",children:e.jsx(B.div,{animate:{rotate:T?180:0},transition:{duration:.2},children:e.jsx("svg",{className:"w-4 h-4 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})})]})}),e.jsx(ye,{children:T&&e.jsx(B.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:`mb-3 p-3 rounded-lg border ${_.urgency==="critical"?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":_.urgency==="high"?"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800":_.urgency==="medium"?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"bg-slate-50 dark:bg-slate-900/40 border-slate-200 dark:border-slate-700"}`,children:[e.jsx("div",{className:`text-xs font-bold mb-1 ${_.urgency==="critical"?"text-red-700 dark:text-red-300":_.urgency==="high"?"text-amber-700 dark:text-amber-300":_.urgency==="medium"?"text-blue-700 dark:text-blue-300":"text-slate-700 dark:text-slate-300"}`,children:_.classification}),e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-400 leading-relaxed",children:[_.primaryAdvice.split(".").slice(0,2).join("."),"."]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"text-center p-2 bg-slate-50 dark:bg-slate-900/40 rounded-lg",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-500 mb-0.5",children:"Agency"}),e.jsxs("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:[v.controlPct,"%"]})]}),e.jsxs("div",{className:"text-center p-2 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg",children:[e.jsx("div",{className:"text-xs text-emerald-600 dark:text-emerald-400 mb-0.5",children:"Attack (A)"}),e.jsx("div",{className:"text-sm font-bold text-emerald-700 dark:text-emerald-300",children:v.actionable})]}),e.jsxs("div",{className:"text-center p-2 bg-rose-50 dark:bg-rose-900/20 rounded-lg",children:[e.jsx("div",{className:"text-xs text-rose-600 dark:text-rose-400 mb-0.5",children:"Defend (V)"}),e.jsx("div",{className:"text-sm font-bold text-rose-700 dark:text-rose-300",children:v.vulnerability})]})]}),t?e.jsxs("div",{className:"space-y-3",children:[E.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-emerald-500"}),e.jsx("div",{className:"text-[11px] font-bold uppercase tracking-wider text-emerald-700 dark:text-emerald-400",children:"Upside Drivers"})]}),e.jsx("ul",{className:"space-y-1.5 pl-3",children:(E.length?E:[Za[v.factor].description]).slice(0,2).map((N,R)=>e.jsxs("li",{className:"text-xs text-slate-600 dark:text-slate-400 leading-relaxed",children:[" ",N]},`pro-${R}`))})]}),$.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-rose-500"}),e.jsx("div",{className:"text-[11px] font-bold uppercase tracking-wider text-rose-700 dark:text-rose-400",children:"Downside Risks"})]}),e.jsx("ul",{className:"space-y-1.5 pl-3",children:$.slice(0,2).map((N,R)=>e.jsxs("li",{className:"text-xs text-slate-600 dark:text-slate-400 leading-relaxed",children:[" ",N]},`con-${R}`))})]})]}):e.jsxs("div",{className:"p-4 text-center bg-slate-50 dark:bg-slate-900/40 rounded-lg border border-slate-200 dark:border-slate-800",children:[e.jsx(pe,{className:"w-6 h-6 text-slate-300 dark:text-slate-600 mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-semibold",children:"Tactical details locked"}),e.jsx("p",{className:"text-[10px] text-slate-400 dark:text-slate-500 mt-1",children:"Upgrade to see drivers & risks"})]})]})})})]},S)})})]})},ah=()=>{const{plan:s,loading:t,canAccess:r}=ct(),[a,i]=b.useState(null),[n,o]=b.useState(!0),[l,c]=b.useState(null),d=b.useRef(null),{scrollYProgress:u}=mo({target:d,layoutEffect:!1}),m=xo(u,{stiffness:100,damping:30,restDelta:.001});b.useEffect(()=>{if(typeof window>"u"){o(!1);return}try{const A=sessionStorage.getItem("analysisResult");if(!A){console.warn(" No analysis result in session - user may have navigated directly to /results"),o(!1);return}const M=JSON.parse(A),C=th(M);i(C)}catch(A){console.error(" Failed to restore session:",A);try{sessionStorage.removeItem("analysisResult")}catch(M){console.error("Failed to clear corrupted session:",M)}}finally{o(!1)}},[]);const{summary:p={},credibility:h={},pestle:x,marketImpact:g,partyImpact:f,chronos:y,entropy:k,motive:w,ouroboros:v}=a||{},S=a?.hiddenMotives||null,_=a?.mode||"lite",E=a?.trialContext?.isTrial||!1;S&&(S.powerAmplification?S.powerAmplification.actors||(S.powerAmplification.actors=a?.powerAmplification?.actors||[]):S.powerAmplification={actors:a?.powerAmplification?.actors||[]});const $=b.useMemo(()=>{if(!x)return;const A=Object.entries(x).map(([C,I])=>({k:C,s:typeof I?.score=="number"?I.score:-1})).filter(C=>C.s>=0);if(!A.length)return;A.sort((C,I)=>I.s-C.s);const M=A[0];return M?M.k.charAt(0).toUpperCase()+M.k.slice(1):void 0},[x]),T=A=>_==="full"?!0:_==="standard"?!["market_impact","stakeholder_impact","predictive_modeling","pdf_export"].includes(A):["summary","credibility","hidden_motive_lite","csv_export"].includes(A),P=A=>T(A);if(t||n)return e.jsx("div",{className:"min-h-screen bg-slate-50 dark:bg-gray-950 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(!a)return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-gray-950 flex items-center justify-center text-slate-400",children:[e.jsx(fe,{className:"w-5 h-5 mr-2"})," No Analysis Data Found"]});const q=()=>{try{window.print()}catch{z.error("Download failed. Please use browser print to save as PDF.")}},N=()=>{try{const A=a||{},C=[["title",String(A?.summary?.title??"")],["timeframe",String(A?.summary?.timeframe??"")],["executiveSummary",String(A?.summary?.executiveSummary??"")],["accuracy",String(A?.summary?.accuracy??"")],["dataPoints",String(A?.summary?.dataPoints??"")]].map(([he,dt])=>`"${he.replace(/"/g,'""')}","${dt.replace(/"/g,'""')}"`).join(`
`),I=new Blob([C],{type:"text/csv;charset=utf-8;"}),G=URL.createObjectURL(I),Q=document.createElement("a");Q.href=G,Q.download="analysis-summary.csv",document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),URL.revokeObjectURL(G),z.success("CSV exported")}catch{z.error("CSV export failed")}},R=async()=>{const A={title:a?.summary?.title||"Intelligence Report",text:"NexVeris Intelligence Report",url:window.location.href};try{navigator.share?await navigator.share(A):(await navigator.clipboard.writeText(A.url),z.success("Link copied to clipboard"))}catch{z.error("Share failed")}},W=(()=>{const A=typeof k?.signalToNoise=="number"?k.signalToNoise:typeof p?.accuracy=="number"?p.accuracy:void 0;if(A==null)return;let M="LOW";return A>=70?M="HIGH":A>=40&&(M="MEDIUM"),{rawScore:A,normalizedScore:A/10,label:M}})(),K=W?W.label==="HIGH"?"High-impact signal; active review recommended":W.label==="MEDIUM"?"Base-case modifier; monitor developments":"Background context; no action required":"Insufficient data to determine posture";W&&(W.label==="HIGH"||W.label);const Z=W?((A,M)=>{const C=Math.round(A*2)/2;if(M==="HIGH"){const Q=Math.max(0,(C-7)/.5);return`hsl(0, 75%, ${Math.max(38,Math.min(62,52-Q*1.5))}%)`}if(M==="MEDIUM"){const Q=Math.max(0,(C-4)/.5);return`hsl(48, 90%, ${Math.max(40,Math.min(65,52-Q*1.2))}%)`}const I=Math.max(0,C/.5);return`hsl(140, 45%, ${Math.max(38,Math.min(62,50-I*1))}%)`})(W.normalizedScore,W.label):"#64748b",X={timeframe:p?.timeframe??"Not detected in source",locationEntities:p?.relatedEntities??"Not detected in source",takeawayNote:p?.executiveSummary||"Executive summary not available."},ce=p?.keyPoints&&p.keyPoints.length>0?p.keyPoints:X.takeawayNote.split(/[.;]\s+/).map(A=>A.trim()).filter(A=>A).slice(0,5);return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-gray-950 dark:text-slate-100 selection:bg-blue-100 dark:selection:bg-blue-900 transition-colors",children:[a&&e.jsxs("div",{className:"hidden","data-session-anchor":"true","aria-hidden":"true",children:[e.jsx("span",{"data-timestamp":a.timestamp,children:a.timestamp}),e.jsx("span",{"data-mode":a.mode,children:a.mode}),e.jsx("span",{"data-user":a.userId,children:a.userId})]}),e.jsxs("header",{className:"sticky top-0 z-40 bg-white/95 dark:bg-slate-900/80 backdrop-blur-sm border-b border-slate-200 dark:border-slate-800",children:[e.jsx(B.div,{className:"absolute bottom-0 left-0 right-0 h-1 bg-blue-500 origin-[0%] transform",style:{scaleX:m}}),e.jsxs("div",{className:"max-w-6xl mx-auto flex justify-between items-center px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>window.history.back(),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:e.jsx(At,{className:"w-5 h-5 text-slate-600 dark:text-slate-300"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-slate-900 dark:text-white truncate max-w-md",children:p?.title||"Intelligence Report"}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1",children:[e.jsx(Le,{className:"w-3 h-3"})," NexVeris AI Report  ",new Date().toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[P("pdf_export")&&e.jsx("button",{onClick:q,className:"p-2 text-slate-500 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg",title:"Download PDF",children:e.jsx(Si,{className:"w-5 h-5"})}),P("csv_export")&&e.jsx("button",{onClick:N,className:"p-2 text-slate-500 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg",title:"Export CSV",children:e.jsx(Le,{className:"w-5 h-5"})}),e.jsx("button",{onClick:R,className:"p-2 text-slate-500 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg",title:"Share Report",children:e.jsx(fo,{className:"w-5 h-5"})}),!P("stakeholder_impact")&&e.jsxs("button",{onClick:()=>window.location.href="/pricing",className:"px-3 py-1.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold rounded-lg text-sm hover:from-blue-700 hover:to-purple-700 transition-colors flex items-center",children:[e.jsx(it,{className:"w-4 h-4 mr-1"})," Upgrade"]})]})]})]}),e.jsxs("main",{ref:d,className:"max-w-7xl mx-auto px-6 py-12 space-y-12",children:[e.jsxs("section",{"aria-labelledby":"decision-summary",className:"bg-slate-50 dark:bg-slate-900/40 border-l-4 border-blue-600 rounded-r-xl p-6 shadow-lg",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-widest text-blue-600 dark:text-blue-400 font-bold mb-3",children:" 30-second Decision Summary  Read this first"}),e.jsx("h2",{id:"decision-summary",className:"sr-only",children:"Decision Summary / One-Minute Intelligence Takeaway"}),e.jsx("p",{className:"text-base font-bold text-slate-900 dark:text-white mb-4 leading-relaxed",children:W?W.label==="HIGH"?e.jsx(e.Fragment,{children:"Treat as a high-impact signal. Structural implications are material and may require near-term exposure review."}):W.label==="MEDIUM"?e.jsx(e.Fragment,{children:"Treat as a base-case modifier. No immediate repositioning is required, but developments should be actively monitored."}):e.jsx(e.Fragment,{children:"Treat as background context. This signal has limited decision relevance at the current stage."}):e.jsx(e.Fragment,{children:"Insufficient information to support a decision-relevant assessment."})}),e.jsxs("ul",{className:"text-sm text-slate-800 dark:text-slate-200 space-y-2 pl-0 list-none",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(ze,{className:"w-4 h-4 mt-0.5 text-blue-600 dark:text-blue-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{children:"SIGNAL STRENGTH:"})," ",W?`${W.label} (${W.rawScore}/100)`:"Insufficient"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(fe,{className:"w-4 h-4 mt-0.5 text-amber-600 dark:text-amber-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{children:"PRIMARY DRIVER:"})," ",$||"Not detected"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(we,{className:"w-4 h-4 mt-0.5 text-emerald-600 dark:text-emerald-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{children:"POSITIONING POSTURE:"})," ",K]})]})]}),e.jsxs("div",{className:"mt-5 pt-4 border-t border-slate-200 dark:border-slate-700 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("span",{className:"font-semibold text-slate-900 dark:text-white",children:"Decision context:"})," ",W?.label==="HIGH"?"This signal has potential structural impact. Acting without full context increases execution risk.":W?.label==="MEDIUM"?"This signal may influence positioning if secondary effects materialize.":"This information is likely background context unless conditions change."]}),!P("stakeholder_impact")&&e.jsxs("div",{className:"rounded-lg border border-amber-300/40 bg-amber-50/60 dark:bg-amber-900/20 p-3 text-sm text-amber-900 dark:text-amber-200",children:[e.jsx("strong",{children:"You are currently deciding with partial visibility."}),e.jsx("br",{}),"Power dynamics, second-order effects, and market transmission paths are not included at your current tier."]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"NexVeris does not give recommendations  only decision-grade context."}),!P("stakeholder_impact")&&e.jsx("button",{onClick:()=>window.location.href="/pricing",className:`px-4 py-2 rounded-lg text-sm font-semibold
                   bg-gradient-to-r from-blue-600 to-purple-600
                   text-white hover:from-blue-700 hover:to-purple-700 transition`,children:"Reduce Decision Risk"})]})]})]}),e.jsxs("section",{className:"bg-white dark:bg-slate-900/70 rounded-3xl p-8 shadow-2xl border border-slate-100 dark:border-slate-800 backdrop-blur-lg",children:[e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-blue-600 text-white text-sm font-bold uppercase",children:[e.jsx(ot,{className:"w-4 h-4"})," Complete AI Analysis Workflow"]})}),e.jsx("h2",{className:"text-4xl font-extrabold text-slate-900 dark:text-white mb-4",children:p?.title||"Detailed Intelligence Report"}),e.jsxs("p",{className:"text-xl text-slate-600 dark:text-slate-300 border-l-4 border-blue-500 pl-4 py-2 bg-blue-50/50 dark:bg-blue-900/20 rounded-md",children:[e.jsx("strong",{children:"Executive Summary:"})," ",p?.executiveSummary||"Analysis is pending or data is incomplete."]})]}),e.jsxs("section",{className:"space-y-12",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl p-4 shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:"Analysis Workflow"}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"From basic signal to future prediction"})]}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:[{label:"1. Signal",desc:"Information strength check",feature:null},{label:"2. Source",desc:"Credibility verification",feature:null},{label:"3. Forces",desc:"External macro drivers",feature:null},{label:"4. Framing",desc:"Why told this way",feature:"hidden_motive_full"},{label:"5. Power",desc:"Who has influence",feature:"stakeholder_impact"},{label:"6. Market",desc:"Financial impact",feature:"market_impact"},{label:"7. Future",desc:"Prediction paths",feature:"predictive_modeling"}].map((A,M)=>{const C=A.feature&&!P(A.feature);return e.jsxs("div",{className:`text-center p-2 rounded-lg border transition-shadow ${C?"bg-slate-50 dark:bg-slate-900/10 border-slate-200 dark:border-slate-700 opacity-60 cursor-not-allowed":"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border-blue-200 dark:border-blue-800 hover:shadow-md cursor-pointer"}`,title:`Step ${M+1}: ${A.desc}${C?" (Locked - Upgrade to unlock)":" - Click to navigate"}`,onClick:()=>{if(!C){const I=`step-${M+1}`,G=document.getElementById(I);G&&G.scrollIntoView({behavior:"smooth",block:"start"})}},children:[e.jsxs("div",{className:`text-xs font-bold ${C?"text-slate-400 dark:text-slate-500":"text-blue-600 dark:text-blue-400"} flex items-center justify-center gap-1`,children:[C&&e.jsx(pe,{className:"w-3 h-3"}),A.label]}),e.jsx("div",{className:`text-[10px] mt-1 leading-tight ${C?"text-slate-400 dark:text-slate-500":"text-slate-600 dark:text-slate-400"}`,children:A.desc})]},M)})})]}),e.jsxs("div",{className:"mb-8 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-4",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white mb-2",children:"How to read this analysis (30 seconds)"}),e.jsxs("ol",{className:"text-sm text-slate-700 dark:text-slate-300 space-y-1 list-decimal list-inside",children:[e.jsxs("li",{children:["Start with ",e.jsx("strong",{children:"Decision Summary"})," to understand how to treat this information."]}),e.jsxs("li",{children:["Review ",e.jsx("strong",{children:"Steps 13"})," for signal strength and macro drivers."]}),e.jsxs("li",{children:["Use ",e.jsx("strong",{children:"Steps 47"})," only if you need deeper narrative, power, or scenario context."]})]})]}),e.jsx(We,{icon:nt,title:"1. Situation Brief",subtitle:"Basic check: How strong is the information signal? (From noise to actionable insight)",id:"step-1",verdictText:pu(W),beginnerBullets:[`Timeframe: ${X.timeframe||"Unknown"}`,`Entities: ${X.locationEntities||"Not detected"}`,`Signal: ${W?.label?`${W.label} (${W.normalizedScore.toFixed(1)}/10)`:"Insufficient"}`],children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 border-b pb-6 border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("p",{className:"text-xs font-bold text-blue-700 dark:text-blue-400 uppercase mb-1 flex items-center gap-1",children:[e.jsx(wi,{className:"w-3 h-3"})," Time"]}),e.jsx("p",{className:"text-lg font-extrabold text-slate-900 dark:text-white",children:X.timeframe})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("p",{className:"text-xs font-bold text-blue-700 dark:text-blue-400 uppercase mb-1 flex items-center gap-1",children:[e.jsx(Je,{className:"w-3 h-3"})," Location / Entities"]}),e.jsx("p",{className:"text-lg font-extrabold text-slate-900 dark:text-white",children:X.locationEntities})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("p",{className:"text-xs font-bold text-blue-700 dark:text-blue-400 uppercase mb-1 flex items-center gap-1",children:[e.jsx(nt,{className:"w-3 h-3"})," Core Signal Intensity"]}),e.jsx("p",{className:"text-lg font-extrabold",style:{color:Z},children:W?`${W.label} (${W.normalizedScore.toFixed(1)}/10)`:"Insufficient information"})]})]}),e.jsx("div",{className:"flex items-start gap-6 mt-6",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 text-sm font-bold uppercase mb-4",children:[e.jsx(Le,{className:"w-3 h-3"})," Takeaway Note"]}),e.jsx("ul",{className:"mb-4 space-y-2",children:ce.map((A,M)=>e.jsxs("li",{className:"text-sm text-slate-800 dark:text-slate-200",children:[" ",A]},M))}),!P("market_impact")&&e.jsx(qu,{})]})})]})}),e.jsx(We,{icon:Ne,title:"2. Source & Bias Check",subtitle:"Basic check: Can we trust this source? (Understanding reliability and potential bias)",id:"step-2",verdictText:bu(h?.credibilityScore,h?.manipulationScore),beginnerBullets:[`Overall reliability score: ${typeof h?.credibilityScore=="number"?`${h.credibilityScore}/100`:"Unavailable"}`,`Narrative pressure signals detected: ${Array.isArray(h?.biasIndicators)?h.biasIndicators.length:"Unavailable"}`,`Source quality: ${typeof h?.credibilityScore=="number"?h.credibilityScore>=70?"Established publisher":"Source quality unclear":"Unavailable"}`],children:e.jsx("div",{className:"p-6",children:h?e.jsxs(e.Fragment,{children:[e.jsx(Xu,{credibilityScore:h.credibilityScore??0,redFlags:h.biasIndicators??[],factors:h.factors??[],sourceInfo:{isReputable:(h.credibilityScore??0)>=70,hasAuthor:!0,hasCitations:!0}}),e.jsx(As,{credibilityData:{manipulationScore:h?.manipulationScore??0,credibilityScore:h?.credibilityScore??0,biasIndicators:h?.biasIndicators??[],factors:h?.factors??[]}})]}):e.jsx("div",{className:"p-8 text-center text-slate-500 dark:text-slate-400",children:"Credibility data not available."})})}),e.jsx(We,{icon:Je,title:"3. Big Picture Forces",subtitle:"What external forces are at play? (Politics, economy, technology, etc. driving the story)",id:"step-3",verdictText:yu(x),beginnerBullets:(()=>{const M=(x?Object.entries(x):[]).map(([I,G])=>({k:I,s:G?.score??0}));M.sort((I,G)=>G.s-I.s);const C=M.slice(0,2);return C.length?C.map(I=>`${I.k.charAt(0).toUpperCase()+I.k.slice(1)}: impact ${I.s}/100`):["Insufficient information. Review sources and timeline."]})(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"font-extrabold text-2xl text-slate-900 dark:text-white",children:"External Pressure & Control Analysis"}),e.jsxs("div",{className:"flex items-center text-sm font-bold text-red-600 dark:text-red-400",children:["Overall Pressure Level: Elevated (",(()=>{const A=x?Object.values(x).map(M=>M?.score??0):[0,0,0,0,0,0];return Math.round(A.reduce((M,C)=>M+C,0)/6)})(),"/100)"]})]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 mb-6",children:"A visual comparison of factor magnitude (Bar Chart) and a profile of external pressures (Radar Chart)."}),!P("pestle_full")&&x&&e.jsxs("div",{className:"mb-6 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-4",children:[e.jsx("h5",{className:"text-sm font-bold text-slate-900 dark:text-white mb-2",children:"Top Impact Drivers"}),(()=>{const A=Object.entries(x).map(([C,I])=>({k:C,s:I?.score??0}));A.sort((C,I)=>I.s-C.s);const M=A.slice(0,2);return M.length?e.jsx("ul",{className:"text-sm text-slate-700 dark:text-slate-300 space-y-1",children:M.map(C=>e.jsxs("li",{children:[e.jsx("strong",{className:"capitalize",children:C.k}),": Elevated impact likely influences positioning and decision timing."]},C.k))}):e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Insufficient information. Review sources and timeline."})})(),e.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400 mt-2",children:"Detailed pros/cons and strategy analysis are available with Premium."})]}),x?e.jsx(Zu,{children:e.jsx("div",{className:"bg-white dark:bg-slate-900/70 rounded-xl shadow-lg border border-gray-200 dark:border-slate-800 backdrop-blur-lg",children:e.jsx(rh,{pestle:x,canAccessDetails:P("pestle_full"),onSelectFactor:A=>c(A)})})}):e.jsxs("div",{className:"p-8 text-center bg-slate-50 dark:bg-slate-900/30 rounded-xl border-2 border-dashed border-slate-300 dark:border-slate-700",children:[e.jsx(Je,{className:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"PESTLE data not available for this article."})]})]})}),e.jsx(We,{icon:ot,title:"3. How This Story Shapes Public Emotion",subtitle:"Early emotional signals and crowd bias patterns",id:"sentiment",isActive:!0,verdictText:a?.sentiment?.recommendation||"Sentiment patterns detected",beginnerBullets:["Dominant emotional tone detected","Narrative framing influences reader risk perception","Early signals often precede price reaction"],children:e.jsx(qt,{feature:"sentiment_teaser",isTrialAnalysis:E,canAccessOverride:P,children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-lg bg-slate-50 dark:bg-slate-900/40 p-3 text-center border border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Overall Tone"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:a?.sentiment?.overall||"Detected"})]}),e.jsxs("div",{className:"rounded-lg bg-slate-50 dark:bg-slate-900/40 p-3 text-center border border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Emotional Bias"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:a?.sentiment?.emotionalTone||"Identified"})]}),e.jsxs("div",{className:"rounded-lg bg-slate-50 dark:bg-slate-900/40 p-3 text-center border border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Confidence"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:a?.sentiment?.confidence?`${a.sentiment.confidence}%`:""})]})]}),!E&&_==="lite"&&e.jsxs("div",{className:"mt-4 rounded-lg border border-dashed border-slate-300 dark:border-slate-700 bg-slate-50/60 dark:bg-slate-900/50 p-4 text-sm text-slate-600 dark:text-slate-400",children:[e.jsx("p",{className:"font-medium text-slate-700 dark:text-slate-300 mb-1",children:"This is an early signal preview."}),e.jsxs("p",{children:["Full sentiment drivers, polarity shifts, and manipulation patterns are available on ",e.jsx("span",{className:"font-semibold",children:"Starter"})," tier and above."]})]}),E&&e.jsxs("div",{className:"mt-4 rounded-lg border border-blue-200 dark:border-blue-900/50 bg-blue-50/60 dark:bg-blue-900/20 p-4 text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("p",{className:"font-medium mb-1",children:" Trial Preview Active"}),e.jsxs("p",{children:["You're seeing enhanced sentiment analysis as part of your first 3 free analyses. Full features available with ",e.jsx("span",{className:"font-semibold",children:"Starter"})," tier."]})]})]})})}),a?.tierPositioning&&e.jsxs("div",{className:"mb-6 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-4",children:[e.jsx("div",{className:"text-xs uppercase tracking-wider text-slate-500 dark:text-slate-400 font-semibold mb-1",children:"Your current intelligence layer"}),e.jsx("div",{className:"text-sm text-slate-800 dark:text-slate-200",children:e.jsx("strong",{children:a.tierPositioning.currentDescription})}),!P("stakeholder_impact")&&e.jsxs("div",{className:"mt-2 text-sm text-slate-600 dark:text-slate-400",children:["Next layer reveals: ",e.jsx("strong",{children:a.tierPositioning.nextTierBenefit})]})]}),e.jsx(We,{icon:we,title:"4. Why This Story Is Told This Way",subtitle:"Who benefits and how is it framed?",isActive:!0,id:"step-4",verdictText:wu(S),children:e.jsx("div",{className:"p-6 font-sans text-sm leading-relaxed tracking-normal text-slate-700 dark:text-slate-300",children:e.jsx(Su,{strategyIntent:S})})}),e.jsx(We,{icon:we,title:"5. Who Really Has Power",subtitle:"Who can actually influence outcomes? (Identifying key stakeholders and their leverage)",id:"step-5",verdictText:vu(f),beginnerBullets:[`Data present: ${f?"Yes":"No"}`,`Strategy focus: ${f?"High-power actors":"Unknown"}`,`Risk absorption: ${f?"Visible across counterparts":"Not detected"}`],children:e.jsx(qt,{feature:"stakeholder_impact",canAccessOverride:P,children:e.jsx(Ou,{partyImpact:f})})}),e.jsx(We,{icon:Te,title:"6. Market Impact",subtitle:"How does this affect stocks? (Evidence-based winners and losers, not speculation)",id:"step-6",verdictText:ju(g?.overallSentiment),beginnerBullets:[`Overall sentiment: ${g?.overallSentiment||"Unknown"}`,`Institutional flow: ${g?.institutionalFlow||"Unknown"}`,(()=>{const A=g?.tickers;return`Coverage: ${(A?.direct?.length||0)+(A?.indirect?.length||0)+(A?.speculative?.length||0)||"Unknown"} tickers`})()],children:e.jsx(qt,{feature:"market_impact",canAccessOverride:P,children:e.jsx(Du,{marketImpact:g})})}),e.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"Most decisions rely on the first three steps. Steps 47 reduce blind spots when consequences matter."}),e.jsx(We,{icon:vi,title:"7. What Happens Next",subtitle:"Where is this heading? (Scenario paths, not predictions)",isLast:!1,id:"step-7",verdictText:Va(y,k,v),beginnerBullets:[`Historical patterns: ${y?"Detected":"Not detected"}`,`Signal uncertainty: ${k?"Measured":"Unavailable"}`,`Feedback loops: ${v?"Present":"Not detected"}`],children:e.jsx(qt,{feature:"predictive_modeling",canAccessOverride:P,children:e.jsx(Bu,{chronos:y,entropy:k,ouroboros:v,verdictText:Va(y,k,v)})})})]}),e.jsx("section",{className:"bg-slate-900 dark:bg-slate-800 text-white py-16 mt-12 rounded-2xl border border-slate-800 dark:border-slate-700",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-6 text-center",children:[e.jsx("h2",{className:"text-4xl font-extrabold mb-4",children:"Get the Full Intelligence Picture."}),e.jsx("p",{className:"text-slate-400 dark:text-slate-300 mb-8 text-lg",children:"Join thousands of elite analysts using our AI to decode the market noise and gain a decisive edge."}),e.jsx(Hu,{})]})}),s==="free"&&!r("analysis")&&e.jsx(Fu,{onUpgrade:()=>window.location.href="/pricing"})]}),!P("stakeholder_impact")&&e.jsx("div",{className:"fixed right-6 bottom-6 z-50",children:e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-purple-600 text-white rounded-xl p-4 shadow-2xl flex items-center gap-4",children:[e.jsx(it,{className:"w-6 h-6 text-amber-300"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold",children:"Unlock Premium Intelligence"}),e.jsx("div",{className:"text-xs opacity-80",children:"Full PESTLE details, motive detection, market impact"})]}),e.jsx("button",{onClick:()=>window.location.href="/pricing",className:"px-3 py-2 bg-white text-blue-600 rounded-lg font-semibold hover:bg-blue-50 transition-colors",children:"Upgrade"})]})})]})};function ih({onUploaded:s}){const[t,r]=b.useState(null),[a,i]=b.useState(null),[n,o]=b.useState(null),[l,c]=b.useState(!1),d=2*1024*1024,u=["image/jpeg","image/png","image/svg+xml"],m=h=>{const x=h.target.files?.[0]||null;if(o(null),r(null),i(null),!!x){if(!u.includes(x.type)){o("Invalid file type. Use JPG, PNG, or SVG.");return}if(x.size>d){o("File too large. Max 2MB.");return}r(x),i(URL.createObjectURL(x))}},p=async()=>{if(t){c(!0),o(null);try{const h=t.name.split(".").pop()?.toLowerCase()||"png",x=`logo/${crypto.randomUUID()}.${h}`,{error:g}=await F.storage.from("branding").upload(x,t,{upsert:!0,cacheControl:"3600"});if(g)throw g;const{data:f}=F.storage.from("branding").getPublicUrl(x),y=f.publicUrl;localStorage.setItem("appLogoUrl",y),s?.(y)}catch(h){o(h?.message||"Upload failed. Check network/storage.")}finally{c(!1)}}};return e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Upload Logo (JPG/PNG/SVG, max 2MB)"}),e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.svg",onChange:m}),a&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:a,alt:"Preview",className:"h-16 w-16 object-contain rounded"})}),n&&e.jsx("p",{className:"text-sm text-red-600",children:n}),e.jsx("button",{onClick:p,disabled:!t||l,className:`px-4 py-2 rounded bg-blue-600 text-white ${l?"opacity-50 cursor-not-allowed":""}`,children:l?"Uploading":"Save Logo"})]})}const nh=()=>{const s=De(),[t,r]=b.useState("subscription"),[a,i]=b.useState(null),[n,o]=b.useState(!0),[l,c]=b.useState(null),[d,u]=b.useState(!1);ne(N=>N.user);const{tier:m,scansUsed:p,scansLimit:h,canAccess:x}=ct(),[g,f]=b.useState(()=>{try{const N=localStorage.getItem("teamMembers");return N?JSON.parse(N):[]}catch{return[]}}),[y,k]=b.useState(""),w=5,v=N=>{f(N),localStorage.setItem("teamMembers",JSON.stringify(N))};b.useEffect(()=>{S()},[]);const S=async()=>{try{o(!0),c(null);const{data:{user:N}}=await F.auth.getUser();if(!N){i(null),o(!1);return}const{data:R}=await F.from("users").select("name, created_at, avatar").eq("id",N.id).single();i({id:N.id,email:N.email||"",name:R?.name,avatar:R?.avatar,createdAt:R?.created_at})}catch(N){c(N instanceof Error?N.message:"An error occurred")}finally{o(!1)}},_=async()=>{if(confirm("Are you sure you want to cancel your subscription? Your access will remain active until the end of the current billing period.")){u(!0);try{z.error("Cancellation endpoint not yet connected. Contact support to cancel.")}catch(N){z.error("Failed to cancel subscription"),console.error(N)}finally{u(!1)}}},E=async()=>{try{z.info("Stripe Portal integration coming soon. Contact support for billing changes.")}catch(N){z.error("Failed to open billing portal"),console.error(N)}},$=async()=>{try{await F.auth.signOut(),s("/login"),z.success("Logged out successfully")}catch{z.error("Failed to logout")}},T=[{id:"subscription",label:"Subscription",icon:Os},{id:"billing",label:"Billing",icon:fr},{id:"team",label:"Team",icon:Ns},{id:"api",label:"API",icon:ra},{id:"security",label:"Security",icon:Ne}],P=h>0?Math.min(100,p/h*100):0,q=P>=80;return n?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Error"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:l}),e.jsx("button",{onClick:S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Retry"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Account Settings"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage your subscription and account preferences"})]}),a&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:e.jsx(Is,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:a.name||"User"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:a.email}),a.createdAt&&e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:["Member since ",new Date(a.createdAt).toLocaleDateString()]})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-8",children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:T.map(N=>{const R=N.icon;return e.jsxs("button",{onClick:()=>r(N.id),className:`
                      flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors
                      ${t===N.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}
                    `,children:[e.jsx(R,{className:"w-5 h-5"}),e.jsx("span",{children:N.label})]},N.id)})})}),e.jsxs("div",{className:"p-6",children:[t==="subscription"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Subscription Overview"}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl border-2 border-blue-200 dark:border-blue-800 p-6 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Current Plan"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white capitalize",children:m})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-semibold text-green-600",children:"Active"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:m==="free"?"Lifetime Analyses":"This Month's Usage"}),e.jsxs("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:[p," / ",h]})]}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${q?"bg-gradient-to-r from-orange-500 to-red-500":"bg-gradient-to-r from-blue-500 to-indigo-600"}`,style:{width:`${P}%`}})}),q&&m==="free"&&e.jsxs("div",{className:"mt-3 flex items-start gap-2 p-3 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-700 rounded-lg",children:[e.jsx(qr,{className:"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-orange-900 dark:text-orange-200 mb-1",children:"You're running low on analyses"}),e.jsx("p",{className:"text-orange-700 dark:text-orange-300 text-xs",children:"Upgrade to Pro for unlimited monthly analyses and advanced features."})]})]}),m!=="free"&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"Usage resets each billing cycle."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>s("/pricing"),className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:m==="free"?"Upgrade Plan":"Change Plan"}),m!=="free"&&e.jsx("button",{onClick:E,className:"px-4 py-3 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors font-semibold",children:"Manage Billing"})]})]}),e.jsxs("div",{className:"mb-6 bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white mb-2 text-sm",children:["What you unlock with ",m,":"]}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4 text-green-600 flex-shrink-0"}),e.jsx("span",{children:"Full narrative intent analysis"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4 text-green-600 flex-shrink-0"}),e.jsx("span",{children:"Incentive & power structure breakdown"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4 text-green-600 flex-shrink-0"}),e.jsx("span",{children:"Market impact assessment"})]}),m!=="free"&&e.jsxs(e.Fragment,{children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4 text-indigo-600 flex-shrink-0"}),e.jsx("span",{children:"Hidden motive detection (Pro+)"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4 text-indigo-600 flex-shrink-0"}),e.jsx("span",{children:"Stakeholder influence mapping (Pro+)"})]})]})]})]}),m!=="free"&&e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:"Subscription Control"}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2",children:"If you cancel, your plan will remain active until the end of the billing period."}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"No refunds are provided for the current cycle. You can reactivate anytime before the period ends."})]}),e.jsx("button",{onClick:_,disabled:d,className:"text-sm text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400 underline disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"Processing...":"Cancel subscription"})]}),e.jsxs("div",{className:"mt-6 flex items-start gap-3 p-4 bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-700 rounded-lg",children:[e.jsx(Ne,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-indigo-900 dark:text-indigo-200 mb-1",children:"Your data is encrypted."}),e.jsx("p",{className:"text-xs text-indigo-700 dark:text-indigo-300",children:"We never resell or train on your private content."})]})]}),e.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 dark:text-white mb-4",children:"Branding"}),e.jsx(ih,{onUploaded:()=>{}})]})]}),t==="billing"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Billing Management"}),m==="free"?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(fr,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Active Subscription"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 max-w-md mx-auto",children:"Upgrade to a paid plan to access advanced features, unlimited analyses, and priority support."}),e.jsx("button",{onClick:()=>s("/pricing"),className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"View Pricing Plans"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg p-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Payment & Invoices"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Billing is managed securely via Stripe. View invoices, update payment methods, and download receipts."}),e.jsxs("button",{onClick:E,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[e.jsx(go,{className:"w-4 h-4"}),"Open Billing Portal"]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"Current Plan"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Plan"}),e.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-white capitalize",children:m})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Status"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:"Active"})]})]})]})]})]}),t==="team"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Team Management"}),x("multi_seat")?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-700 rounded-lg p-4 mb-4",children:e.jsxs("p",{className:"text-sm text-indigo-900 dark:text-indigo-200",children:[e.jsx("strong",{children:"Seats are shared across your organization."}),e.jsx("br",{}),e.jsx("span",{className:"text-xs text-indigo-700 dark:text-indigo-300",children:"Activity is tracked per seat."})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"email",value:y,onChange:N=>k(N.target.value),placeholder:"Invite teammate email",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md bg-white dark:bg-gray-900 text-gray-900 dark:text-white"}),e.jsxs("button",{onClick:()=>{const N=y.trim();if(N){if(g.length>=w){z.error("Maximum seats reached");return}if(g.includes(N)){z.error("Email already invited");return}v([...g,N]),k(""),z.success("Teammate invited")}},className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium",children:[e.jsx(po,{className:"w-4 h-4 mr-1"})," Invite"]})]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Seats used: ",e.jsxs("strong",{children:[g.length," / ",w]})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 italic",children:"Team management is currently local to this workspace. Server-side collaboration features are rolling out progressively."}),e.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg divide-y divide-gray-200 dark:divide-gray-700",children:g.length>0?g.map(N=>e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:N}),e.jsxs("button",{onClick:()=>{v(g.filter(R=>R!==N)),z.success("Teammate removed")},className:"inline-flex items-center px-2 py-1 text-xs rounded-md bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300 hover:bg-red-200 dark:hover:bg-red-900/50",children:[e.jsx(bo,{className:"w-3 h-3 mr-1"})," Remove"]})]},N)):e.jsx("div",{className:"p-8 text-center text-sm text-gray-500 dark:text-gray-400",children:"No teammates yet. Invite your first member above."})})]}):e.jsxs("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(Ns,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Team Collaboration"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-6 max-w-md mx-auto",children:"Multi-seat access is available on Business plan"}),e.jsx("button",{onClick:()=>s("/pricing"),className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"Upgrade to Business"})]})]}),t==="api"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"API Access"}),x("api_access")?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Use your session token to authenticate requests. Example:"}),e.jsx("pre",{className:"bg-gray-900 dark:bg-black text-gray-100 p-4 rounded-lg text-xs overflow-auto border border-gray-700",children:`POST https://news-backend-production-ba81.up.railway.app/api/analyze/summary
Headers:
  Content-Type: application/json
  Authorization: Bearer <YOUR_SUPABASE_ACCESS_TOKEN>
Body:
  { "url": "https://example.com/article", "userId": "<YOUR_USER_ID>" }`}),e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:e.jsx("strong",{children:"API usage counts toward your monthly quota."})})})]}):e.jsxs("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(ra,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Programmatic Access"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-6 max-w-md mx-auto",children:"API access is available on Business plan"}),e.jsx("button",{onClick:()=>s("/pricing"),className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"Upgrade to Business"})]})]}),t==="security"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Account Security"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"Account Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Email"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a?.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Login Provider"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Supabase Auth"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:$,className:"w-full flex items-center justify-center gap-2 px-4 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors font-medium",children:[e.jsx(pi,{className:"w-4 h-4"}),"Logout"]}),e.jsxs("button",{onClick:()=>{confirm("Are you sure you want to delete your account? This action cannot be undone.")&&z.info("Account deletion is coming soon. Please contact support if needed.")},className:"w-full flex items-center justify-center gap-2 px-4 py-3 border border-red-300 dark:border-red-700 text-red-600 dark:text-red-400 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors font-medium",children:[e.jsx(yo,{className:"w-4 h-4"}),"Delete Account"]})]})]})]})]})]})]})})};function un(s,t){return function(){return s.apply(t,arguments)}}const{toString:oh}=Object.prototype,{getPrototypeOf:Qr}=Object,{iterator:Ds,toStringTag:hn}=Symbol,Ms=(s=>t=>{const r=oh.call(t);return s[r]||(s[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ie=s=>(s=s.toLowerCase(),t=>Ms(t)===s),Bs=s=>t=>typeof t===s,{isArray:Ot}=Array,Pt=Bs("undefined");function rs(s){return s!==null&&!Pt(s)&&s.constructor!==null&&!Pt(s.constructor)&&je(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const mn=Ie("ArrayBuffer");function lh(s){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(s):t=s&&s.buffer&&mn(s.buffer),t}const ch=Bs("string"),je=Bs("function"),xn=Bs("number"),as=s=>s!==null&&typeof s=="object",dh=s=>s===!0||s===!1,ws=s=>{if(Ms(s)!=="object")return!1;const t=Qr(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(hn in s)&&!(Ds in s)},uh=s=>{if(!as(s)||rs(s))return!1;try{return Object.keys(s).length===0&&Object.getPrototypeOf(s)===Object.prototype}catch{return!1}},hh=Ie("Date"),mh=Ie("File"),xh=Ie("Blob"),fh=Ie("FileList"),gh=s=>as(s)&&je(s.pipe),ph=s=>{let t;return s&&(typeof FormData=="function"&&s instanceof FormData||je(s.append)&&((t=Ms(s))==="formdata"||t==="object"&&je(s.toString)&&s.toString()==="[object FormData]"))},bh=Ie("URLSearchParams"),[yh,wh,vh,jh]=["ReadableStream","Request","Response","Headers"].map(Ie),kh=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function is(s,t,{allOwnKeys:r=!1}={}){if(s===null||typeof s>"u")return;let a,i;if(typeof s!="object"&&(s=[s]),Ot(s))for(a=0,i=s.length;a<i;a++)t.call(null,s[a],a,s);else{if(rs(s))return;const n=r?Object.getOwnPropertyNames(s):Object.keys(s),o=n.length;let l;for(a=0;a<o;a++)l=n[a],t.call(null,s[l],l,s)}}function fn(s,t){if(rs(s))return null;t=t.toLowerCase();const r=Object.keys(s);let a=r.length,i;for(;a-- >0;)if(i=r[a],t===i.toLowerCase())return i;return null}const rt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,gn=s=>!Pt(s)&&s!==rt;function Lr(){const{caseless:s,skipUndefined:t}=gn(this)&&this||{},r={},a=(i,n)=>{const o=s&&fn(r,n)||n;ws(r[o])&&ws(i)?r[o]=Lr(r[o],i):ws(i)?r[o]=Lr({},i):Ot(i)?r[o]=i.slice():(!t||!Pt(i))&&(r[o]=i)};for(let i=0,n=arguments.length;i<n;i++)arguments[i]&&is(arguments[i],a);return r}const Nh=(s,t,r,{allOwnKeys:a}={})=>(is(t,(i,n)=>{r&&je(i)?s[n]=un(i,r):s[n]=i},{allOwnKeys:a}),s),_h=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),Sh=(s,t,r,a)=>{s.prototype=Object.create(t.prototype,a),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:t.prototype}),r&&Object.assign(s.prototype,r)},Eh=(s,t,r,a)=>{let i,n,o;const l={};if(t=t||{},s==null)return t;do{for(i=Object.getOwnPropertyNames(s),n=i.length;n-- >0;)o=i[n],(!a||a(o,s,t))&&!l[o]&&(t[o]=s[o],l[o]=!0);s=r!==!1&&Qr(s)}while(s&&(!r||r(s,t))&&s!==Object.prototype);return t},Th=(s,t,r)=>{s=String(s),(r===void 0||r>s.length)&&(r=s.length),r-=t.length;const a=s.indexOf(t,r);return a!==-1&&a===r},Ch=s=>{if(!s)return null;if(Ot(s))return s;let t=s.length;if(!xn(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=s[t];return r},Ah=(s=>t=>s&&t instanceof s)(typeof Uint8Array<"u"&&Qr(Uint8Array)),Ph=(s,t)=>{const a=(s&&s[Ds]).call(s);let i;for(;(i=a.next())&&!i.done;){const n=i.value;t.call(s,n[0],n[1])}},Oh=(s,t)=>{let r;const a=[];for(;(r=s.exec(t))!==null;)a.push(r);return a},Rh=Ie("HTMLFormElement"),Ih=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,i){return a.toUpperCase()+i}),ei=(({hasOwnProperty:s})=>(t,r)=>s.call(t,r))(Object.prototype),$h=Ie("RegExp"),pn=(s,t)=>{const r=Object.getOwnPropertyDescriptors(s),a={};is(r,(i,n)=>{let o;(o=t(i,n,s))!==!1&&(a[n]=o||i)}),Object.defineProperties(s,a)},Lh=s=>{pn(s,(t,r)=>{if(je(s)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=s[r];if(je(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},Uh=(s,t)=>{const r={},a=i=>{i.forEach(n=>{r[n]=!0})};return Ot(s)?a(s):a(String(s).split(t)),r},Dh=()=>{},Mh=(s,t)=>s!=null&&Number.isFinite(s=+s)?s:t;function Bh(s){return!!(s&&je(s.append)&&s[hn]==="FormData"&&s[Ds])}const Fh=s=>{const t=new Array(10),r=(a,i)=>{if(as(a)){if(t.indexOf(a)>=0)return;if(rs(a))return a;if(!("toJSON"in a)){t[i]=a;const n=Ot(a)?[]:{};return is(a,(o,l)=>{const c=r(o,i+1);!Pt(c)&&(n[l]=c)}),t[i]=void 0,n}}return a};return r(s,0)},qh=Ie("AsyncFunction"),Hh=s=>s&&(as(s)||je(s))&&je(s.then)&&je(s.catch),bn=((s,t)=>s?setImmediate:t?((r,a)=>(rt.addEventListener("message",({source:i,data:n})=>{i===rt&&n===r&&a.length&&a.shift()()},!1),i=>{a.push(i),rt.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",je(rt.postMessage)),Wh=typeof queueMicrotask<"u"?queueMicrotask.bind(rt):typeof process<"u"&&process.nextTick||bn,zh=s=>s!=null&&je(s[Ds]),j={isArray:Ot,isArrayBuffer:mn,isBuffer:rs,isFormData:ph,isArrayBufferView:lh,isString:ch,isNumber:xn,isBoolean:dh,isObject:as,isPlainObject:ws,isEmptyObject:uh,isReadableStream:yh,isRequest:wh,isResponse:vh,isHeaders:jh,isUndefined:Pt,isDate:hh,isFile:mh,isBlob:xh,isRegExp:$h,isFunction:je,isStream:gh,isURLSearchParams:bh,isTypedArray:Ah,isFileList:fh,forEach:is,merge:Lr,extend:Nh,trim:kh,stripBOM:_h,inherits:Sh,toFlatObject:Eh,kindOf:Ms,kindOfTest:Ie,endsWith:Th,toArray:Ch,forEachEntry:Ph,matchAll:Oh,isHTMLForm:Rh,hasOwnProperty:ei,hasOwnProp:ei,reduceDescriptors:pn,freezeMethods:Lh,toObjectSet:Uh,toCamelCase:Ih,noop:Dh,toFiniteNumber:Mh,findKey:fn,global:rt,isContextDefined:gn,isSpecCompliantForm:Bh,toJSONObject:Fh,isAsyncFn:qh,isThenable:Hh,setImmediate:bn,asap:Wh,isIterable:zh};function H(s,t,r,a,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),i&&(this.response=i,this.status=i.status?i.status:null)}j.inherits(H,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:j.toJSONObject(this.config),code:this.code,status:this.status}}});const yn=H.prototype,wn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{wn[s]={value:s}});Object.defineProperties(H,wn);Object.defineProperty(yn,"isAxiosError",{value:!0});H.from=(s,t,r,a,i,n)=>{const o=Object.create(yn);j.toFlatObject(s,o,function(u){return u!==Error.prototype},d=>d!=="isAxiosError");const l=s&&s.message?s.message:"Error",c=t==null&&s?s.code:t;return H.call(o,l,c,r,a,i),s&&o.cause==null&&Object.defineProperty(o,"cause",{value:s,configurable:!0}),o.name=s&&s.name||"Error",n&&Object.assign(o,n),o};const Vh=null;function Ur(s){return j.isPlainObject(s)||j.isArray(s)}function vn(s){return j.endsWith(s,"[]")?s.slice(0,-2):s}function ti(s,t,r){return s?s.concat(t).map(function(i,n){return i=vn(i),!r&&n?"["+i+"]":i}).join(r?".":""):t}function Kh(s){return j.isArray(s)&&!s.some(Ur)}const Gh=j.toFlatObject(j,{},null,function(t){return/^is[A-Z]/.test(t)});function Fs(s,t,r){if(!j.isObject(s))throw new TypeError("target must be an object");t=t||new FormData,r=j.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,f){return!j.isUndefined(f[g])});const a=r.metaTokens,i=r.visitor||u,n=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&j.isSpecCompliantForm(t);if(!j.isFunction(i))throw new TypeError("visitor must be a function");function d(x){if(x===null)return"";if(j.isDate(x))return x.toISOString();if(j.isBoolean(x))return x.toString();if(!c&&j.isBlob(x))throw new H("Blob is not supported. Use a Buffer instead.");return j.isArrayBuffer(x)||j.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function u(x,g,f){let y=x;if(x&&!f&&typeof x=="object"){if(j.endsWith(g,"{}"))g=a?g:g.slice(0,-2),x=JSON.stringify(x);else if(j.isArray(x)&&Kh(x)||(j.isFileList(x)||j.endsWith(g,"[]"))&&(y=j.toArray(x)))return g=vn(g),y.forEach(function(w,v){!(j.isUndefined(w)||w===null)&&t.append(o===!0?ti([g],v,n):o===null?g:g+"[]",d(w))}),!1}return Ur(x)?!0:(t.append(ti(f,g,n),d(x)),!1)}const m=[],p=Object.assign(Gh,{defaultVisitor:u,convertValue:d,isVisitable:Ur});function h(x,g){if(!j.isUndefined(x)){if(m.indexOf(x)!==-1)throw Error("Circular reference detected in "+g.join("."));m.push(x),j.forEach(x,function(y,k){(!(j.isUndefined(y)||y===null)&&i.call(t,y,j.isString(k)?k.trim():k,g,p))===!0&&h(y,g?g.concat(k):[k])}),m.pop()}}if(!j.isObject(s))throw new TypeError("data must be an object");return h(s),t}function si(s){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function Zr(s,t){this._pairs=[],s&&Fs(s,this,t)}const jn=Zr.prototype;jn.append=function(t,r){this._pairs.push([t,r])};jn.toString=function(t){const r=t?function(a){return t.call(this,a,si)}:si;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function Jh(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function kn(s,t,r){if(!t)return s;const a=r&&r.encode||Jh;j.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let n;if(i?n=i(t,r):n=j.isURLSearchParams(t)?t.toString():new Zr(t,r).toString(a),n){const o=s.indexOf("#");o!==-1&&(s=s.slice(0,o)),s+=(s.indexOf("?")===-1?"?":"&")+n}return s}class ri{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){j.forEach(this.handlers,function(a){a!==null&&t(a)})}}const Nn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Yh=typeof URLSearchParams<"u"?URLSearchParams:Zr,Xh=typeof FormData<"u"?FormData:null,Qh=typeof Blob<"u"?Blob:null,Zh={isBrowser:!0,classes:{URLSearchParams:Yh,FormData:Xh,Blob:Qh},protocols:["http","https","file","blob","url","data"]},ea=typeof window<"u"&&typeof document<"u",Dr=typeof navigator=="object"&&navigator||void 0,e0=ea&&(!Dr||["ReactNative","NativeScript","NS"].indexOf(Dr.product)<0),t0=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",s0=ea&&window.location.href||"http://localhost",r0=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ea,hasStandardBrowserEnv:e0,hasStandardBrowserWebWorkerEnv:t0,navigator:Dr,origin:s0},Symbol.toStringTag,{value:"Module"})),xe={...r0,...Zh};function a0(s,t){return Fs(s,new xe.classes.URLSearchParams,{visitor:function(r,a,i,n){return xe.isNode&&j.isBuffer(r)?(this.append(a,r.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)},...t})}function i0(s){return j.matchAll(/\w+|\[(\w*)]/g,s).map(t=>t[0]==="[]"?"":t[1]||t[0])}function n0(s){const t={},r=Object.keys(s);let a;const i=r.length;let n;for(a=0;a<i;a++)n=r[a],t[n]=s[n];return t}function _n(s){function t(r,a,i,n){let o=r[n++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=n>=r.length;return o=!o&&j.isArray(i)?i.length:o,c?(j.hasOwnProp(i,o)?i[o]=[i[o],a]:i[o]=a,!l):((!i[o]||!j.isObject(i[o]))&&(i[o]=[]),t(r,a,i[o],n)&&j.isArray(i[o])&&(i[o]=n0(i[o])),!l)}if(j.isFormData(s)&&j.isFunction(s.entries)){const r={};return j.forEachEntry(s,(a,i)=>{t(i0(a),i,r,0)}),r}return null}function o0(s,t,r){if(j.isString(s))try{return(t||JSON.parse)(s),j.trim(s)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(s)}const ns={transitional:Nn,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",i=a.indexOf("application/json")>-1,n=j.isObject(t);if(n&&j.isHTMLForm(t)&&(t=new FormData(t)),j.isFormData(t))return i?JSON.stringify(_n(t)):t;if(j.isArrayBuffer(t)||j.isBuffer(t)||j.isStream(t)||j.isFile(t)||j.isBlob(t)||j.isReadableStream(t))return t;if(j.isArrayBufferView(t))return t.buffer;if(j.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(n){if(a.indexOf("application/x-www-form-urlencoded")>-1)return a0(t,this.formSerializer).toString();if((l=j.isFileList(t))||a.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Fs(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return n||i?(r.setContentType("application/json",!1),o0(t)):t}],transformResponse:[function(t){const r=this.transitional||ns.transitional,a=r&&r.forcedJSONParsing,i=this.responseType==="json";if(j.isResponse(t)||j.isReadableStream(t))return t;if(t&&j.isString(t)&&(a&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?H.from(l,H.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:xe.classes.FormData,Blob:xe.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};j.forEach(["delete","get","head","post","put","patch"],s=>{ns.headers[s]={}});const l0=j.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),c0=s=>{const t={};let r,a,i;return s&&s.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),a=o.substring(i+1).trim(),!(!r||t[r]&&l0[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},ai=Symbol("internals");function Bt(s){return s&&String(s).trim().toLowerCase()}function vs(s){return s===!1||s==null?s:j.isArray(s)?s.map(vs):String(s)}function d0(s){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(s);)t[a[1]]=a[2];return t}const u0=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function ur(s,t,r,a,i){if(j.isFunction(a))return a.call(this,t,r);if(i&&(t=r),!!j.isString(t)){if(j.isString(a))return t.indexOf(a)!==-1;if(j.isRegExp(a))return a.test(t)}}function h0(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function m0(s,t){const r=j.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(s,a+r,{value:function(i,n,o){return this[a].call(this,t,i,n,o)},configurable:!0})})}let ke=class{constructor(t){t&&this.set(t)}set(t,r,a){const i=this;function n(l,c,d){const u=Bt(c);if(!u)throw new Error("header name must be a non-empty string");const m=j.findKey(i,u);(!m||i[m]===void 0||d===!0||d===void 0&&i[m]!==!1)&&(i[m||c]=vs(l))}const o=(l,c)=>j.forEach(l,(d,u)=>n(d,u,c));if(j.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(j.isString(t)&&(t=t.trim())&&!u0(t))o(c0(t),r);else if(j.isObject(t)&&j.isIterable(t)){let l={},c,d;for(const u of t){if(!j.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[d=u[0]]=(c=l[d])?j.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}o(l,r)}else t!=null&&n(r,t,a);return this}get(t,r){if(t=Bt(t),t){const a=j.findKey(this,t);if(a){const i=this[a];if(!r)return i;if(r===!0)return d0(i);if(j.isFunction(r))return r.call(this,i,a);if(j.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Bt(t),t){const a=j.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||ur(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let i=!1;function n(o){if(o=Bt(o),o){const l=j.findKey(a,o);l&&(!r||ur(a,a[l],l,r))&&(delete a[l],i=!0)}}return j.isArray(t)?t.forEach(n):n(t),i}clear(t){const r=Object.keys(this);let a=r.length,i=!1;for(;a--;){const n=r[a];(!t||ur(this,this[n],n,t,!0))&&(delete this[n],i=!0)}return i}normalize(t){const r=this,a={};return j.forEach(this,(i,n)=>{const o=j.findKey(a,n);if(o){r[o]=vs(i),delete r[n];return}const l=t?h0(n):String(n).trim();l!==n&&delete r[n],r[l]=vs(i),a[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return j.forEach(this,(a,i)=>{a!=null&&a!==!1&&(r[i]=t&&j.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(i=>a.set(i)),a}static accessor(t){const a=(this[ai]=this[ai]={accessors:{}}).accessors,i=this.prototype;function n(o){const l=Bt(o);a[l]||(m0(i,o),a[l]=!0)}return j.isArray(t)?t.forEach(n):n(t),this}};ke.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);j.reduceDescriptors(ke.prototype,({value:s},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>s,set(a){this[r]=a}}});j.freezeMethods(ke);function hr(s,t){const r=this||ns,a=t||r,i=ke.from(a.headers);let n=a.data;return j.forEach(s,function(l){n=l.call(r,n,i.normalize(),t?t.status:void 0)}),i.normalize(),n}function Sn(s){return!!(s&&s.__CANCEL__)}function Rt(s,t,r){H.call(this,s??"canceled",H.ERR_CANCELED,t,r),this.name="CanceledError"}j.inherits(Rt,H,{__CANCEL__:!0});function En(s,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?s(r):t(new H("Request failed with status code "+r.status,[H.ERR_BAD_REQUEST,H.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function x0(s){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return t&&t[1]||""}function f0(s,t){s=s||10;const r=new Array(s),a=new Array(s);let i=0,n=0,o;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=a[n];o||(o=d),r[i]=c,a[i]=d;let m=n,p=0;for(;m!==i;)p+=r[m++],m=m%s;if(i=(i+1)%s,i===n&&(n=(n+1)%s),d-o<t)return;const h=u&&d-u;return h?Math.round(p*1e3/h):void 0}}function g0(s,t){let r=0,a=1e3/t,i,n;const o=(d,u=Date.now())=>{r=u,i=null,n&&(clearTimeout(n),n=null),s(...d)};return[(...d)=>{const u=Date.now(),m=u-r;m>=a?o(d,u):(i=d,n||(n=setTimeout(()=>{n=null,o(i)},a-m)))},()=>i&&o(i)]}const Ps=(s,t,r=3)=>{let a=0;const i=f0(50,250);return g0(n=>{const o=n.loaded,l=n.lengthComputable?n.total:void 0,c=o-a,d=i(c),u=o<=l;a=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&u?(l-o)/d:void 0,event:n,lengthComputable:l!=null,[t?"download":"upload"]:!0};s(m)},r)},ii=(s,t)=>{const r=s!=null;return[a=>t[0]({lengthComputable:r,total:s,loaded:a}),t[1]]},ni=s=>(...t)=>j.asap(()=>s(...t)),p0=xe.hasStandardBrowserEnv?((s,t)=>r=>(r=new URL(r,xe.origin),s.protocol===r.protocol&&s.host===r.host&&(t||s.port===r.port)))(new URL(xe.origin),xe.navigator&&/(msie|trident)/i.test(xe.navigator.userAgent)):()=>!0,b0=xe.hasStandardBrowserEnv?{write(s,t,r,a,i,n,o){if(typeof document>"u")return;const l=[`${s}=${encodeURIComponent(t)}`];j.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),j.isString(a)&&l.push(`path=${a}`),j.isString(i)&&l.push(`domain=${i}`),n===!0&&l.push("secure"),j.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(s){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+s+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(s){this.write(s,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function y0(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function w0(s,t){return t?s.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):s}function Tn(s,t,r){let a=!y0(t);return s&&(a||r==!1)?w0(s,t):t}const oi=s=>s instanceof ke?{...s}:s;function lt(s,t){t=t||{};const r={};function a(d,u,m,p){return j.isPlainObject(d)&&j.isPlainObject(u)?j.merge.call({caseless:p},d,u):j.isPlainObject(u)?j.merge({},u):j.isArray(u)?u.slice():u}function i(d,u,m,p){if(j.isUndefined(u)){if(!j.isUndefined(d))return a(void 0,d,m,p)}else return a(d,u,m,p)}function n(d,u){if(!j.isUndefined(u))return a(void 0,u)}function o(d,u){if(j.isUndefined(u)){if(!j.isUndefined(d))return a(void 0,d)}else return a(void 0,u)}function l(d,u,m){if(m in t)return a(d,u);if(m in s)return a(void 0,d)}const c={url:n,method:n,data:n,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,u,m)=>i(oi(d),oi(u),m,!0)};return j.forEach(Object.keys({...s,...t}),function(u){const m=c[u]||i,p=m(s[u],t[u],u);j.isUndefined(p)&&m!==l||(r[u]=p)}),r}const Cn=s=>{const t=lt({},s);let{data:r,withXSRFToken:a,xsrfHeaderName:i,xsrfCookieName:n,headers:o,auth:l}=t;if(t.headers=o=ke.from(o),t.url=kn(Tn(t.baseURL,t.url,t.allowAbsoluteUrls),s.params,s.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),j.isFormData(r)){if(xe.hasStandardBrowserEnv||xe.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(j.isFunction(r.getHeaders)){const c=r.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([u,m])=>{d.includes(u.toLowerCase())&&o.set(u,m)})}}if(xe.hasStandardBrowserEnv&&(a&&j.isFunction(a)&&(a=a(t)),a||a!==!1&&p0(t.url))){const c=i&&n&&b0.read(n);c&&o.set(i,c)}return t},v0=typeof XMLHttpRequest<"u",j0=v0&&function(s){return new Promise(function(r,a){const i=Cn(s);let n=i.data;const o=ke.from(i.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=i,u,m,p,h,x;function g(){h&&h(),x&&x(),i.cancelToken&&i.cancelToken.unsubscribe(u),i.signal&&i.signal.removeEventListener("abort",u)}let f=new XMLHttpRequest;f.open(i.method.toUpperCase(),i.url,!0),f.timeout=i.timeout;function y(){if(!f)return;const w=ke.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders()),S={data:!l||l==="text"||l==="json"?f.responseText:f.response,status:f.status,statusText:f.statusText,headers:w,config:s,request:f};En(function(E){r(E),g()},function(E){a(E),g()},S),f=null}"onloadend"in f?f.onloadend=y:f.onreadystatechange=function(){!f||f.readyState!==4||f.status===0&&!(f.responseURL&&f.responseURL.indexOf("file:")===0)||setTimeout(y)},f.onabort=function(){f&&(a(new H("Request aborted",H.ECONNABORTED,s,f)),f=null)},f.onerror=function(v){const S=v&&v.message?v.message:"Network Error",_=new H(S,H.ERR_NETWORK,s,f);_.event=v||null,a(_),f=null},f.ontimeout=function(){let v=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const S=i.transitional||Nn;i.timeoutErrorMessage&&(v=i.timeoutErrorMessage),a(new H(v,S.clarifyTimeoutError?H.ETIMEDOUT:H.ECONNABORTED,s,f)),f=null},n===void 0&&o.setContentType(null),"setRequestHeader"in f&&j.forEach(o.toJSON(),function(v,S){f.setRequestHeader(S,v)}),j.isUndefined(i.withCredentials)||(f.withCredentials=!!i.withCredentials),l&&l!=="json"&&(f.responseType=i.responseType),d&&([p,x]=Ps(d,!0),f.addEventListener("progress",p)),c&&f.upload&&([m,h]=Ps(c),f.upload.addEventListener("progress",m),f.upload.addEventListener("loadend",h)),(i.cancelToken||i.signal)&&(u=w=>{f&&(a(!w||w.type?new Rt(null,s,f):w),f.abort(),f=null)},i.cancelToken&&i.cancelToken.subscribe(u),i.signal&&(i.signal.aborted?u():i.signal.addEventListener("abort",u)));const k=x0(i.url);if(k&&xe.protocols.indexOf(k)===-1){a(new H("Unsupported protocol "+k+":",H.ERR_BAD_REQUEST,s));return}f.send(n||null)})},k0=(s,t)=>{const{length:r}=s=s?s.filter(Boolean):[];if(t||r){let a=new AbortController,i;const n=function(d){if(!i){i=!0,l();const u=d instanceof Error?d:this.reason;a.abort(u instanceof H?u:new Rt(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,n(new H(`timeout ${t} of ms exceeded`,H.ETIMEDOUT))},t);const l=()=>{s&&(o&&clearTimeout(o),o=null,s.forEach(d=>{d.unsubscribe?d.unsubscribe(n):d.removeEventListener("abort",n)}),s=null)};s.forEach(d=>d.addEventListener("abort",n));const{signal:c}=a;return c.unsubscribe=()=>j.asap(l),c}},N0=function*(s,t){let r=s.byteLength;if(r<t){yield s;return}let a=0,i;for(;a<r;)i=a+t,yield s.slice(a,i),a=i},_0=async function*(s,t){for await(const r of S0(s))yield*N0(r,t)},S0=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const t=s.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},li=(s,t,r,a)=>{const i=_0(s,t);let n=0,o,l=c=>{o||(o=!0,a&&a(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await i.next();if(d){l(),c.close();return}let m=u.byteLength;if(r){let p=n+=m;r(p)}c.enqueue(new Uint8Array(u))}catch(d){throw l(d),d}},cancel(c){return l(c),i.return()}},{highWaterMark:2})},ci=64*1024,{isFunction:bs}=j,E0=(({Request:s,Response:t})=>({Request:s,Response:t}))(j.global),{ReadableStream:di,TextEncoder:ui}=j.global,hi=(s,...t)=>{try{return!!s(...t)}catch{return!1}},T0=s=>{s=j.merge.call({skipUndefined:!0},E0,s);const{fetch:t,Request:r,Response:a}=s,i=t?bs(t):typeof fetch=="function",n=bs(r),o=bs(a);if(!i)return!1;const l=i&&bs(di),c=i&&(typeof ui=="function"?(x=>g=>x.encode(g))(new ui):async x=>new Uint8Array(await new r(x).arrayBuffer())),d=n&&l&&hi(()=>{let x=!1;const g=new r(xe.origin,{body:new di,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!g}),u=o&&l&&hi(()=>j.isReadableStream(new a("").body)),m={stream:u&&(x=>x.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!m[x]&&(m[x]=(g,f)=>{let y=g&&g[x];if(y)return y.call(g);throw new H(`Response type '${x}' is not supported`,H.ERR_NOT_SUPPORT,f)})});const p=async x=>{if(x==null)return 0;if(j.isBlob(x))return x.size;if(j.isSpecCompliantForm(x))return(await new r(xe.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(j.isArrayBufferView(x)||j.isArrayBuffer(x))return x.byteLength;if(j.isURLSearchParams(x)&&(x=x+""),j.isString(x))return(await c(x)).byteLength},h=async(x,g)=>{const f=j.toFiniteNumber(x.getContentLength());return f??p(g)};return async x=>{let{url:g,method:f,data:y,signal:k,cancelToken:w,timeout:v,onDownloadProgress:S,onUploadProgress:_,responseType:E,headers:$,withCredentials:T="same-origin",fetchOptions:P}=Cn(x),q=t||fetch;E=E?(E+"").toLowerCase():"text";let N=k0([k,w&&w.toAbortSignal()],v),R=null;const V=N&&N.unsubscribe&&(()=>{N.unsubscribe()});let W;try{if(_&&d&&f!=="get"&&f!=="head"&&(W=await h($,y))!==0){let A=new r(g,{method:"POST",body:y,duplex:"half"}),M;if(j.isFormData(y)&&(M=A.headers.get("content-type"))&&$.setContentType(M),A.body){const[C,I]=ii(W,Ps(ni(_)));y=li(A.body,ci,C,I)}}j.isString(T)||(T=T?"include":"omit");const K=n&&"credentials"in r.prototype,be={...P,signal:N,method:f.toUpperCase(),headers:$.normalize().toJSON(),body:y,duplex:"half",credentials:K?T:void 0};R=n&&new r(g,be);let Z=await(n?q(R,P):q(g,be));const X=u&&(E==="stream"||E==="response");if(u&&(S||X&&V)){const A={};["status","statusText","headers"].forEach(G=>{A[G]=Z[G]});const M=j.toFiniteNumber(Z.headers.get("content-length")),[C,I]=S&&ii(M,Ps(ni(S),!0))||[];Z=new a(li(Z.body,ci,C,()=>{I&&I(),V&&V()}),A)}E=E||"text";let ce=await m[j.findKey(m,E)||"text"](Z,x);return!X&&V&&V(),await new Promise((A,M)=>{En(A,M,{data:ce,headers:ke.from(Z.headers),status:Z.status,statusText:Z.statusText,config:x,request:R})})}catch(K){throw V&&V(),K&&K.name==="TypeError"&&/Load failed|fetch/i.test(K.message)?Object.assign(new H("Network Error",H.ERR_NETWORK,x,R),{cause:K.cause||K}):H.from(K,K&&K.code,x,R)}}},C0=new Map,An=s=>{let t=s&&s.env||{};const{fetch:r,Request:a,Response:i}=t,n=[a,i,r];let o=n.length,l=o,c,d,u=C0;for(;l--;)c=n[l],d=u.get(c),d===void 0&&u.set(c,d=l?new Map:T0(t)),u=d;return d};An();const ta={http:Vh,xhr:j0,fetch:{get:An}};j.forEach(ta,(s,t)=>{if(s){try{Object.defineProperty(s,"name",{value:t})}catch{}Object.defineProperty(s,"adapterName",{value:t})}});const mi=s=>`- ${s}`,A0=s=>j.isFunction(s)||s===null||s===!1;function P0(s,t){s=j.isArray(s)?s:[s];const{length:r}=s;let a,i;const n={};for(let o=0;o<r;o++){a=s[o];let l;if(i=a,!A0(a)&&(i=ta[(l=String(a)).toLowerCase()],i===void 0))throw new H(`Unknown adapter '${l}'`);if(i&&(j.isFunction(i)||(i=i.get(t))))break;n[l||"#"+o]=i}if(!i){const o=Object.entries(n).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(mi).join(`
`):" "+mi(o[0]):"as no adapter specified";throw new H("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i}const Pn={getAdapter:P0,adapters:ta};function mr(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new Rt(null,s)}function xi(s){return mr(s),s.headers=ke.from(s.headers),s.data=hr.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),Pn.getAdapter(s.adapter||ns.adapter,s)(s).then(function(a){return mr(s),a.data=hr.call(s,s.transformResponse,a),a.headers=ke.from(a.headers),a},function(a){return Sn(a)||(mr(s),a&&a.response&&(a.response.data=hr.call(s,s.transformResponse,a.response),a.response.headers=ke.from(a.response.headers))),Promise.reject(a)})}const On="1.13.2",qs={};["object","boolean","number","function","string","symbol"].forEach((s,t)=>{qs[s]=function(a){return typeof a===s||"a"+(t<1?"n ":" ")+s}});const fi={};qs.transitional=function(t,r,a){function i(n,o){return"[Axios v"+On+"] Transitional option '"+n+"'"+o+(a?". "+a:"")}return(n,o,l)=>{if(t===!1)throw new H(i(o," has been removed"+(r?" in "+r:"")),H.ERR_DEPRECATED);return r&&!fi[o]&&(fi[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(n,o,l):!0}};qs.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function O0(s,t,r){if(typeof s!="object")throw new H("options must be an object",H.ERR_BAD_OPTION_VALUE);const a=Object.keys(s);let i=a.length;for(;i-- >0;){const n=a[i],o=t[n];if(o){const l=s[n],c=l===void 0||o(l,n,s);if(c!==!0)throw new H("option "+n+" must be "+c,H.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new H("Unknown option "+n,H.ERR_BAD_OPTION)}}const js={assertOptions:O0,validators:qs},$e=js.validators;let at=class{constructor(t){this.defaults=t||{},this.interceptors={request:new ri,response:new ri}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const n=i.stack?i.stack.replace(/^.+\n/,""):"";try{a.stack?n&&!String(a.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+n):a.stack=n}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=lt(this.defaults,r);const{transitional:a,paramsSerializer:i,headers:n}=r;a!==void 0&&js.assertOptions(a,{silentJSONParsing:$e.transitional($e.boolean),forcedJSONParsing:$e.transitional($e.boolean),clarifyTimeoutError:$e.transitional($e.boolean)},!1),i!=null&&(j.isFunction(i)?r.paramsSerializer={serialize:i}:js.assertOptions(i,{encode:$e.function,serialize:$e.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),js.assertOptions(r,{baseUrl:$e.spelling("baseURL"),withXsrfToken:$e.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=n&&j.merge(n.common,n[r.method]);n&&j.forEach(["delete","get","head","post","put","patch","common"],x=>{delete n[x]}),r.headers=ke.concat(o,n);const l=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,l.unshift(g.fulfilled,g.rejected))});const d=[];this.interceptors.response.forEach(function(g){d.push(g.fulfilled,g.rejected)});let u,m=0,p;if(!c){const x=[xi.bind(this),void 0];for(x.unshift(...l),x.push(...d),p=x.length,u=Promise.resolve(r);m<p;)u=u.then(x[m++],x[m++]);return u}p=l.length;let h=r;for(;m<p;){const x=l[m++],g=l[m++];try{h=x(h)}catch(f){g.call(this,f);break}}try{u=xi.call(this,h)}catch(x){return Promise.reject(x)}for(m=0,p=d.length;m<p;)u=u.then(d[m++],d[m++]);return u}getUri(t){t=lt(this.defaults,t);const r=Tn(t.baseURL,t.url,t.allowAbsoluteUrls);return kn(r,t.params,t.paramsSerializer)}};j.forEach(["delete","get","head","options"],function(t){at.prototype[t]=function(r,a){return this.request(lt(a||{},{method:t,url:r,data:(a||{}).data}))}});j.forEach(["post","put","patch"],function(t){function r(a){return function(n,o,l){return this.request(lt(l||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:n,data:o}))}}at.prototype[t]=r(),at.prototype[t+"Form"]=r(!0)});let R0=class Rn{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(n){r=n});const a=this;this.promise.then(i=>{if(!a._listeners)return;let n=a._listeners.length;for(;n-- >0;)a._listeners[n](i);a._listeners=null}),this.promise.then=i=>{let n;const o=new Promise(l=>{a.subscribe(l),n=l}).then(i);return o.cancel=function(){a.unsubscribe(n)},o},t(function(n,o,l){a.reason||(a.reason=new Rt(n,o,l),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Rn(function(i){t=i}),cancel:t}}};function I0(s){return function(r){return s.apply(null,r)}}function $0(s){return j.isObject(s)&&s.isAxiosError===!0}const Mr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Mr).forEach(([s,t])=>{Mr[t]=s});function In(s){const t=new at(s),r=un(at.prototype.request,t);return j.extend(r,at.prototype,t,{allOwnKeys:!0}),j.extend(r,t,null,{allOwnKeys:!0}),r.create=function(i){return In(lt(s,i))},r}const te=In(ns);te.Axios=at;te.CanceledError=Rt;te.CancelToken=R0;te.isCancel=Sn;te.VERSION=On;te.toFormData=Fs;te.AxiosError=H;te.Cancel=te.CanceledError;te.all=function(t){return Promise.all(t)};te.spread=I0;te.isAxiosError=$0;te.mergeConfig=lt;te.AxiosHeaders=ke;te.formToJSON=s=>_n(j.isHTMLForm(s)?new FormData(s):s);te.getAdapter=Pn.getAdapter;te.HttpStatusCode=Mr;te.default=te;const{Axios:X0,AxiosError:Q0,CanceledError:Z0,isCancel:em,CancelToken:tm,VERSION:sm,all:rm,Cancel:am,isAxiosError:im,spread:nm,toFormData:om,AxiosHeaders:lm,HttpStatusCode:cm,formToJSON:dm,getAdapter:um,mergeConfig:hm}=te,xr="/api",Br={async getHistory(s){try{return(await te.get(`${xr}/history`,{params:{page:s?.page||1,limit:s?.limit||10,search:s?.search,sortBy:s?.sortBy,sortOrder:s?.sortOrder}})).data}catch(t){throw console.error("Error fetching history:",t),new Error("Failed to fetch analysis history")}},async getAnalysisDetail(s){try{return(await te.get(`${xr}/history/${s}`)).data}catch(t){throw console.error("Error fetching analysis detail:",t),new Error("Failed to fetch analysis details")}},async refreshHistory(){try{return(await te.post(`${xr}/history/refresh`)).data}catch(s){throw console.error("Error refreshing history:",s),new Error("Failed to refresh history")}}};function L0(){const s=De(),[t,r]=b.useState([]),[a,i]=b.useState(!0),[n,o]=b.useState(null),[l,c]=b.useState(""),[d,u]=b.useState("date"),[m,p]=b.useState("desc"),[h,x]=b.useState(1),[g,f]=b.useState(1),[y,k]=b.useState(0),{canAccess:w}=ct(),v=10,S=b.useCallback(async()=>{i(!0),o(null);try{const N=await Br.getHistory({page:h,limit:v,search:l,sortBy:d,sortOrder:m});r(N.analyses),k(N.total),f(N.totalPages)}catch(N){o("Failed to load analysis history. Please try again."),console.error("Error fetching history:",N)}finally{i(!1)}},[h,v,l,d,m]);b.useEffect(()=>{S()},[l,d,m,h,S]);const _=async()=>{i(!0);try{const N=await Br.refreshHistory();r(N.analyses),k(N.total),f(N.totalPages),x(1)}catch(N){o("Failed to refresh history. Please try again."),console.error("Error refreshing history:",N)}finally{i(!1)}},E=()=>{const R=[["id","title","date","type","summary","score","confidence"].join(",")];t.forEach(Z=>{const X=[Z.id,Z.title,Z.date,Z.type,Z.summary||"",String(Z.metrics?.score??""),String(Z.metrics?.confidence??"")].map(ce=>String(ce).replace(/"/g,'""'));R.push(X.map(ce=>`"${ce}"`).join(","))});const V=R.join(`
`),W=new Blob([V],{type:"text/csv;charset=utf-8;"}),K=URL.createObjectURL(W),be=document.createElement("a");be.href=K,be.download="analysis-history.csv",document.body.appendChild(be),be.click(),document.body.removeChild(be),URL.revokeObjectURL(K)},$=N=>{s(`/analysis/${N}`)},T=N=>new Date(N).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),P=N=>{switch(N){case"market-impact":return e.jsx(Te,{className:"w-5 h-5 text-green-600"});case"party-impact":return e.jsx(No,{className:"w-5 h-5 text-blue-600"});case"pestle":return e.jsx(Je,{className:"w-5 h-5 text-purple-600"});case"manipulation-score":return e.jsx(Ne,{className:"w-5 h-5 text-red-600"});case"motive":return e.jsx(we,{className:"w-5 h-5 text-orange-600"});default:return e.jsx(ko,{className:"w-5 h-5 text-gray-600"})}},q=N=>{switch(N){case"market-impact":return"bg-green-100";case"party-impact":return"bg-blue-100";case"pestle":return"bg-purple-100";case"manipulation-score":return"bg-red-100";case"motive":return"bg-orange-100";default:return"bg-gray-100"}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 dark:text-slate-100",children:[e.jsx("div",{className:"bg-white dark:bg-slate-900/60 shadow-sm border-b border-slate-200 dark:border-slate-800",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Analysis History"}),e.jsx("p",{className:"mt-2 text-lg text-gray-600 dark:text-slate-300",children:"View and manage your previous analyses"})]}),e.jsxs("div",{className:"mt-4 sm:mt-0",children:[e.jsxs("button",{onClick:_,disabled:a,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900/30 hover:bg-blue-200 dark:hover:bg-blue-800/40 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:[e.jsx(pr,{className:`w-4 h-4 mr-2 ${a?"animate-spin":""}`}),"Refresh"]}),w("csv_export")&&e.jsxs("button",{onClick:E,className:"ml-2 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-800/40 hover:bg-slate-200 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Export CSV"]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-white dark:bg-slate-900/60 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800 p-6 mb-8 backdrop-blur-lg",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(wo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-slate-500 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search analyses...",value:l,onChange:N=>c(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-gray-900 dark:text-slate-100 placeholder-gray-400 dark:placeholder-slate-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:d,onChange:N=>u(N.target.value),className:"px-3 py-2 border border-gray-300 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-gray-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"title",children:"Sort by Title"})]}),e.jsx("button",{onClick:()=>p(m==="asc"?"desc":"asc"),className:"px-3 py-2 border border-gray-300 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-gray-700 dark:text-slate-100 hover:bg-gray-50 dark:hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:m==="asc"?"":""})]})]})}),a&&e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"inline-flex items-center px-4 py-2 text-gray-600 dark:text-slate-300",children:[e.jsx(pr,{className:"w-5 h-5 mr-2 animate-spin"}),"Loading analysis history..."]})}),n&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-5 h-5 bg-red-400 rounded-full"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-300",children:"Error"}),e.jsx("div",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:n})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:S,className:"text-sm text-red-600 dark:text-red-400 hover:text-red-500 font-medium",children:"Try Again"})})]}),!a&&!n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white dark:bg-slate-900/60 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden backdrop-blur-lg",children:t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Le,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No analyses found"}),e.jsx("p",{className:"text-gray-600",children:l?"Try adjusting your search terms":"No analyses have been performed yet"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:t.map(N=>e.jsx("div",{onClick:()=>$(N.id),onKeyDown:R=>{(R.key==="Enter"||R.key===" ")&&(R.preventDefault(),$(N.id))},role:"button",tabIndex:0,"aria-label":`Open analysis: ${N.title}`,className:"p-6 hover:bg-gray-50 dark:hover:bg-slate-800/60 cursor-pointer transition-colors duration-200",title:"View analysis report",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`w-10 h-10 ${q(N.type)} rounded-lg flex items-center justify-center`,children:P(N.type)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white truncate",children:N.title}),N.metrics&&e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300",children:["Score: ",N.metrics.score,"%"]}),e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300",children:["Confidence: ",N.metrics.confidence,"%"]}),e.jsx("button",{onClick:R=>{R.stopPropagation(),$(N.id)},"aria-label":"View report",className:"inline-flex items-center px-3 py-1 text-xs font-semibold rounded-md bg-blue-600 text-white hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",children:"View Report"})]})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-slate-300 line-clamp-2",children:N.summary}),e.jsxs("div",{className:"mt-3 flex items-center text-sm text-gray-500 dark:text-slate-400",children:[e.jsx(Ei,{className:"w-4 h-4 mr-1"}),T(N.date)]})]})]})})},N.id))})}),g>1&&e.jsxs("div",{className:"mt-8 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700 dark:text-slate-300",children:["Showing ",(h-1)*v+1," to ",Math.min(h*v,y)," of ",y," results"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>x(Math.max(1,h-1)),disabled:h===1,className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-slate-700 text-sm font-medium rounded-md text-gray-700 dark:text-slate-100 bg-white dark:bg-slate-900 hover:bg-gray-50 dark:hover:bg-slate-800 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(vo,{className:"w-4 h-4 mr-1"}),"Previous"]}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,g)},(N,R)=>{let V;return g<=5||h<=3?V=R+1:h>=g-2?V=g-4+R:V=h-2+R,e.jsx("button",{onClick:()=>x(V),className:`px-3 py-2 text-sm font-medium rounded-md ${h===V?"bg-blue-600 text-white":"bg-white dark:bg-slate-900 text-gray-700 dark:text-slate-100 hover:bg-gray-50 dark:hover:bg-slate-800 border border-gray-300 dark:border-slate-700"}`,children:V},V)})}),e.jsxs("button",{onClick:()=>x(Math.min(g,h+1)),disabled:h===g,className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-slate-700 text-sm font-medium rounded-md text-gray-700 dark:text-slate-100 bg-white dark:bg-slate-900 hover:bg-gray-50 dark:hover:bg-slate-800 disabled:opacity-50 disabled:cursor-not-allowed",children:["Next",e.jsx(jo,{className:"w-4 h-4 ml-1"})]})]})]})]})]})]})}function U0(){const{id:s}=Eo(),t=De(),[r,a]=b.useState(null),[i,n]=b.useState(!0),[o,l]=b.useState(null),{tier:c,canAccess:d}=ct(),u=b.useCallback(async()=>{n(!0),l(null);try{if(!s)throw new Error("Analysis ID is required");const g=await Br.getAnalysisDetail(s);a(g)}catch(g){l(g instanceof Error?g.message:"Failed to load analysis details"),console.error("Error fetching analysis detail:",g)}finally{n(!1)}},[s]);b.useEffect(()=>{s&&u()},[s,u]);const m=g=>new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=g=>{switch(g){case"market-impact":return"";case"party-impact":return"";case"pestle":return"";case"manipulation-score":return"";case"motive":return"";default:return""}},h=()=>{if(!r)return;const f=[["id",r.id],["title",r.title],["date",r.date],["type",r.type],["summary",r.summary||""],["content",r.content||""],["metrics.score",String(r.metrics?.score??"")],["metrics.confidence",String(r.metrics?.confidence??"")],["metrics.factors",(r.metrics?.factors??[]).join("|")],["rawData",r.rawData?JSON.stringify(r.rawData):""]].map(([v,S])=>`"${v.replace(/"/g,'""')}","${String(S).replace(/"/g,'""')}"`).join(`
`),y=new Blob([f],{type:"text/csv;charset=utf-8;"}),k=URL.createObjectURL(y),w=document.createElement("a");w.href=k,w.download=`analysis-${r.id}.csv`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(k)},x=()=>{window.print()};return i?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(pr,{className:"w-8 h-8 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading analysis details..."})]})}):o||!r?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("div",{className:"w-8 h-8 bg-red-400 rounded-full"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Analysis Not Found"}),e.jsxs("div",{className:"text-red-600 dark:text-red-400 mb-4",children:[e.jsx("strong",{children:"This article is protected or dynamically loaded."}),e.jsx("br",{}),"For accuracy, please paste the article text directly below."]}),e.jsxs("button",{onClick:()=>t("/history"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-600 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(At,{className:"w-4 h-4 mr-2"}),"Back to History"]})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 dark:text-slate-100",children:[e.jsx("div",{className:"bg-white dark:bg-slate-900/60 shadow-sm border-b border-slate-200 dark:border-slate-800",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>t("/history"),className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-slate-700 text-sm font-medium rounded-md text-gray-700 dark:text-slate-100 bg-white dark:bg-slate-900 hover:bg-gray-50 dark:hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(At,{className:"w-4 h-4 mr-2"}),"Back to History"]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("span",{className:"text-sm text-gray-500 dark:text-slate-400",children:[e.jsx(Ei,{className:"w-4 h-4 mr-1 inline"}),m(r.date)]})})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"bg-white dark:bg-slate-900/60 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800 p-6 mb-6 backdrop-blur-lg",children:e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-xl mr-4",children:p(r.type)}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r.title}),e.jsx("p",{className:"text-gray-600 dark:text-slate-300 mt-1",children:r.summary})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-slate-900/60 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800 p-6 backdrop-blur-lg",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Detailed Analysis"}),e.jsxs("div",{className:"prose max-w-none",children:[e.jsx("p",{className:"text-gray-700 dark:text-slate-300 leading-relaxed",children:r.content||"Detailed analysis content will be displayed here. This section contains the comprehensive analysis results with detailed insights, findings, and recommendations based on the input data and analysis type."}),r.rawData&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Key Findings"}),e.jsx("div",{className:"bg-gray-50 dark:bg-slate-900/40 rounded-lg p-4",children:e.jsx("pre",{className:"text-sm text-gray-700 dark:text-slate-300 whitespace-pre-wrap",children:JSON.stringify(r.rawData,null,2)})})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900/60 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800 p-6 mb-6 backdrop-blur-lg",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Analysis Metrics"}),r.metrics&&e.jsxs("div",{className:"space-y-4",children:[r.metrics.score&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-slate-300",children:"Overall Score"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[r.metrics.score,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-800 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${r.metrics.score}%`}})})]}),r.metrics.confidence&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-slate-300",children:"Confidence Level"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[r.metrics.confidence,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-800 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${r.metrics.confidence}%`}})})]})]})]}),r.metrics?.factors&&e.jsxs("div",{className:"bg-white dark:bg-slate-900/60 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800 p-6 backdrop-blur-lg",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Key Factors"}),e.jsx("div",{className:"space-y-2",children:r.metrics.factors.map((g,f)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full mr-3"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-slate-300",children:g})]},f))})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900/60 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800 p-6 backdrop-blur-lg",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Actions"}),e.jsxs("div",{className:"space-y-3",children:[d("csv_export")?e.jsxs("button",{onClick:h,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-600 dark:text-blue-300 bg-blue-100 dark:bg-blue-900/20 hover:bg-blue-200 dark:hover:bg-blue-800/30 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Export CSV"]}):e.jsx("div",{className:"w-full text-center text-sm text-slate-500 dark:text-slate-400",children:"CSV export is a Business feature"}),d("pdf_export")?e.jsxs("button",{onClick:x,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-purple-600 dark:text-purple-300 bg-purple-100 dark:bg-purple-900/20 hover:bg-purple-200 dark:hover:bg-purple-800/30 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:[e.jsx(Si,{className:"w-4 h-4 mr-2"}),"Download PDF"]}):e.jsx("div",{className:"w-full text-center text-sm text-slate-500 dark:text-slate-400",children:"PDF export is a Business feature"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(window.location.href),alert("Link copied to clipboard!")},className:"w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-slate-700 text-sm font-medium rounded-md text-gray-700 dark:text-slate-100 bg-white dark:bg-slate-900 hover:bg-gray-50 dark:hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Share Analysis"})]})]})]})]})})]})}function D0(){const s=De(),t=ne(a=>a.setUser),r=ne(a=>a.setSession);return b.useEffect(()=>{(async()=>{try{console.log(" AuthCallback: Starting auth callback handler");const i=new URLSearchParams(window.location.hash.substring(1)),n=i.get("access_token"),o=i.get("refresh_token"),l=i.get("error");if(l){console.error(" OAuth error:",l),s("/login");return}if(n&&o){console.log(" OAuth flow - setting session with tokens");const{data:{session:c},error:d}=await F.auth.setSession({access_token:n,refresh_token:o});if(d){console.error(" Session error:",d),s("/login");return}if(c?.user){console.log(" Session established:",c.user?.email);const{data:u}=await F.from("users").select("plan, billing_cycle, scans_used_this_month, scans_limit").eq("id",c.user.id).single(),p=["free","starter","pro","business"].includes(u?.plan)?u.plan:"free";r(c),t({id:c.user.id,email:c.user.email||"",plan:p,billingCycle:u?.billing_cycle||null,scansUsed:u?.scans_used_this_month??0,scansLimit:u?.scans_limit??10}),console.log(" Redirecting to home..."),s("/",{replace:!0})}else s("/login")}else{console.log(" No OAuth tokens, checking existing session");const{data:{session:c}}=await F.auth.getSession();if(c?.user){console.log(" Existing session found:",c.user?.email);const{data:d}=await F.from("users").select("plan, billing_cycle, scans_used_this_month, scans_limit").eq("id",c.user.id).single(),m=["free","starter","pro","business"].includes(d?.plan)?d.plan:"free";r(c),t({id:c.user.id,email:c.user.email||"",plan:m,billingCycle:d?.billing_cycle||null,scansUsed:d?.scans_used_this_month??0,scansLimit:d?.scans_limit??10}),s("/",{replace:!0})}else s("/login")}}catch(i){console.error(" Auth callback error:",i),s("/login")}})()},[s,r,t]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-950",children:e.jsxs("div",{className:"text-center",children:[e.jsx(qe,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Completing authentication..."})]})})}function M0(){const{resetPassword:s,loading:t,error:r,clearError:a}=ne(),[i,n]=b.useState(""),[o,l]=b.useState(!1),[c,d]=b.useState({}),u=()=>{const p={};return i?/\S+@\S+\.\S+/.test(i)||(p.email="Email is invalid"):p.email="Email is required",d(p),Object.keys(p).length===0},m=async p=>{if(p.preventDefault(),!!u())try{await s(i),l(!0),z.success("Password reset email sent! Please check your inbox.")}catch(h){console.error("Password reset error:",h)}};return o?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center px-4 py-12",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Vt,{className:"w-8 h-8 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Check your email"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["We've sent a password reset link to ",e.jsx("strong",{children:i}),". Please check your inbox and follow the instructions to reset your password."]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(ve,{to:"/login",className:"w-full inline-flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Back to login"}),e.jsx("button",{onClick:()=>l(!1),className:"w-full inline-flex justify-center py-3 px-4 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Try with different email"})]})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center px-4 py-12",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(ve,{to:"/login",className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(At,{className:"w-4 h-4 mr-1"}),"Back to login"]})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Forgot your password?"}),e.jsx("p",{className:"text-gray-600",children:"Don't worry, we'll send you a link to reset your password."})]}),e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Vt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:i,onChange:p=>{n(p.target.value),c.email&&d({})},className:`block w-full pl-10 pr-3 py-3 border ${c.email?"border-red-300":"border-gray-300"} rounded-lg placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors`,placeholder:"Enter your email"})]}),c.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.email})]}),e.jsx("button",{type:"submit",disabled:t,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:t?e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"animate-spin -ml-1 mr-2 h-4 w-4"}),"Sending reset link..."]}):"Send reset link"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Remember your password?"," ",e.jsx(ve,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-500 transition-colors",children:"Sign in"})]})})]})})})}function B0(){const s=De();To();const{updatePassword:t,loading:r,error:a,clearError:i}=ne(),[n,o]=b.useState(""),[l,c]=b.useState(""),[d,u]=b.useState(!1),[m,p]=b.useState(!1),[h,x]=b.useState({}),g=()=>{const y={};return n?n.length<6&&(y.password="Password must be at least 6 characters"):y.password="Password is required",n!==l&&(y.confirmPassword="Passwords do not match"),x(y),Object.keys(y).length===0},f=async y=>{if(y.preventDefault(),!!g())try{await t(n),z.success("Password updated successfully!"),s("/login")}catch(k){console.error("Password reset error:",k)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center px-4 py-12",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>s("/login"),className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(At,{className:"w-4 h-4 mr-1"}),"Back to login"]})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Reset your password"}),e.jsx("p",{className:"text-gray-600",children:"Enter your new password below."})]}),e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(pe,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",name:"password",type:d?"text":"password",autoComplete:"new-password",required:!0,value:n,onChange:y=>{o(y.target.value),h.password&&x(k=>({...k,password:void 0}))},className:`block w-full pl-10 pr-10 py-3 border ${h.password?"border-red-300":"border-gray-300"} rounded-lg placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors`,placeholder:"Enter your new password"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>u(!d),children:d?e.jsx(Gt,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):e.jsx(Ue,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]}),h.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.password})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(pe,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:m?"text":"password",autoComplete:"new-password",required:!0,value:l,onChange:y=>{c(y.target.value),h.confirmPassword&&x(k=>({...k,confirmPassword:void 0}))},className:`block w-full pl-10 pr-10 py-3 border ${h.confirmPassword?"border-red-300":"border-gray-300"} rounded-lg placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors`,placeholder:"Confirm your new password"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>p(!m),children:m?e.jsx(Gt,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):e.jsx(Ue,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]}),h.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.confirmPassword})]}),e.jsx("button",{type:"submit",disabled:r,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:r?e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"animate-spin -ml-1 mr-2 h-4 w-4"}),"Updating password..."]}):"Update password"})]})]})})})}function F0(){const s=De(),{signOut:t,user:r}=ne();return b.useEffect(()=>{r?(async()=>{try{z.loading("Signing you out...",{id:"logout-loading"});const{error:i}=await t();i?(z.error("Logout failed",{description:i.message,id:"logout-loading"}),s("/")):(z.success("Signed out successfully!",{description:"You have been logged out of your account.",id:"logout-loading"}),sessionStorage.clear(),localStorage.removeItem("sb-auth-token"),setTimeout(()=>{s("/")},1500))}catch(i){console.error("Logout error:",i),z.error("Logout failed",{description:"An unexpected error occurred. Please try again.",id:"logout-loading"}),s("/")}})():s("/login")},[t,s,r]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-full",children:e.jsx(qe,{className:"w-8 h-8 text-blue-600 dark:text-blue-400 animate-spin"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Signing you out..."}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Please wait while we securely log you out of your account."})]})})}function q0(){return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pt-24 transition-colors",children:e.jsxs("div",{className:"container mx-auto max-w-4xl px-6 py-12",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-4",children:"Privacy Policy"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-8",children:"Last updated: December 11, 2025"}),e.jsxs("div",{className:"bg-white dark:bg-slate-900/60 rounded-xl shadow-sm border border-gray-200 dark:border-slate-800 p-6 space-y-8 backdrop-blur-lg",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Overview"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"This Privacy Policy explains how NexVeris.ai collects, uses, discloses, and protects your information when you use our website and services. By using the service, you agree to the practices described here."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Information We Collect"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsx("li",{children:"Account information such as name and email"}),e.jsx("li",{children:"Authentication and session data"}),e.jsx("li",{children:"Usage data, logs, device and browser information"}),e.jsx("li",{children:"Content you submit (e.g., article URLs and analysis preferences)"}),e.jsx("li",{children:"Payment and subscription details processed by our providers"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"How We Use Information"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsx("li",{children:"Provide, operate, and improve the service"}),e.jsx("li",{children:"Authenticate users and maintain account security"}),e.jsx("li",{children:"Personalize analysis results and recommendations"}),e.jsx("li",{children:"Communicate updates, alerts, and customer support messages"}),e.jsx("li",{children:"Comply with legal obligations and enforce policies"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Data Retention"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"We retain information as long as your account is active or as needed to provide the service. We may retain and use information to comply with legal obligations, resolve disputes, and enforce agreements."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Cookies and Analytics"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300 mb-2",children:"We use cookies and similar technologies to remember preferences, maintain sessions, and measure performance. Analytics help us understand usage patterns and improve features."}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"You can control cookies through your browser settings. Disabling cookies may affect functionality."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Sharing and Disclosure"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsx("li",{children:"Service providers that help operate the platform"}),e.jsx("li",{children:"Compliance with law, legal process, or enforceable requests"}),e.jsx("li",{children:"Protection of rights, safety, and security of users and the platform"}),e.jsx("li",{children:"Business transfers in connection with mergers, acquisitions, or reorganizations"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Your Rights"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsx("li",{children:"Access and update your account information"}),e.jsx("li",{children:"Request deletion of your data subject to legal obligations"}),e.jsx("li",{children:"Opt out of certain communications"}),e.jsx("li",{children:"Lodge a complaint with your local data authority if applicable"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Security"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"We implement administrative, technical, and physical safeguards to protect information. No method of transmission or storage is completely secure. We continuously improve security practices."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Children"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"The service is not directed to children under 13. We do not knowingly collect data from children. If you believe a child has provided information, contact us to remove it."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Changes"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"We may update this Privacy Policy from time to time. The updated version will be indicated by a revised date and will be effective as soon as it is accessible."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Contact"}),e.jsxs("p",{className:"text-slate-700 dark:text-slate-300",children:["Questions or requests can be sent via the ",e.jsx(ve,{to:"/account",className:"text-indigo-600 hover:underline",children:"Account"})," page or by email at support@nexveris.ai."]})]})]})]})})}function H0(){return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 pt-24 transition-colors",children:e.jsxs("div",{className:"container mx-auto max-w-4xl px-6 py-12",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-4",children:"Terms of Service"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-8",children:"Last updated: December 11, 2025"}),e.jsxs("div",{className:"bg-white dark:bg-slate-900/60 rounded-xl shadow-sm border border-gray-200 dark:border-slate-800 p-6 space-y-8 backdrop-blur-lg",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Acceptance of Terms"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"By accessing or using NexVeris.ai, you agree to be bound by these Terms of Service. If you do not agree, do not use the service."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Services"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"We provide AI-powered analysis of news articles, signals, and related insights. Features may change or be updated without prior notice."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Accounts"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"You are responsible for safeguarding your account credentials and for activities under your account. Notify us immediately of any unauthorized use."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Subscriptions and Billing"}),e.jsxs("p",{className:"text-slate-700 dark:text-slate-300",children:["Paid plans renew on a subscription basis unless cancelled. Prices and billing terms are shown at checkout. Taxes may apply. You can manage your plan on the ",e.jsx(ve,{to:"/account",className:"text-indigo-600 hover:underline",children:"Account"})," page."]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Acceptable Use"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsx("li",{children:"No scraping, mining, or bulk extraction beyond allowed API limits"}),e.jsx("li",{children:"No reverse engineering or circumventing security"}),e.jsx("li",{children:"No illegal, harmful, or abusive activities"}),e.jsx("li",{children:"No sharing of paid content outside your account"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Intellectual Property"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"The platform, models, and content are owned by NexVeris.ai or its licensors. You receive a limited, non-transferable right to use the service in accordance with these terms."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"User Content"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"You retain rights to content you submit. You grant us a limited license to process that content to provide the service."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Third-Party Links"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"The service may link to third-party sites or sources. We are not responsible for their content, policies, or practices."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Disclaimers"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:'The service is provided on an "as is" and "as available" basis without warranties of any kind. Analysis outputs are informational and do not constitute financial or legal advice.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Limitation of Liability"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"To the maximum extent permitted by law, NexVeris.ai is not liable for indirect, incidental, special, consequential, or punitive damages, or any loss of profits or revenues."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Indemnification"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"You agree to indemnify and hold harmless NexVeris.ai from claims, damages, and expenses arising from your use of the service or violation of these terms."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Termination"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"We may suspend or terminate access for any violation of these terms or misuse of the service. You may stop using the service at any time."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Governing Law"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"These terms are governed by the laws applicable to NexVeris.ai. Disputes will be handled in the competent courts of that jurisdiction."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Changes"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:"We may update these Terms of Service from time to time. Continued use of the service after changes indicates acceptance of the updated terms."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:"Contact"}),e.jsxs("p",{className:"text-slate-700 dark:text-slate-300",children:["Contact support at support@nexveris.ai or through the ",e.jsx(ve,{to:"/account",className:"text-indigo-600 hover:underline",children:"Account"})," page."]})]})]})]})})}function W0(){return e.jsx(Co,{children:e.jsx(Wd,{children:e.jsx(Gd,{children:e.jsx("div",{className:"min-h-screen bg-white text-slate-900 dark:bg-gray-950 dark:text-slate-100 selection:bg-neonCyan selection:text-gray-900",children:e.jsx(Ao,{children:e.jsxs(le,{element:e.jsx(su,{}),children:[e.jsx(le,{path:"/",element:e.jsx(nu,{})}),e.jsx(le,{path:"/pricing",element:e.jsx(fu,{})}),e.jsx(le,{path:"/privacy",element:e.jsx(q0,{})}),e.jsx(le,{path:"/terms",element:e.jsx(H0,{})}),e.jsx(le,{path:"/forgot-password",element:e.jsx(M0,{})}),e.jsx(le,{path:"/reset-password",element:e.jsx(B0,{})}),e.jsx(le,{path:"/auth/callback",element:e.jsx(D0,{})}),e.jsx(le,{path:"/logout",element:e.jsx(F0,{})}),e.jsx(le,{path:"/login",element:e.jsx(Fa,{children:e.jsx(lu,{})})}),e.jsx(le,{path:"/signup",element:e.jsx(Fa,{children:e.jsx(cu,{})})}),e.jsx(le,{path:"/analyze",element:e.jsx(yt,{children:e.jsx(za,{})})}),e.jsx(le,{path:"/news-analysis",element:e.jsx(yt,{children:e.jsx(za,{})})}),e.jsx(le,{path:"/results",element:e.jsx(yt,{children:e.jsx(ah,{})})}),e.jsx(le,{path:"/account",element:e.jsx(yt,{children:e.jsx(nh,{})})}),e.jsx(le,{path:"/history",element:e.jsx(yt,{children:e.jsx(L0,{})})}),e.jsx(le,{path:"/analysis/:id",element:e.jsx(yt,{children:e.jsx(U0,{})})}),e.jsx(le,{path:"*",element:e.jsx(Wr,{to:"/",replace:!0})})]})})})})})})}const $n=document.getElementById("root");if(!$n)throw new Error("Root element not found");Do.createRoot($n).render(e.jsx(b.StrictMode,{children:e.jsx(Fi,{children:e.jsx(W0,{})})}));
